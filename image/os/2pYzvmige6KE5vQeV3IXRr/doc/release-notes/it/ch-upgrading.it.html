<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Capitolo 4. Aggiornamenti da Debian 7 (wheezy)</title><link rel="stylesheet" type="text/css" href="debian.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.it.html" title="Note di rilascio per Debian 8 (jessie), PC a 64 bit" /><link rel="up" href="index.it.html" title="Note di rilascio per Debian 8 (jessie), PC a 64 bit" /><link rel="prev" href="ch-installing.it.html" title="Capitolo 3. Sistema d'installazione" /><link rel="next" href="ch-information.it.html" title="Capitolo 5. Problemi di cui essere al corrente per jessie" /><meta xmlns="" name="viewport" content="width=device-width, initial-scale=1" /><style xmlns="" type="text/css">
      body {
        background-repeat: no-repeat;
        background-image: none;
      }
    </style></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Capitolo 4. Aggiornamenti da Debian 7 (wheezy)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch-installing.it.html"><img src="images/prev.png" alt="Indietro" /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch-information.it.html"><img src="images/next.png" alt="Avanti" /></a></td></tr></table><hr /></div><div xml:lang="it" class="chapter" lang="it"><div class="titlepage"><div><div><h1 class="title"><a id="ch-upgrading"></a>Capitolo 4. Aggiornamenti da Debian 7 (wheezy)</h1></div></div></div><div class="toc"><p><strong>Indice</strong></p><dl class="toc"><dt><span class="section"><a href="ch-upgrading.it.html#backup">4.1. Preparazione all'aggiornamento</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.it.html#data-backup">4.1.1. Salvare i dati e le informazioni di configurazione</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#inform-users">4.1.2. Informare gli utenti in anticipo</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#services-downtime">4.1.3. Preparazione all'indisponibilità dei servizi</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#recovery">4.1.4. Preparazione per il ripristino</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#upgrade-preparations">4.1.5. Preparazione di un ambiente sicuro per l'aggiornamento</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.it.html#system-status">4.2. Verifica dello stato del sistema</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.it.html#review-actions">4.2.1. Rivedere le azioni in sospeso nel gestore di pacchetti</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#disable-apt-pinning">4.2.2. Disattivare il pinning di APT</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#package-status">4.2.3. Verifica dello stato dei pacchetti</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#proposed-updates">4.2.4. La sezione <span class="quote">«<span class="quote">proposed-updates</span>»</span> (aggiornamenti proposti)</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#unofficial-sources">4.2.5. Fonti non ufficiali</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.it.html#upgrade-process">4.3. Preparazione delle fonti per APT</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.it.html#network">4.3.1. Aggiunta di fonti internet per APT</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#localmirror">4.3.2. Aggiunta di fonti per APT da mirror locale</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#cdroms">4.3.3. Aggiunta di fonti per APT da supporti ottici</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.it.html#upgradingpackages">4.4. Aggiornare i pacchetti</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.it.html#record-session">4.4.1. Registrazione della sessione</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#updating-lists">4.4.2. Aggiornamento della lista dei pacchetti</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#sufficient-space">4.4.3. Accertarsi di avere spazio disponibile a sufficienza per l'aggiornamento</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#minimal-upgrade">4.4.4. Aggiornamento minimo del sistema</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#upgrading-full">4.4.5. Aggiornamento del sistema</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.it.html#trouble">4.5. Possibili problemi durante l'aggiornamento</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.it.html#immediate-configure">4.5.1. Dist-upgrade fallisce con l'errore <span class="quote">«<span class="quote">Impossibile eseguire
immediatamente la configurazione</span>»</span></a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#expected-removals">4.5.2. Rimozioni attese</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#conflicts-loops">4.5.3. Conflitti e pre-dipendenze cicliche</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#file-conflicts">4.5.4. Conflitti tra file</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#configuration-changes">4.5.5. Modifiche alla configurazione</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#console-change">4.5.6. Cambiare la sessione sulla console</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#package-specific-issues">4.5.7. Pacchetti che richiedono un'attenzione particolare</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.it.html#newkernel">4.6. Aggiornare il kernel e i pacchetti collegati</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.it.html#kernel-metapackage">4.6.1. Installazione di un metapacchetto del kernel</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#initramfs-tools-issues">4.6.2. Cambiamenti al montaggio e controllo di file system radice e
<code class="filename">/usr</code></a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.it.html#nownownow">4.7. Cose da fare prima di riavviare il sistema</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#for-next">4.8. Preparazione per il prossimo rilascio</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.it.html#purge-removed-packages">4.8.1. Eliminare completamente i pacchetti rimossi</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.it.html#deprecated">4.9. Componenti deprecati</a></span></dt><dt><span class="section"><a href="ch-upgrading.it.html#obsolete">4.10. Pacchetti obsoleti</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.it.html#dummy">4.10.1. Pacchetti fittizi</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="backup"></a>4.1. Preparazione all'aggiornamento</h2></div></div></div><p>
Prima di procedere all'aggiornamento si consiglia di leggere anche le
informazioni contenute in <a class="xref" href="ch-information.it.html" title="Capitolo 5. Problemi di cui essere al corrente per jessie">Capitolo 5, <em>Problemi di cui essere al corrente per jessie</em></a>, dove vengono
trattati i potenziali problemi non direttamente collegati al processo di
aggiornamento, ma che potrebbe essere comunque importante conoscere prima di
iniziare.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="data-backup"></a>4.1.1. Salvare i dati e le informazioni di configurazione</h3></div></div></div><p>
Prima di aggiornare il proprio sistema si raccomanda di effettuare un
salvataggio completo o quantomeno una copia di sicurezza di tutti quei dati
e quelle informazioni di configurazione che non ci si può permettere di
perdere. Gli strumenti e i processi di aggiornamento sono abbastanza
affidabili, ma un problema dell'hardware durante l'aggiornamento potrebbe
generare un sistema fortemente danneggiato.
</p><p>
Le cose principali che si potrebbe considerare di salvare sono i contenuti
di <code class="filename">/etc</code>, <code class="filename">/var/lib/dpkg</code>,
<code class="filename">/var/lib/apt/extended_states</code> e l'output di
<code class="literal">dpkg --get-selections "*"</code> (le virgolette sono
importanti). Se si usa <span class="command"><strong>aptitude</strong></span> per gestire i pacchetti,
si dovrebbe salvare anche <code class="filename">/var/lib/aptitude/pkgstates</code>.
</p><p>
Il processo di aggiornamento in quanto tale non modifica nulla nelle
directory <code class="filename">/home</code>, tuttavia alcune applicazioni (come ad
esempio alcune parti della suite Mozilla e gli ambienti desktop GNOME e KDE)
sovrascrivono le impostazioni dell'utente preesistenti con i nuovi valori
predefiniti quando un utente avvia per la prima volta la nuova versione
dell'applicazione. Per precauzione si potrebbe quindi voler fare una copia
di sicurezza dei file e delle directory nascosti (<span class="quote">«<span class="quote">dotfile</span>»</span>,
cioè file i cui nomi iniziano con un punto) che si trovano nelle directory
<span class="quote">«<span class="quote">home</span>»</span> degli utenti. Tale copia potrebbe aiutare a ripristinare
o a ricreare le vecchie impostazioni. Potrebbe anche essere il caso di
informare gli utenti su questo argomento.
</p><p>
Tutte le installazioni di pacchetti devono essere eseguite con i privilegi
di superutente, per cui è necessario effettuare il login come utente
<code class="literal">root</code>, oppure usare <span class="command"><strong>su</strong></span> o
<span class="command"><strong>sudo</strong></span>, per ottenere i diritti d'accesso necessari.
</p><p>
L'aggiornamento ha alcune condizioni preliminari; prima di eseguirlo si
dovrebbe verificarle.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="inform-users"></a>4.1.2. Informare gli utenti in anticipo</h3></div></div></div><p>
È saggio informare in anticipo tutti gli utenti di qualunque aggiornamento
si stia pianificando, anche se gli utenti che accedono al sistema tramite
una connessione <span class="command"><strong>ssh</strong></span> non dovrebbero notare granché durante
l'aggiornamento e dovrebbero poter continuare a lavorare. 
</p><p>
Se si desidera prendere delle precauzioni supplementari, si esegua un
salvataggio delle partizioni degli utenti (<code class="filename">/home</code>) o le
si smonti prima di aggiornare il sistema.
</p><p>
Con l'aggiornamento a jessie si dovrà anche fare un aggiornamento del
kernel, per cui sarà necessario riavviare il sistema. Tipicamente ciò verrà
fatto dopo che l'aggiornamento è terminato.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="services-downtime"></a>4.1.3. Preparazione all'indisponibilità dei servizi</h3></div></div></div><p>
Tra i pacchetti interessati all'aggiornamento ce ne potrebbero essere alcuni
a cui sono associati dei servizi. In questo caso, tali servizi saranno
fermati mentre è in corso la sostituzione o la configurazione dei
pacchetti. In questo periodo di tempo i servizi non saranno disponibili.
</p><p>
La durata del disservizio varia a seconda del numero di pacchetti da
aggiornare sul sistema e comprende anche il tempo che occorre
all'amministratore di sistema per rispondere alle domande sulla
configurazione poste dall'aggiornamento dei pacchetti. Notare che se
l'aggiornamento non è presidiato e il sistema richiede una risposta per
andare avanti è probabile che i servizi rimangano non
disponibili<a href="#ftn.idp48614448" class="footnote" id="idp48614448"><sup class="footnote">[1]</sup></a> per un periodo di tempo
considerevole.
</p><p>
Se il sistema in fase di aggiornamento fornisce servizi critici per gli
utenti o la rete<a href="#ftn.idp48615984" class="footnote" id="idp48615984"><sup class="footnote">[2]</sup></a>, è possibile ridurre
il tempo di disservizio facendo un aggiornamento minimo, come descritto in
<a class="xref" href="ch-upgrading.it.html#minimal-upgrade" title="4.4.4. Aggiornamento minimo del sistema">Sezione 4.4.4, «Aggiornamento minimo del sistema»</a>, seguito da un aggiornamento del kernel,
un riavvio e poi l'aggiornamento dei pacchetti associati ai servizi
critici. Fare l'aggiornamento di questi pacchetti prima di fare
l'aggiornamento completo descritto in <a class="xref" href="ch-upgrading.it.html#upgrading-full" title="4.4.5. Aggiornamento del sistema">Sezione 4.4.5, «Aggiornamento del sistema»</a>. Questo metodo assicura che i servizi critici
restino in funzione mentre è in corso l'aggiornamento completo del sistema e
che il periodo di disservizio sia breve.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="recovery"></a>4.1.4. Preparazione per il ripristino</h3></div></div></div><p>
Sebbene Debian cerchi di garantire che il sistema rimanga sempre in uno
stato avviabile, c'è sempre la possibilità che si abbiano problemi a
riavviare il sistema dopo l'aggiornamento. I potenziali problemi che sono
noti sono documentati in questo e nei prossimi capitoli delle presenti note
di rilascio.
</p><p>
Pertanto è sensato assicurarsi di essere in grado di ripristinare il proprio
sistema se questo non riesce a riavviarsi o a tirare su la rete, se è
gestito da remoto.
</p><p>
Se si sta aggiornando da remoto tramite una connessione
<span class="command"><strong>ssh</strong></span> è fortemente raccomandato prendere tutte le
precauzioni necessarie per essere in grado di accedere al server tramite un
terminale seriale remoto. È possibile che, dopo l'aggiornamento del kernel e
il riavvio del sistema, si debba sistemare la configurazione del sistema
tramite una console locale. Analogamente, se il sistema viene
accidentalmente riavviato nel mezzo di un aggiornamento è possibile che lo
si debba ripristinare usando una console locale.
</p><p>
Generalmente viene raccomandato di usare è la <span class="emphasis"><em>modalità di
ripristino</em></span> dell'installatore di Debian jessie. Il
vantaggio di usare l'installatore consiste nel fatto che è possibile
scegliere fra i suoi numerosi metodi per trovare quello che meglio
corrisponde alla propria situazione. Per maggiori informazioni si consulti
la sezione <span class="quote">«<span class="quote">Recupero di un sistema danneggiato</span>»</span> nel capitolo 8
della <a class="ulink" href="https://www.debian.org/releases/jessie/installmanual" target="_top">Guida all'installazione</a> e le
<a class="ulink" href="https://wiki.debian.org/DebianInstaller/FAQ" target="_top">FAQ dell'installatore di
Debian</a>.
</p><p>
Se questa operazione non riesce, sarà necessario trovare un modo alternativo
per avviare il proprio sistema in modo da potervi accedere per
ripararlo. Una possibilità è l'utilizzo di un'immagine di ripristino
speciale o di un CD live di Linux. Dopo aver avviato in tal modo, si
dovrebbe essere in grado di montare il proprio file system radice ed
entrarvi con <code class="literal">chroot</code> per trovare e correggere il problema.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="recovery-initrd"></a>4.1.4.1. Shell di debug durante l'avvio con initrd</h4></div></div></div><p>
Il pacchetto <code class="systemitem">initramfs-tools</code><a id="idp48630464" class="indexterm"></a> include
una shell di debug<a href="#ftn.idp48631280" class="footnote" id="idp48631280"><sup class="footnote">[3]</sup></a> negli initrd che
genera. Per esempio, se initrd non è in grado di montare il file system
radice si verrà rimandati in questa shell di debug, la quale mette a
disposizione i comandi di base per trovare il problema e, se possibile,
risolverlo.
</p><p>
Le cose di base da controllare sono: la presenza dei file device corretti in
<code class="filename">/dev</code>, quali moduli vengono caricati (<code class="literal">cat
/proc/modules</code>) e l'output di <span class="command"><strong>dmesg</strong></span> per gli
errori durante il caricamento dei driver. L'output di
<span class="command"><strong>dmesg</strong></span> mostra inoltre quali file device sono stati
assegnati a quali dischi; questi risultati andranno confrontati con l'output
di <code class="literal">echo $ROOT</code>, per assicurarsi che il file system radice
sia sul device atteso.
</p><p>
Se si è riusciti a risolvere il problema, digitando <code class="literal">exit</code>
si uscirà dalla shell di debug e si continuerà il processo di avvio a
partire dal punto in cui il problema si è verificato. Naturalmente sarà
anche necessario risolvere il problema sottostante e rigenerare initrd in
modo che il prossimo avvio non fallisca nuovamente.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="recovery-shell-systemd"></a>4.1.4.2. Shell di debug durante l'avvio con systemd</h4></div></div></div><p>
    Se l'avvio fallisce con systemd è possibile ottenere una shell root di debug
cambiando la riga di comando del kernel. Se l'avvio di base ha successo, ma
l'avvio di alcuni servizi fallisce, può essere utile aggiungere
<code class="literal">systemd.unit=rescue.target</code> ai parametri del kernel.
  </p><p>
    Atrimenti il parametro <code class="literal">systemd.unit=emergency.target</code> del
kernel fornirà una shell di root non appena possibile. Tuttavia ciò viene
fatto prima del montaggio del file system radice con permessi in lettura e
scrittura. Sarà necessario farlo manualmente con:
  </p><pre class="screen">
mount -o remount,rw /
</pre><p>
    Ulteriori informazioni su come fare il debug di un avvio non funzionante con
systemd possono essere trovate nell'articolo <a class="ulink" href="http://freedesktop.org/wiki/Software/systemd/Debugging/" target="_top">Diagnosing
Boot Problems</a>.
  </p><p>
    Se ogni altra cosa fallisce, potrebbe essere possibile avviare usando il
vecchio sistema sysvinit. Ciò richiede che il pacchetto <code class="systemitem">sysvinit</code><a id="idp48646400" class="indexterm"></a> sia ancora installato e che il binario
<code class="filename">/lib/sysvinit/init</code> sia incluso nell'initramfs. Se
questi requisiti sono soddisfatti, aggiungere
<code class="literal">init=/lib/sysvinit/init</code> nella riga di comando del kernel
ed esso si avvierà con il binario sysvinit.
  </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrade-preparations"></a>4.1.5. Preparazione di un ambiente sicuro per l'aggiornamento</h3></div></div></div><p>
L'aggiornamento della distribuzione dovrebbe essere eseguito o da locale, da
una console virtuale in modalità testo (o da un terminale seriale collegato
direttamente), o da remoto, tramite una connessione <span class="command"><strong>ssh</strong></span>. 
</p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Importante]" src="images/important.png" /></td><th align="left">Importante</th></tr><tr><td align="left" valign="top"><p>
  I servizi VPN (quali <code class="systemitem">tinc</code><a id="idp48652864" class="indexterm"></a>)
potrebbero non essere disponibili durante l'aggiornamento. Consultare <a class="xref" href="ch-upgrading.it.html#services-downtime" title="4.1.3. Preparazione all'indisponibilità dei servizi">Sezione 4.1.3, «Preparazione all'indisponibilità dei servizi»</a>.
  </p></td></tr></table></div><p>
Per ottenere un margine supplementare di sicurezza durante l'aggiornamento
da remoto si suggerisce di eseguire i processi di aggiornamento nella
console virtuale fornita dal programma <span class="command"><strong>screen</strong></span>, che
consente la riconnessione sicura e garantisce che il processo di
aggiornamento non venga interrotto nemmeno nel caso in cui il processo di
connessione remota si interrompa.
</p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Importante]" src="images/important.png" /></td><th align="left">Importante</th></tr><tr><td align="left" valign="top"><p>
    <span class="emphasis"><em>Non</em></span> si dovrebbe eseguire l'aggiornamento usando
<span class="command"><strong>telnet</strong></span>, <span class="command"><strong>rlogin</strong></span>,
<span class="command"><strong>rsh</strong></span>, o da una sessione X gestita da
<span class="command"><strong>xdm</strong></span>, <span class="command"><strong>gdm</strong></span> o <span class="command"><strong>kdm</strong></span> e
simili sul sistema che si sta aggiornando, poiché ciascuno di questi servizi
potrebbe essere terminato durante l'aggiornamento, generando quindi un
sistema <span class="emphasis"><em>inaccessibile</em></span> e aggiornato solo a metà. L'uso
dell'applicazione GNOME <span class="command"><strong>update-manager</strong></span> per
l'aggiornamento alla nuova versione è <span class="emphasis"><em>fortemente
sconsigliato</em></span> poiché tale programma fa affidamento sul fatto che
la sessione desktop rimanga attiva.
  </p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="system-status"></a>4.2. Verifica dello stato del sistema</h2></div></div></div><p>
Il processo di aggiornamento descritto nel presente capitolo è stato
concepito per aggiornamenti da sistemi wheezy <span class="quote">«<span class="quote">puri</span>»</span>,
ossia senza pacchetti di terze parti. Per ottenere un processo di
aggiornamento il più affidabile possibile si potrebbero voler rimuovere i
pacchetti di terze parti dal proprio sistema prima di iniziare
l'aggiornamento.
</p><p>
L'aggiornamento diretto dalle versioni di Debian precedenti a 7
(wheezy) non è supportato. Seguire le istruzioni nelle <a class="ulink" href="https://www.debian.org/releases/wheezy/releasenotes" target="_top">Note di
rilascio per Debian 7</a> per aggiornare prima a
7.
</p><p>
Questa procedura presume altresì che il proprio sistema sia stato aggiornato
fino all'ultimo aggiornamento disponibile per wheezy: se non è
così o non si è sicuri, si seguano le istruzioni contenute in <a class="xref" href="ap-old-stuff.it.html#old-upgrade" title="A.1. Aggiornare il proprio sistema wheezy">Sezione A.1, «Aggiornare il proprio sistema wheezy»</a>.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="review-actions"></a>4.2.1. Rivedere le azioni in sospeso nel gestore di pacchetti</h3></div></div></div><p>
In certi casi l'uso di <span class="command"><strong>apt-get</strong></span> per l'installazione di
pacchetti in sostituzione di <span class="command"><strong>aptitude</strong></span> potrebbe far sì che
<span class="command"><strong>aptitude</strong></span> consideri un pacchetto come
<span class="quote">«<span class="quote">inutilizzato</span>»</span> e ne programmi la rimozione. In generale, ci si
dovrebbe accertare che il proprio sistema sia completamente aggiornato e
<span class="quote">«<span class="quote">pulito</span>»</span> prima di procedere all'aggiornamento.
</p><p>
Pertanto bisognerebbe controllare se vi sono operazioni in sospeso nel
gestore di pacchetti <span class="command"><strong>aptitude</strong></span>: se è programmato
l'aggiornamento o la rimozione di un pacchetto, questo potrebbe influire
negativamente sul processo di aggiornamento. Si noti che la correzione di
questa situazione è possibile solo se il proprio
<code class="filename">sources.list</code> punta tuttora a
<span class="emphasis"><em>wheezy</em></span> e non a <span class="emphasis"><em>stable</em></span> o
a <span class="emphasis"><em>jessie</em></span>. A tale proposito si consulti <a class="xref" href="ap-old-stuff.it.html#old-sources" title="A.2. Controllare la propria lista delle fonti">Sezione A.2, «Controllare la propria lista delle fonti»</a>.
</p><p>
A tal fine è necessario eseguire l'<span class="quote">«<span class="quote">interfaccia grafica</span>»</span> di
<span class="command"><strong>aptitude</strong></span> e premere <span class="keycap"><strong>g</strong></span>
(<span class="quote">«<span class="quote">Scarica/Installa/Rimuovi</span>»</span>). Se viene mostrata una qualsiasi
azione, si dovrebbe controllarla e o risolverla o eseguirla. Se non viene
proposta alcuna azione sarà mostrato il messaggio <span class="quote">«<span class="quote">Non ci sono
pacchetti da installare, rimuovere o aggiornare</span>»</span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="disable-apt-pinning"></a>4.2.2. Disattivare il pinning di APT</h3></div></div></div><p>
Se si è configurato APT in modo da installare taluni pacchetti da una
distribuzione diversa da stable (ad esempio da testing), si potrebbe dover
modificare la configurazione del pinning del proprio APT (memorizzata in
<code class="filename">/etc/apt/preferences</code> e
<code class="filename">/etc/apt/preferences.d/</code>) in modo da consentire
l'aggiornamento dei pacchetti alle versioni nel nuovo rilascio
stable. Maggiori informazioni sul pinning di APT sono disponibili in
<span class="citerefentry"><span class="refentrytitle">apt_preferences</span>(5)</span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="package-status"></a>4.2.3. Verifica dello stato dei pacchetti</h3></div></div></div><p>
Si raccomanda di controllare dapprima lo stato di tutti i pacchetti e di
verificare che tutti siano in uno stato aggiornabile, indipendentemente dal
metodo usato per l'aggiornamento. Il comando seguente mostrerà tutti i
pacchetti con uno stato «Half-Installed» o «Failed-Config» e quelli con un
qualsiasi stato di errore.
</p><pre class="screen">
# dpkg --audit
</pre><p>
È anche possibile controllare lo stato di tutti i pacchetti sul proprio
sistema usando <span class="command"><strong>aptitude</strong></span> o con comandi come ad esempio
</p><pre class="screen">
# dpkg -l | pager
</pre><p>
o
</p><pre class="screen">
# dpkg --get-selections "*" &gt; ~/curr-pkgs.txt
</pre><p>
È auspicabile la rimozione di qualsiasi blocco prima dell'aggiornamento. Se
qualsiasi pacchetto essenziale per l'aggiornamento è bloccato (<span class="quote">«<span class="quote">on
hold</span>»</span>) l'aggiornamento fallirà.
</p><p>
Si noti che <span class="command"><strong>aptitude</strong></span> usa un metodo differente per
registrare i pacchetti bloccati rispetto ad <span class="command"><strong>apt-get</strong></span> e
<span class="command"><strong>dselect</strong></span>. È possibile identificare i pacchetti bloccati
per <span class="command"><strong>aptitude</strong></span> eseguendo
</p><pre class="screen">
# aptitude search "~ahold" 
</pre><p>
Se si desidera controllare quali pacchetti erano bloccati per
<span class="command"><strong>apt-get</strong></span>, si dovrebbe eseguire
</p><pre class="screen">
# dpkg --get-selections | grep 'hold$'
</pre><p>
Se un pacchetto è stato modificato e ricompilato localmente, e non lo si è
rinominato né vi si è aggiunto un numero di epoca nella versione, è
necessario bloccarlo per impedire che venga aggiornato.
</p><p>
Lo stato <span class="quote">«<span class="quote">bloccato</span>»</span> di un pacchetto per
<span class="command"><strong>apt-get</strong></span> può essere modificato eseguendo il comando:
</p><pre class="screen">
# echo <em class="replaceable"><code>nome_pacchetto</code></em> hold | dpkg --set-selections
</pre><p>
Si sostituisca <code class="literal">hold</code> con <code class="literal">install</code> per
rimuovere lo stato <span class="quote">«<span class="quote">bloccato</span>»</span> del pacchetto.
</p><p>
Se c'è bisogno di sistemare qualcosa è meglio controllare che il proprio
<code class="filename">sources.list</code> punti sempre a wheezy come
illustrato in <a class="xref" href="ap-old-stuff.it.html#old-sources" title="A.2. Controllare la propria lista delle fonti">Sezione A.2, «Controllare la propria lista delle fonti»</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="proposed-updates"></a>4.2.4. La sezione <span class="quote">«<span class="quote">proposed-updates</span>»</span> (aggiornamenti proposti)</h3></div></div></div><p>
    Se la sezione <code class="literal">proposed-updates</code> è elencata nel proprio
<code class="filename">/etc/apt/sources.list</code>, la si dovrebbe rimuovere da quel
file prima di tentare l'aggiornamento del sistema. Questa precauzione serve
per ridurre il rischio di conflitti.
  </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="unofficial-sources"></a>4.2.5. Fonti non ufficiali</h3></div></div></div><p>
Se si ha un qualsiasi pacchetto non-Debian nel proprio sistema, si presti
attenzione al fatto che questi possono essere rimossi durante
l'aggiornamento a causa di conflitti di dipendenze. Se questi pacchetti sono
stati installati aggiungendo un archivio di pacchetti supplementare nel
proprio <code class="filename">/etch/apt/sources.list</code>, si dovrebbe controllare
che tale archivio offra anche pacchetti compilati per jessie e
modificare di conseguenza la riga della fonte contemporaneamente alle righe
delle fonti per i pacchetti Debian.
</p><p>
Alcuni utenti potrebbero avere installate nel proprio sistema
wheezy versioni <span class="emphasis"><em>non ufficiali</em></span> <span class="quote">«<span class="quote">più
recenti</span>»</span> da backport di pacchetti che <span class="emphasis"><em>sono</em></span> in
Debian. Tali pacchetti sono i candidati più probabili a causare problemi
durante un aggiornamento, in quanto potrebbero generare conflitti fra
file<a href="#ftn.idp48715440" class="footnote" id="idp48715440"><sup class="footnote">[4]</sup></a>. <a class="xref" href="ch-upgrading.it.html#trouble" title="4.5. Possibili problemi durante l'aggiornamento">Sezione 4.5, «Possibili problemi durante l'aggiornamento»</a>
contiene alcune informazioni su come gestire i conflitti tra file nel caso
si verifichino.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgrade-process"></a>4.3. Preparazione delle fonti per APT</h2></div></div></div><p>
Prima di iniziare l'aggiornamento è necessario predisporre per le liste dei
pacchetti il file di configurazione di <code class="systemitem">apt</code><a id="idp48719632" class="indexterm"></a>, <code class="filename">/etc/apt/sources.list</code>.
</p><p>
<code class="systemitem">apt</code><a id="idp48722304" class="indexterm"></a> prenderà in considerazione tutti
i pacchetti che possono essere trovati tramite le righe
<span class="quote">«<span class="quote"><code class="literal">deb</code></span>»</span> e installerà il pacchetto con il
numero di versione più alto, dando la priorità alle righe menzionate per
prime (in questo modo, nel caso in cui siano presenti varie fonti
equivalenti, tipicamente si dovrebbe menzionare per primo un disco fisso
locale, poi il <acronym title="Compact Disc Read Only Memory">CD-ROM</acronym> e infine il mirror HTTP/FTP).
</p><p>
Si fa spesso riferimento a un rilascio sia tramite il suo nome in codice (ad
esempio <code class="literal">wheezy</code>,
<code class="literal">jessie</code>), sia tramite la denominazione del suo
stato (cioè <code class="literal">oldstable</code>, <code class="literal">stable</code>,
<code class="literal">testing</code>, <code class="literal">unstable</code>). Fare riferimento
ad un rilascio attraverso il suo nome in codice presenta il vantaggio che
non si sarà mai sorpresi da un nuovo rilascio, pertanto è il metodo qui
adottato. Questo naturalmente significa che si dovrà prestare attenzione
agli annunci di rilascio. Se invece si utilizza la denominazione dello
stato, si vedrà una grande quantità di aggiornamenti disponibili per i
propri pacchetti non appena avviene un rilascio.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="network"></a>4.3.1. Aggiunta di fonti internet per APT</h3></div></div></div><p>
La configurazione predefinita prevede l'installazione dai principali server
internet di Debian, ma si potrebbe voler modificare il proprio
<code class="filename">/etc/apt/sources.list</code> in modo che usi i mirror,
preferibilmente uno più vicino dal punto di vista della rete.
</p><p>
Gli indirizzi dei mirror HTTP o FTP di Debian sono reperibili in <a class="ulink" href="https://www.debian.org/distrib/ftplist" target="_top">https://www.debian.org/distrib/ftplist</a> (si guardi la sezione <span class="quote">«<span class="quote">Elenco dei
mirror Debian</span>»</span>. Generalmente i mirror HTTP sono più veloci di quelli
FTP.
</p><p>
Per esempio, si supponga che il proprio mirror Debian più vicino sia
<code class="literal">http://mirrors.kernel.org</code>. Ispezionandolo con un browser web
o un client FTP si noterà che le directory principali sono organizzate nel
modo seguente:
</p><pre class="programlisting">
http://mirrors.kernel.org/debian/dists/jessie/main/binary-<span class="phrase">amd64</span>/...
http://mirrors.kernel.org/debian/dists/jessie/contrib/binary-<span class="phrase">amd64</span>/...
</pre><p>
Per poter utilizzare questo mirror con <code class="systemitem">apt</code><a id="idp48739648" class="indexterm"></a>, si aggiungerà al proprio file
<code class="filename">sources.list</code> la seguente riga:
</p><pre class="programlisting">deb http://mirrors.kernel.org/debian jessie main contrib</pre><p>
Si noti che <span class="quote">«<span class="quote"><code class="literal">dists</code></span>»</span> è aggiunto
implicitamente e che gli argomenti che seguono il nome del rilascio sono
utilizzati per espandere il percorso su directory multiple.
</p><p>
Dopo aver aggiunto le nuove fonti, si disabilitino le righe
<span class="quote">«<span class="quote"><code class="literal">deb</code></span>»</span> preesistenti in
<code class="filename">sources.list</code>, ponendovi davanti un simbolo cancelletto
(<code class="literal">#</code>).
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="localmirror"></a>4.3.2. Aggiunta di fonti per APT da mirror locale</h3></div></div></div><p>
Anziché usare mirror HTTP o FTP dei pacchetti, si potrebbe voler modificare
<code class="filename">/etc/apt/sources.list</code> in modo che usi un mirror su un
disco locale (eventualmente montato su <acronym title="Network File System">NFS</acronym>).
</p><p>
Per esempio, il proprio mirror dei pacchetti potrebbe essere in
<code class="filename">/var/ftp/debian/</code> e avere le directory principali come
segue:
</p><pre class="programlisting">
/var/ftp/debian/dists/jessie/main/binary-<span class="phrase">amd64</span>/...
/var/ftp/debian/dists/jessie/contrib/binary-<span class="phrase">amd64</span>/...
</pre><p>
Per poter utilizzare questo mirror con <code class="systemitem">apt</code><a id="idp48753696" class="indexterm"></a>, si aggiunga questa riga al proprio
<code class="filename">sources.list</code>:
</p><pre class="programlisting">deb file:/var/ftp/debian jessie main contrib</pre><p>
Si noti che <span class="quote">«<span class="quote"><code class="literal">dists</code></span>»</span> è aggiunto
implicitamente e che gli argomenti che seguono il nome del rilascio sono
utilizzati per espandere il percorso su directory multiple.
</p><p>
Dopo aver aggiunto le nuove fonti, si disabilitino le righe
<span class="quote">«<span class="quote"><code class="literal">deb</code></span>»</span> preesistenti in
<code class="filename">sources.list</code>, ponendovi davanti un simbolo cancelletto
(<code class="literal">#</code>).
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cdroms"></a>4.3.3. Aggiunta di fonti per APT da supporti ottici</h3></div></div></div><p>
Se si vogliono utilizzare <span class="emphasis"><em>soltanto</em></span> CD (o DVD o dischi
Blu-ray) si disabilitino, commentandole, le righe
<span class="quote">«<span class="quote"><code class="literal">deb</code></span>»</span> preesistenti in
<code class="filename">/etc/apt/sources.list</code>, ponendovi davanti un simbolo
cancelletto (<code class="literal">#</code>).
</p><p>
Ci si accerti che in <code class="filename">/etc/fstab</code> ci sia una riga che
abiliti la possibilità di montare la propria unità CD-ROM nel punto di
montaggio <code class="filename">/media/cdrom</code>. Per esempio, se l'unità del
CD-ROM è <code class="filename">/dev/sr0</code>, <code class="filename">/etc/fstab</code>
dovrebbe contenere una riga come la seguente:
</p><pre class="programlisting">
/dev/sr0 /media/cdrom auto noauto,ro 0 0
</pre><p>
Si noti che <span class="emphasis"><em>non ci devono essere spazi</em></span> fra le parole
<code class="literal">noauto,ro</code> nel quarto campo.
</p><p>
Per verificare il funzionamento, inserire un CD e provare a eseguire
</p><pre class="screen">
# mount /media/cdrom    # questo monta il CD nel punto di montaggio
# ls -alF /media/cdrom  # questo dovrebbe mostrare la directory radice del CD
# umount /media/cdrom   # questo smonta il CD
</pre><p>
Poi, si esegua:
</p><pre class="screen">
# apt-cdrom add
</pre><p>
per ciascun CD-ROM di binari di Debian che si possiede, al fine di
aggiungere i dati di ciascun CD al database di APT.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgradingpackages"></a>4.4. Aggiornare i pacchetti</h2></div></div></div><p>
Il metodo raccomandato per l'aggiornamento dalle versioni precedenti di
Debian prevede l'utilizzo del gestore dei pacchetti
<span class="command"><strong>apt-get</strong></span>. Nelle versioni precedenti era consigliato
<span class="command"><strong>aptitude</strong></span> per questo scopo, ma le versioni più recenti di
<span class="command"><strong>apt-get</strong></span> forniscono delle funzionalità equivalenti e si
sono mostrate anche più affidabili negli aggiornamenti.
</p><p>
Non ci si dimentichi di montare tutte le partizioni necessarie (in
particolare le partizioni radice e <code class="filename">/usr</code>) in modalità di
lettura e scrittura, con un comando del tipo:
</p><pre class="screen">
# mount -o remount,rw /<em class="replaceable"><code>puntodimount</code></em>
</pre><p>
Si dovrebbe poi controllare molto attentamente che le voci sulle fonti di
APT (contenute in <code class="filename">/etc/apt/sources.list</code>) facciano
riferimento a <span class="quote">«<span class="quote"><code class="literal">jessie</code></span>»</span> o a
<span class="quote">«<span class="quote"><code class="literal">stable</code></span>»</span>. Non ci dovrebbero essere voci di
fonti che puntano a wheezy.
</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
    Qualche volta le righe delle fonti per un CD-ROM potrebbero fare riferimento
a <span class="quote">«<span class="quote"><code class="literal">unstable</code></span>»</span>; sebbene ciò possa generare
confusione <span class="emphasis"><em>non</em></span> le si dovrebbe modificare.
  </p></td></tr></table></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="record-session"></a>4.4.1. Registrazione della sessione</h3></div></div></div><p>
È fortemente raccomandato l'utilizzo del programma
<span class="command"><strong>/usr/bin/script</strong></span> per registrare una trascrizione della
sessione di aggiornamento. In tal modo, se si verificasse un problema si
disporrà di una registrazione di quanto accaduto e, se necessario, si
potranno fornire le informazioni esatte in un'eventuale segnalazione di
errori. Per avviare la registrazione, si digiti:
</p><pre class="screen">
# script -t 2&gt;~/upgrade-jessie<em class="replaceable"><code>fase</code></em>.time -a ~/upgrade-jessie<em class="replaceable"><code>fase</code></em>.script
</pre><p>
o un comando simile. Se fosse necessario fare la trascrizione di un'altra
sessione (perché, per esempio, è necessario riavviare il sistema), usare
valori diversi per <em class="replaceable"><code>fase</code></em> in modo da indicare anche
la fase dell'aggiornamento che si sta registrando. Non si collochi il file
della registrazione in una directory temporanea come
<code class="filename">/tmp</code> o <code class="filename">/var/tmp</code>, in quanto i file
in queste directory potrebbero venir cancellati durante l'aggiornamento o
durante un qualunque riavvio.
</p><p>
Il file generato permetterà anche di rileggere le informazioni scorse fuori
dalla schermata. Se si usa la console di sistema, basterà passare a VT2 (con
<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F2</strong></span>)
e, dopo aver effettuato l'accesso, utilizzare il comando <code class="literal">less -R
~root/upgrade-jessie.script</code> per visualizzare il file.
</p><p>
Dopo aver completato l'aggiornamento si può arrestare
<span class="command"><strong>script</strong></span>, digitando <code class="literal">exit</code> al prompt.
</p><p>
Se si è utilizzato il parametro <span class="emphasis"><em>-t</em></span> per
<span class="command"><strong>script</strong></span>, si può utilizzare il programma
<span class="command"><strong>scriptreplay</strong></span> per replicare l'intera sessione:
</p><pre class="screen">
# scriptreplay ~/upgrade-jessie.time ~/upgrade-jessie.script
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="updating-lists"></a>4.4.2. Aggiornamento della lista dei pacchetti</h3></div></div></div><p>
Anzitutto deve essere recuperata la lista dei pacchetti disponibili per la
nuova versione. Lo si fa eseguendo:
</p><pre class="screen">
# apt-get update
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sufficient-space"></a>4.4.3. Accertarsi di avere spazio disponibile a sufficienza per l'aggiornamento</h3></div></div></div><p>
Prima di aggiornare il proprio sistema ci si deve accertare di avere uno
spazio disponibile sufficiente sul proprio disco fisso al momento di far
partire l'aggiornamento completo del sistema, come descritto in <a class="xref" href="ch-upgrading.it.html#upgrading-full" title="4.4.5. Aggiornamento del sistema">Sezione 4.4.5, «Aggiornamento del sistema»</a>. Per prima cosa, poiché ogni pacchetto necessario
per l'installazione prelevato dalla rete è immagazzinato in
<code class="filename">/var/cache/apt/archives</code> (e nella sottodirectory
<code class="filename">partial/</code>, durante lo scaricamento), ci si dovrebbe
assicurare di avere spazio a sufficienza nella partizione del file system
che contiene <code class="filename">/var</code> per il temporaneo scaricamento dei
pacchetti che saranno installati nel sistema. Dopo lo scaricamento sarà
probabilmente necessario avere ulteriore spazio disponibile in altre
partizioni del file system per poter installare sia i pacchetti aggiornati
(che potrebbero contenere file binari più grossi o più dati), sia i nuovi
pacchetti che saranno introdotti con l'aggiornamento. Se il sistema non ha
spazio libero a sufficienza, si potrebbe finire con un aggiornamento
incompleto dal quale è difficile effettuare un ripristino.
</p><p>
<span class="command"><strong>apt-get</strong></span> può mostrare informazioni dettagliate sullo
spazio su disco necessario per l'installazione. È possibile visualizzare
questa stima prima di eseguire effettivamente l'aggiornamento, eseguendo:
</p><pre class="screen">
# apt-get -o APT::Get::Trivial-Only=true dist-upgrade
[ ... ]
XXX aggiornati, XXX installati, XXX da rimuovere e XXX non aggiornati.
È necessario scaricare xx.xMB di archivi.
Dopo quest'operazione, verranno occupati AAAMB di spazio su disco.
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
L'esecuzione di questo comando all'inizio del processo di aggiornamento
potrebbe restituire un errore, per le ragioni descritte nelle sezioni
seguenti. In tal caso sarà necessario attendere finché non sarà stato
eseguito l'aggiornamento minimo del sistema come descritto in <a class="xref" href="ch-upgrading.it.html#minimal-upgrade" title="4.4.4. Aggiornamento minimo del sistema">Sezione 4.4.4, «Aggiornamento minimo del sistema»</a> prima di eseguire il comando per avere una stima
dello spazio necessario su disco.
</p></td></tr></table></div><p>
Se lo spazio disponibile è insufficiente per l'aggiornamento,
<span class="command"><strong>apt-get</strong></span> avverte con un messaggio come questo:
</p><pre class="screen">
E: Spazio libero in /var/cache/apt/archives/ insufficiente.
</pre><p>In questo caso, accertarsi di liberare prima uno spazio sufficiente. È
possibile:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
Rimuovere i pacchetti che sono stati precedentemente scaricati per
l'installazione (in <code class="filename">/var/cache/apt/archives</code>). Pulire la
cache dei pacchetti eseguendo <span class="command"><strong>apt-get clean</strong></span>  rimuoverà
tutti i file dei pacchetti scaricati in precedenza.
</p></li><li class="listitem"><p>
Rimuovere i pacchetti dimenticati. Se si è usato <span class="command"><strong>aptitude</strong></span>
o <span class="command"><strong>apt-get</strong></span> per installare manualmente dei pacchetti in
wheezy, questi avranno tenuto traccia dei pacchetti installati
manualmente e saranno capaci di marcare come obsoleti quei pacchetti
installati solo per soddisfare delle dipendenze e che non sono più necessari
se un pacchetto viene rimosso. Non marcheranno per la rimozione i pacchetti
che sono stati installati manualmente dall'utente. Per rimuovere i pacchetti
installati automaticamente che non sono più usati, eseguire:
</p><pre class="screen">
# apt-get autoremove
</pre><p>
Si può anche utilizzare <span class="command"><strong>deborphan</strong></span>,
<span class="command"><strong>debfoster</strong></span> o <span class="command"><strong>cruft</strong></span> per trovare i
pacchetti ridondanti.  Non si rimuovano alla cieca i pacchetti presentati
dagli strumenti, soprattutto se si usano opzioni aggressive non predefinite
che possono produrre dei falsi positivi. È altamente raccomandato
controllare manualmente i pacchetti suggeriti per la rimozione (ossia il
loro contenuto, la loro dimensione e la descrizione) prima di rimuoverli.
</p></li><li class="listitem"><p>
Rimuovere i pacchetti che occupano molto spazio sul disco e non sono al
momento necessari (possono sempre essere reinstallati dopo
l'aggiornamento). Se si ha <code class="systemitem">popularity-contest</code><a id="idp48827424" class="indexterm"></a> installato, si può usare
<span class="command"><strong>popcon-largest-unused</strong></span> per elencare i pacchetti che non si
usano e che occupano più spazio. Si possono trovare i pacchetti che occupano
più spazio con <span class="command"><strong>dpigs</strong></span> (disponibile nel pacchetto
<code class="systemitem">debian-goodies</code><a id="idp48830848" class="indexterm"></a>) oppure con
<span class="command"><strong>wajig</strong></span> (eseguendo <code class="literal">wajig size</code>). Possono
anche essere trovati con <code class="systemitem">aptitude</code><a id="idp48834000" class="indexterm"></a>. Si avvii <span class="command"><strong>aptitude</strong></span>
in <span class="quote">«<span class="quote">modalità grafica</span>»</span>, si selezioni
<span class="guimenu">Viste</span> → <span class="guimenuitem">Nuovo elenco unito dei
pacchetti</span>, si prema <span class="keycap"><strong>l</strong></span> e si
inserisca <code class="literal">~i</code>, si prema <span class="keycap"><strong>S</strong></span> e si inserisca
<code class="literal">~installsize</code>, a quel punto si dovrebbe ottenere un
bell'elenco con cui lavorare. 
</p></li><li class="listitem"><p>
  Eliminare i file di traduzioni e localizzazioni dal sistema se non sono
necessari. È possibile installare il pacchetto <code class="systemitem">localepurge</code><a id="idp48842432" class="indexterm"></a> e configurarlo in modo che solo
poche localizzazioni selezionate vengano mantenute sul sistema. Questo
ridurrà lo spazio su disco occupato da
<code class="filename">/usr/share/locale</code>.
</p></li><li class="listitem"><p>
   Spostare temporaneamente su un altro sistema o rimuovere in modo permanente
i log di sistema che si trovano in <code class="filename">/var/log</code>.
</p></li><li class="listitem"><p>
    Usare un <code class="filename">/var/cache/apt/archives</code> temporaneo: è
possibile usare una directory di cache temporanea da un altro file system
(periferiche di memorizzazione <acronym title="Universal Serial Bus">USB</acronym>, dischi fissi
temporanei, file system già in uso, ecc.).
  </p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      Non si usi una partizione montata via <acronym title="Network File System">NFS</acronym>, in quanto la
connessione di rete potrebbe essere interrotta durante l'aggiornamento.
    </p></td></tr></table></div><p>
  Per esempio, se si possiede un disco o una penna <acronym title="Universal Serial Bus">USB</acronym>
montato in <code class="filename">/media/usbkey</code>:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
	si rimuovano i pacchetti precedentemente scaricati per l'installazione:

	</p><pre class="screen"># apt-get clean</pre><p>
      </p></li><li class="listitem"><p>
	si copi la directory <code class="filename">/var/cache/apt/archives</code> nella
periferica <acronym title="Universal Serial Bus">USB</acronym>:

	</p><pre class="screen"># cp -ax /var/cache/apt/archives /media/usbkey/</pre><p>
      </p></li><li class="listitem"><p>
	si monti la directory della cache temporanea su quella attuale:

	</p><pre class="screen"># mount --bind /media/usbkey/archives /var/cache/apt/archives</pre><p>
      </p></li><li class="listitem"><p>
	dopo l'aggiornamento, si ripristini la directory
<code class="filename">/var/cache/apt/archives</code> originale:

	</p><pre class="screen"># umount /media/usbkey/archives</pre><p>
      </p></li><li class="listitem"><p>
	si rimuova il restante <code class="filename">/media/usbkey/archives</code>.
      </p></li></ol></div><p>
  È possibile creare la cache temporanea su qualsiasi file system montato sul
proprio sistema.
  </p></li><li class="listitem"><p>
    Effettuare un aggiornamento minimo del sistema (vedere <a class="xref" href="ch-upgrading.it.html#minimal-upgrade" title="4.4.4. Aggiornamento minimo del sistema">Sezione 4.4.4, «Aggiornamento minimo del sistema»</a>) oppure degli aggiornamenti parziali seguiti da
un aggiornamento completo. Questo permette l'aggiornamento parziale del
sistema e permette di pulire la cache dei pacchetti prima dell'aggiornamento
completo.
  </p></li></ul></div><p>
Si noti che per rimuovere pacchetti in modo sicuro è preferibile tornare a
far puntare il proprio <code class="filename">sources.list</code> a wheezy,
come descritto in <a class="xref" href="ap-old-stuff.it.html#old-sources" title="A.2. Controllare la propria lista delle fonti">Sezione A.2, «Controllare la propria lista delle fonti»</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="minimal-upgrade"></a>4.4.4. Aggiornamento minimo del sistema</h3></div></div></div><p>
In alcuni casi, eseguire direttamente un aggiornamento completo (come
descritto più avanti) potrebbe rimuovere un gran numero di pacchetti che si
potrebbe voler mantenere. È quindi raccomandato un processo di aggiornamento
in due parti: prima un aggiornamento minimo che risolva questi conflitti,
poi un aggiornamento completo come descritto in <a class="xref" href="ch-upgrading.it.html#upgrading-full" title="4.4.5. Aggiornamento del sistema">Sezione 4.4.5, «Aggiornamento del sistema»</a>. 
</p><p>
Per farlo eseguire:
</p><pre class="screen">
# apt-get upgrade
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      In alcune versioni precedenti era raccomandato l'uso di
<span class="command"><strong>aptitude</strong></span> per l'aggiornamento. Questo programma non è
raccomandato per l'aggiornamento da wheezy a jessie.
    </p></td></tr></table></div><p>
Questo consentirà l'aggiornamento di quei pacchetti che possono essere
aggiornati senza richiedere l'installazione o la rimozione di altri
pacchetti.
</p><p>
L'aggiornamento minimo può essere utile anche quando non è possibile
effettuare un aggiornamento completo perché sul sistema c'è poco spazio
libero.
</p><p>
  Se è installato il pacchetto <code class="systemitem">apt-listchanges</code><a id="idp48874160" class="indexterm"></a>, esso mostrerà (con la sua
configurazione predefinita) all'interno di un paginatore informazioni
importanti sui pacchetti aggiornati. Premere <span class="keycap"><strong>q</strong></span> dopo averle
lette, per uscire dal paginatore e continuare l'aggiornamento.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrading-full"></a>4.4.5. Aggiornamento del sistema</h3></div></div></div><p>
Una volta completati i passaggi descritti in precedenza, si è pronti per
continuare con la parte principale dell'aggiornamento. Si esegua:
</p><pre class="screen">
# apt-get dist-upgrade
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      In alcune versioni precedenti era raccomandato l'uso di
<span class="command"><strong>aptitude</strong></span> per l'aggiornamento. Questo programma non è
raccomandato per l'aggiornamento da wheezy a jessie.
    </p></td></tr></table></div><p>
Questo comando eseguirà un aggiornamento completo del sistema, installando
le versioni più recenti disponibili di tutti i pacchetti e risolvendo i
possibili cambiamenti di dipendenze fra i pacchetti dei diversi rilasci. Se
necessario, esso installerà taluni nuovi pacchetti (normalmente nuove
versioni di librerie o pacchetti rinominati) e rimuoverà i pacchetti resi
obsoleti in conflitto.
</p><p>
In caso di aggiornamento da una serie di CD-ROM (o DVD), verrà chiesto di
inserire uno specifico CD in parecchi momenti dell'aggiornamento. Potrebbe
capitare di dover inserire più volte lo stesso CD: ciò è dovuto a pacchetti
correlati tra loro che sono stati distribuiti su diversi CD.
</p><p>
Nuove versioni di pacchetti attualmente installati che non possono essere
aggiornati senza modificare lo stato d'installazione di un altro pacchetto
saranno lasciate alla loro attuale versione (contrassegnati come <span class="quote">«<span class="quote">held
back</span>»</span>;, <span class="quote">«<span class="quote">bloccati</span>»</span>). Questo fatto può essere risolto o
utilizzando <span class="command"><strong>aptitude</strong></span>, per designare tali pacchetti per
l'installazione, o provando con <code class="literal">apt-get install
<em class="replaceable"><code>pacchetto</code></em></code>.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="trouble"></a>4.5. Possibili problemi durante l'aggiornamento</h2></div></div></div><p>
Nelle prossime sezioni sono descritti i problemi noti che potrebbero
verificarsi durante l'aggiornamento a jessie.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="immediate-configure"></a>4.5.1. Dist-upgrade fallisce con l'errore <span class="quote">«<span class="quote">Impossibile eseguire
immediatamente la configurazione</span>»</span></h3></div></div></div><p>
In alcuni casi il passo <span class="command"><strong>apt-get dist-upgrade</strong></span> può fallire
dopo aver scaricato i pacchetti, con l'errore:
</p><pre class="screen">
E: Impossibile eseguire immediatamente la configurazione su "<em class="replaceable"><code>pacchetto</code></em>". Per i dettagli vedere APT::Immediate-Configure in man 5 apt.conf.
</pre><p>
</p><p>
Se ciò si verifica, l'esecuzione invece di <span class="command"><strong>apt-get dist-upgrade -o
APT::Immediate-Configure=0</strong></span> dovrebbe permettere all'aggiornamento
di continuare.
</p><p>
In alternativa, aggiungere entrambe le fonti wheezy e
jessie al proprio <code class="filename">sources.list</code> ed eseguire
<span class="command"><strong>apt-get update</strong></span> può aiutare ad aggirare questo problema.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="expected-removals"></a>4.5.2. Rimozioni attese</h3></div></div></div><p>
Il processo d'aggiornamento a jessie potrebbe richiedere la rimozione
di pacchetti dal sistema. L'elenco preciso dei pacchetti varia in base ai
pacchetti installati. Queste note di rilascio forniscono un suggerimento
generico riguardo le rimozioni di pacchetti, ma, nel dubbio, prima di
proseguire si raccomanda di esaminare le rimozioni dei pacchetti che vengono
proposte. Per maggiori informazioni sui pacchetti obsoleti in jessie
vedere <a class="xref" href="ch-upgrading.it.html#obsolete" title="4.10. Pacchetti obsoleti">Sezione 4.10, «Pacchetti obsoleti»</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="conflicts-loops"></a>4.5.3. Conflitti e pre-dipendenze cicliche</h3></div></div></div><p>
Talvolta è necessario abilitare l'opzione
<code class="literal">APT::Force-LoopBreak</code> affinché APT possa rimuovere
temporaneamente un pacchetto essenziale, a causa di un circolo <span class="quote">«<span class="quote">è in
conflitto con</span>»</span>/<span class="quote">«<span class="quote">pre-dipende da</span>»</span>. Di norma
<span class="command"><strong>apt-get</strong></span> emetterà un avviso e cesserà l'aggiornamento. Si
può evitare questa situazione specificando l'opzione <code class="literal">-o
APT::Force-LoopBreak=1</code> nella riga di comando di
<span class="command"><strong>apt-get</strong></span>.
</p><p>
È possibile che la struttura di dipendenze di un sistema sia talmente
compromessa da richiedere un intervento manuale; ciò normalmente significa
l'uso di <span class="command"><strong>apt-get</strong></span> o di
</p><pre class="screen">
# dpkg --remove <em class="replaceable"><code>nome_pacchetto</code></em>
</pre><p>
per eliminare alcuni dei pacchetti che generano il problema, o
</p><pre class="screen">
# apt-get -f install
# dpkg --configure --pending
</pre><p>
In casi estremi potrebbe essere necessario forzare la re-installazione con
un comando del tipo di
</p><pre class="screen">
# dpkg --install <em class="replaceable"><code>/percorso/di/nome_pacchetto.deb</code></em>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="file-conflicts"></a>4.5.4. Conflitti tra file</h3></div></div></div><p>
Non si dovrebbero verificare conflitti tra file se si aggiorna da un sistema
wheezy <span class="quote">«<span class="quote">puro</span>»</span>, ma potrebbero verificarsi se sono
stati installati backport non ufficiali. Un conflitto tra file causerà un
errore simile al seguente:
</p><pre class="screen">
Spacchetto <em class="replaceable"><code>&lt;pacchetto-tizio&gt;</code></em> (da <em class="replaceable"><code>&lt;file-del-pacchetto-tizio&gt;</code></em>) ...
dpkg: errore processando <em class="replaceable"><code>&lt;pacchetto-tizio&gt;</code></em> (--install):
 tentata sovrascrittura di `<em class="replaceable"><code>&lt;nome-di-qualche-file&gt;</code></em>',
 che si trova anche nel pacchetto <em class="replaceable"><code>&lt;pacchetto-caio&gt;</code></em>
dpkg-deb: il sottoprocesso paste è stato terminato da un segnale (Pipe rotta)
 Sono occorsi degli errori processando:
 <em class="replaceable"><code>&lt;pacchetto-tizio&gt;</code></em>
</pre><p>
Si può tentare di risolvere un conflitto fra file rimuovendo forzatamente il
pacchetto menzionato nell'<span class="emphasis"><em>ultima</em></span> riga del messaggio
d'errore:
</p><pre class="screen">
# dpkg -r --force-depends <em class="replaceable"><code>nome_pacchetto</code></em>
</pre><p>
Dopo aver risolto questo problema, si dovrebbe poter riprendere
l'aggiornamento ripetendo i comandi <span class="command"><strong>apt-get</strong></span> descritti in
precedenza.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-changes"></a>4.5.5. Modifiche alla configurazione</h3></div></div></div><p>
Durante l'aggiornamento verranno poste domande riguardanti la configurazione
o la riconfigurazione di parecchi pacchetti. Quando viene chiesto se un
qualsiasi file nella directory <code class="filename">/etc/init.d</code> o il file
<code class="filename">/etc/manpath.config</code> deve essere sostituito con quello
fornito dal manutentore del pacchetto, di solito è necessario rispondere
affermativamente, per garantire la coerenza del sistema. Si può sempre
ritornare alle versioni precedenti, dal momento che queste verranno salvate
con l'estensione <code class="literal">.dpkg-old</code>.
</p><p>
Se non si è sicuri sul da farsi, ci si annoti il nome del pacchetto o del
file e si sistemino le cose in un momento successivo. Le informazioni
presentate sullo schermo durante l'aggiornamento possono essere riesaminate
dopo essere state cercate nel file generato durante l'aggiornamento.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="console-change"></a>4.5.6. Cambiare la sessione sulla console</h3></div></div></div><p>
Quando si usa la console locale del sistema per fare l'aggiornamento,
potrebbe accadere che durante l'aggiornamento la console sia spostata su una
vista diversa e che si perda la visibilità del processo
d'aggiornamento. Questo può accadere, per esempio, sui sistemi desktop
quando viene riavviato il display manager.
</p><p>
Per recuperare la console su cui era in corso l'aggiornamento, usare
<span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F1</strong></span>,
se si è nella schermata di avvio grafico, oppure usare <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F1</strong></span> se si è in
una console testuale locale, per tornare al terminale virtuale 1. Al posto
di F1 usare il tasto funzione con lo stesso numero del terminale virtuale su
cui era in corso l'aggiornamento. Per scorrere i diversi terminali in
modalità testuale è possibile usare <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>Freccia
sinistra</strong></span> o <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>Freccia
destra</strong></span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="package-specific-issues"></a>4.5.7. Pacchetti che richiedono un'attenzione particolare</h3></div></div></div><p>
Nella maggior parte dei casi l'aggiornamento dei pacchetti da
wheezy a jessie avviene tranquillamente. Ci sono pochi casi
in cui potrebbe essere necessario un qualche tipo d'intervento, prima o
durante l'aggiornamento; seguono i dettagli per ciascun pacchetto.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="issues-systemd"></a>4.5.7.1. systemd</h4></div></div></div><p>
    L'aggiornamento di Debian da wheezy a jessie migra in modo
predefinito il sistema init da SysV a systemd. A seconda del proprio sistema
e dalla configurazione può essere necessario fare alcune modifiche
manuali. I problemi conosciuti sono dettagliati in <a class="xref" href="ch-information.it.html#systemd-upgrade-default-init-system" title="5.6. L'aggiornamento installa il nuovo sistema init predefinito per Jessie">Sezione 5.6, «L'aggiornamento installa il nuovo sistema init predefinito per Jessie»</a>.
  </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="issues-lxc"></a>4.5.7.2. LXC</h4></div></div></div><p>
    Se è installato LXC potrebbero essere necessarie speciali cautele
nell'aggiornamento del proprio sistema e dei contenitori. Guardare <a class="xref" href="ch-information.it.html#lxc-upgrade-issues" title="5.8. Considerazioni sull'aggiornamento per host e contenitori LXC.">Sezione 5.8, «Considerazioni sull'aggiornamento per host e contenitori LXC.»</a> per i problemi conosciuti e le soluzioni.
  </p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="newkernel"></a>4.6. Aggiornare il kernel e i pacchetti collegati</h2></div></div></div><p>
Questa sezione spiega come aggiornare il kernel e identifica le relative
potenziali problematiche. Si può o installare uno dei pacchetti <code class="systemitem">linux-image-*</code><a id="idp48943440" class="indexterm"></a> forniti da Debian, oppure
compilare un kernel personalizzato dai sorgenti.
</p><p>
Si noti che molte informazioni in questa sezione sono basate sull'assunzione
che si utilizzerà uno dei kernel modulari di Debian, insieme con <code class="systemitem">initramfs-tools</code><a id="idp48945888" class="indexterm"></a> e <code class="systemitem">udev</code><a id="idp48947552" class="indexterm"></a>. Se si sceglie di utilizzare un kernel
personalizzato che non richiede un initrd, o se si utilizza un generatore di
initrd differente, alcune delle informazioni potrebbero non essere attinenti
al proprio caso specifico.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="kernel-metapackage"></a>4.6.1. Installazione di un metapacchetto del kernel</h3></div></div></div><p>
Quando si effettua il dist-upgrade da wheezy a jessie è
fortemente raccomandata, se non è ancora stata fatta, l'installazione di un
metapacchetto linux-image-*. Questi metapacchetti richiamano automaticamente
una nuova versione del kernel durante gli aggiornamenti. si può verificare
se ne è installato uno eseguendo:
</p><pre class="screen">
# dpkg -l "linux-image*" | grep ^ii | grep -i meta
</pre><p>
Se non si vede alcun output, si dovrà installare manualmente un nuovo
pacchetto linux-image oppure installare un metapacchetto linux-image. Per
vedere un elenco dei metapacchetti linux-image disponibili eseguire:
</p><pre class="screen">
# apt-cache search linux-image- | grep -i meta | grep -v transition
</pre><p>
Se non si è sicuri sul pacchetto da selezionare, si esegua <code class="literal">uname
-r</code> e si cerchi un pacchetto con un nome simile. Ad esempio, se si
vede <span class="quote">«<span class="quote"><code class="literal">2.6.32-5-amd64</code></span>»</span> è raccomandata
l'installazione di <code class="systemitem">linux-image-amd64</code><a id="idp48955968" class="indexterm"></a>. Si può anche utilizzare
<span class="command"><strong>apt-cache</strong></span> per vedere una lunga descrizione di ciascun
pacchetto che aiuti a scegliere il migliore disponibile. Ad esempio:
</p><pre class="screen">
# apt-cache show linux-image-amd64
</pre><p>
Si dovrebbe quindi utilizzare <code class="literal">apt-get install</code> per
installarlo. Una volta che questo nuovo kernel è installato si dovrebbe
riavviare alla prossima opportunità disponibile per poter godere dei
benefici offerti dalla nuova versione del kernel. Tuttavia guardare <a class="xref" href="ch-upgrading.it.html#nownownow" title="4.7. Cose da fare prima di riavviare il sistema">Sezione 4.7, «Cose da fare prima di riavviare il sistema»</a> prima di effettuare il primo riavvio dopo
l'aggiornamento.
</p><p>
Per i più avventurosi esiste un modo agevole per compilare il proprio kernel
personalizzato su Debian. Si installino i sorgenti del kernel forniti nel
pacchetto <code class="systemitem">linux-source</code><a id="idp48962112" class="indexterm"></a>. Per
compilare un pacchetto binario si può usare il target
<code class="literal">deb-pkg</code> disponibile nel makefile dei sorgenti. Ulteriori
informazioni possono essere trovate nel <a class="ulink" href="http://kernel-handbook.alioth.debian.org/" target="_top">Debian Linux Kernel
Handbook</a>, che può a sua volta essere trovato anche nel pacchetto
<code class="systemitem">debian-kernel-handbook</code><a id="idp48965584" class="indexterm"></a>.
</p><p>
Se possibile, è preferibile aggiornare il pacchetto del kernel separatamente
dall'aggiornamento <code class="literal">dist-upgrade</code> principale, per ridurre i
rischi di trovarsi con un sistema temporaneamente non avviabile. Si noti che
questo dovrebbe essere fatto soltanto dopo il processo di aggiornamento
minimo descritto in <a class="xref" href="ch-upgrading.it.html#minimal-upgrade" title="4.4.4. Aggiornamento minimo del sistema">Sezione 4.4.4, «Aggiornamento minimo del sistema»</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="initramfs-tools-issues"></a>4.6.2. Cambiamenti al montaggio e controllo di file system radice e
<code class="filename">/usr</code></h3></div></div></div><p>
    <code class="systemitem">initramfs-tools</code><a id="idp48971328" class="indexterm"></a> ora esegue
<code class="literal">fsck</code> anche sul file system radice prima di montarlo. Se
il programma init scelto è <code class="literal">systemd</code> e c'è un file system
<code class="filename">/usr</code> separato, esegue fsck anche su
<code class="filename">/usr</code> e lo monta.
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
	Se <code class="filename">/usr</code> è un file system separato su un dispositivo
RAID e l'impostazione <code class="literal">INITRDSTART</code> in
<code class="filename">/etc/default/mdadm</code> non è «<code class="literal">all</code>», è
necessario cambiarla per includere tale dispositivo.
      </p></li><li class="listitem"><p>
	Se <code class="filename">/usr</code> è un file system separato su un volume logico
LVM e la riga per <code class="filename">/usr</code> in
<code class="filename">/etc/fstab</code> specifica il dispositivo con
l'<code class="literal">UUID</code> o la <code class="literal">LABEL</code>, è necessario
cambiare tale riga per specificare il dispositivo usando il formato
<code class="filename">/dev/mapper/<em class="replaceable"><code>VG</code></em>-<em class="replaceable"><code>LV</code></em></code>
o
<code class="filename">/dev/<em class="replaceable"><code>VG</code></em>/<em class="replaceable"><code>LV</code></em></code>.
      </p></li><li class="listitem"><p>
	Non è più possibile il bind-mount del file system <code class="filename">/usr</code>.
      </p></li><li class="listitem"><p>
	Se il RTC (Real Time Clock, orologio del tempo reale) è impostato all'ora
locale e questa è avanti rispetto a UTC, <code class="literal">e2fsck</code> mostra un
avvertimento durante l'avvio riguardo il fatto che l'ora si è spostata
indietro (<a class="ulink" href="https://bugs.debian.org/767040" target="_top">bug
n. 767040</a>). Questo può essere disabilitato mettendo le righe
seguenti in <code class="filename">/etc/e2fsck.conf</code>:
      </p><pre class="screen">
[options]
broken_system_clock=1
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="nownownow"></a>4.7. Cose da fare prima di riavviare il sistema</h2></div></div></div><p>
Quando <code class="literal">apt-get dist-upgrade</code> è giunto al termine,
l'aggiornamento <span class="quote">«<span class="quote">formale</span>»</span> è concluso, ma vi sono alcune altre
cose di cui ci si dovrebbe preoccupare <span class="emphasis"><em>prima</em></span> del
successivo riavvio.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
      Quando si aggiorna da Wheezy a Jessie può essere una buona
idea eliminare completamente i vecchi pacchetti <span class="emphasis"><em>prima</em></span>
del primo riavvio. In particolare gli script init obsoleti possono causare
problemi. Fare riferimento a <a class="xref" href="ch-upgrading.it.html#purge-removed-packages" title="4.8.1. Eliminare completamente i pacchetti rimossi">Sezione 4.8.1, «Eliminare completamente i pacchetti rimossi»</a> per i
dettagli su come trovare ed eliminare completamente i pacchetti rimossi.
    </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="for-next"></a>4.8. Preparazione per il prossimo rilascio</h2></div></div></div><p>
Dopo l'aggiornamento ci sono molte cose che si possono fare per prepararsi
per il prossimo rilascio.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
Si rimuovano i pacchetti ora obsoleti o ridondanti come descritto in <a class="xref" href="ch-upgrading.it.html#sufficient-space" title="4.4.3. Accertarsi di avere spazio disponibile a sufficienza per l'aggiornamento">Sezione 4.4.3, «Accertarsi di avere spazio disponibile a sufficienza per l'aggiornamento»</a> e <a class="xref" href="ch-upgrading.it.html#obsolete" title="4.10. Pacchetti obsoleti">Sezione 4.10, «Pacchetti obsoleti»</a>. Si dovrebbe
controllare quali file di configurazione questi usano e considerare
l'eliminazione completa dei pacchetti per rimuovere i loro file di
configurazione. Vedere anche <a class="xref" href="ch-upgrading.it.html#purge-removed-packages" title="4.8.1. Eliminare completamente i pacchetti rimossi">Sezione 4.8.1, «Eliminare completamente i pacchetti rimossi»</a>.
</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="purge-removed-packages"></a>4.8.1. Eliminare completamente i pacchetti rimossi</h3></div></div></div><p>
    È generalmente consigliabile eliminare completamenti i pacchetti
rimossi. Questo è particolarmente vero se i pacchetti sono stati rimossi in
aggiornamenti a rilasci precedenti (es. nell'aggiornamento a
wheezy) o se sono stati forniti da produttori esterni. In
particolare è noto che i vecchi script init.d possono causare problemi.
  </p><div class="caution"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Attenzione]" src="images/caution.png" /></td><th align="left">Attenzione</th></tr><tr><td align="left" valign="top"><p>
      L'eliminazione completa di un pacchetto in genere elimina anche i suoi file
di log, perciò può essere desiderabile farne prima un backup.
    </p></td></tr></table></div><p>
    Il comando seguente mostra un elenco di tutti i pacchetti rimossi che
potrebbero avere dei file di configurazione rimasti nel sistema:
  </p><pre class="screen">
# dpkg -l | awk '/^rc/ { print $2 }'
</pre><p>
    I pacchetti possono essere rimossi usando <span class="command"><strong>apt-get
purge</strong></span>. Ipotizzando di volerli eliminare completamente tutti in una
volta, si può usare il comando seguente:
  </p><pre class="screen">
# apt-get purge $(dpkg -l | awk '/^rc/ { print $2 }')
</pre><p>
    Se si usa <code class="systemitem">aptitude</code><a id="idp49015056" class="indexterm"></a> si possono anche
usare le seguenti alternative ai comandi precedenti:
  </p><pre class="screen">
$ aptitude search '~c'
$ aptitude purge '~c'
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deprecated"></a>4.9. Componenti deprecati</h2></div></div></div><p>
Con la prossima versione di Debian 9 (nome in codice
stretch) alcune funzionalità verranno rese deprecate. Gli utenti
dovranno migrare verso una delle alternative in modo da prevenire problemi
durante l'aggiornamento a 9.
</p><p>
Questo include le seguenti funzionalità:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Il pacchetto <code class="systemitem">hardening-wrapper</code><a id="idp49021040" class="indexterm"></a> è
diventato deprecato ed è stata pianificata la sua rimozione in Stretch.
		</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="obsolete"></a>4.10. Pacchetti obsoleti</h2></div></div></div><p>
jessie introduce moltissimi nuovi pacchetti, ma nel contempo ritira e
manca di un numero piuttosto grande di vecchi pacchetti che erano in
wheezy. Non viene fornito alcun percorso di aggiornamento per
questi pacchetti obsoleti. Nulla impedisce di continuare a usare pacchetti
obsoleti, se così si desidera, ma il progetto Debian terminerà solitamente
il supporto di sicurezza per essi un anno dopo il rilascio di
jessie<a href="#ftn.idp49024624" class="footnote" id="idp49024624"><sup class="footnote">[5]</sup></a> e normalmente non fornirà
altro supporto oltre a quello nel frattempo. È raccomandata la loro
sostituzione con le alternative disponibili, se ve ne sono.
</p><p>
Vi sono molte ragioni per cui i pacchetti possono essere stati rimossi dalla
distribuzione: non sono più mantenuti a monte, non vi sono più sviluppatori
Debian interessati alla manutenzione dei pacchetti, le funzionalità fornite
sono state superate da altri software o da una nuova versione, oppure non
sono più considerati adatti per jessie a causa di errori. In
quest'ultimo caso, i pacchetti potrebbero continuare a essere presenti nella
distribuzione <span class="quote">«<span class="quote">unstable</span>»</span>.
</p><p>
Trovare quali pacchetti in un sistema aggiornato sono
<span class="quote">«<span class="quote">obsoleti</span>»</span> è facile, poiché le interfacce dei gestori di
pacchetti li marcheranno come tali. Se si usa <span class="command"><strong>aptitude</strong></span>,
si vedrà una lista di questi pacchetti nella sezione <span class="quote">«<span class="quote">Pacchetti
obsoleti e creati localmente</span>»</span>.
</p><p>
Il <a class="ulink" href="https://bugs.debian.org/" target="_top">Sistema di tracciamento dei bug (BTS) di
Debian</a> fornisce spesso informazioni aggiuntive sul perché un
determinato pacchetto è stato rimosso. Si dovrebbero visionare sia i
rapporti per il pacchetto stesso, sia i rapporti archiviati dei bug per lo
<a class="ulink" href="https://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=ftp.debian.org&amp;archive=yes" target="_top">pseudo-pacchetto
ftp.debian.org</a>.
</p><p>
  L'elenco dei pacchetti obsoleti comprende:
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
	<code class="systemitem">postgresql-9.1</code><a id="idp49034272" class="indexterm"></a>, il successore è
<code class="systemitem">postgresql-9.4</code><a id="idp49035984" class="indexterm"></a>. Una volta terminato
l'aggiornamento del sistema operativo, si dovrebbe pianificare anche
l'aggiornamento dei propri cluster database di PostgreSQL 9.1 alla nuova
versione 9.4 di PostgreSQL, usando lo strumento
<span class="command"><strong>pg_upgradecluster</strong></span>. Per gli utenti del linguaggio
procedurale PL/perl, jessie fornisce un pacchetto <code class="systemitem">postgresql-plperl-9.1</code><a id="idp49038656" class="indexterm"></a> aggiornato con link alla
versione di libperl in jessie per permettere l'aggiornamento alla nuova
versione di Perl in jessie pur mantenendo utilizzabili le vecchie funzioni
PL/perl per database fino a che non è aggiornato anche il database.
      </p></li><li class="listitem"><p>
        
        
<code class="systemitem">python3.2</code><a id="idp49041600" class="indexterm"></a>, il successore è
<code class="systemitem">python3.4</code><a id="idp49043312" class="indexterm"></a>. (La versione 2.7 è
supportata in entrambi i rilaci wheezy e jessie.)
      </p></li><li class="listitem"><p>
        <code class="systemitem">ruby1.8</code><a id="idp49045920" class="indexterm"></a> e <code class="systemitem">ruby1.9.1</code><a id="idp49047584" class="indexterm"></a>, il successore è <code class="systemitem">ruby2.1</code><a id="idp49049296" class="indexterm"></a>. Installare il pacchetto <code class="systemitem">ruby</code><a id="idp49051008" class="indexterm"></a> per tenere automaticamente traccia della
versione attuale di ruby.
      </p></li><li class="listitem"><p>
        <code class="systemitem">mplayer</code><a id="idp49053536" class="indexterm"></a>, le alternative sono
<code class="systemitem">mplayer2</code><a id="idp49055232" class="indexterm"></a> e <code class="systemitem">mpv</code><a id="idp49056912" class="indexterm"></a> (nuovo in jessie). Mentre il primo è
per lo più compatibile con mplayer per ciò che riguarda gli argomenti della
riga di comando e la configurazione (e aggiunge anche alcune nuove
funzionalità), il secondo aggiunge molte nuove funzionalità e migliorie ed è
attivamente mantenuto a monte.
      </p></li><li class="listitem"><p>
        <code class="systemitem">openoffice.org</code><a id="idp49059936" class="indexterm"></a>; usare <code class="systemitem">libreoffice</code><a id="idp49061632" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        <code class="systemitem">squid</code><a id="idp49064096" class="indexterm"></a>, il successore è <code class="systemitem">squid3</code><a id="idp49065808" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        <code class="systemitem">libjpeg-progs</code><a id="idp49068272" class="indexterm"></a>, il successore è
<code class="systemitem">libjpeg-turbo-progs</code><a id="idp49069984" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        <code class="systemitem">openjdk-6-*</code><a id="idp49072448" class="indexterm"></a>, il successore è
<code class="systemitem">openjdk-7-*</code><a id="idp49074160" class="indexterm"></a>.
      </p></li></ul></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="dummy"></a>4.10.1. Pacchetti fittizi</h3></div></div></div><p>
Taluni pacchetti per wheezy sono stati suddivisi in diversi
pacchetti in jessie, spesso al fine di migliorare la manutenzione del
sistema. Per facilitare il percorso di aggiornamento in tali casi,
jessie spesso fornisce pacchetti <span class="quote">«<span class="quote">fittizi</span>»</span>, che sono
pacchetti vuoti che hanno lo stesso nome del vecchio pacchetto in
wheezy con dipendenze che causano l'installazione dei nuovi
pacchetti. Questi pacchetti <span class="quote">«<span class="quote">fittizi</span>»</span> sono considerati
superflui dopo l'aggiornamento e possono essere rimossi in tutta sicurezza.
</p><p>
La descrizione della maggior parte dei pacchetti fittizi, ma non di tutti,
indica il loro scopo. Purtroppo le descrizioni dei pacchetti fittizi non
sono uniformi, per cui si potrebbe anche trovare utile lo strumento
<span class="command"><strong>deborphan</strong></span> con le opzioni
<code class="literal">--guess-<em class="replaceable"><code>*</code></em></code> (per esempio
<code class="literal">--guess-dummy</code>) per trovarli nel proprio sistema. Si noti
che alcuni pacchetti fittizi non sono creati per essere rimossi dopo un
aggiornamento ma, invece, servono per tener traccia nel tempo della versione
attualmente disponibile di un programma.
</p></div></div><div class="footnotes"><br /><hr width="100" align="left" /><div id="ftn.idp48614448" class="footnote"><p><a href="#idp48614448" class="para"><sup class="para">[1] </sup></a>Se la priorità di debconf è impostata ad un valore molto alto potrebbe
bloccare i prompt di configurazione quindi i servizi che si basano su
risposte predefinite che non sono appropriate per il proprio sistema non
partiranno.</p></div><div id="ftn.idp48615984" class="footnote"><p><a href="#idp48615984" class="para"><sup class="para">[2] </sup></a>Per esempio i servizi DNS e DHCP, in modo particolare se non c'è ridondanza
o failover. Nel caso del DHCP gli utenti finali potrebbero essere
disconnessi dalla rete se il lease time è inferiore al tempo necessario per
la conclusione dell'aggiornamento.</p></div><div id="ftn.idp48631280" class="footnote"><p><a href="#idp48631280" class="para"><sup class="para">[3] </sup></a> Questa funzionalità può essere disabilitata aggiungendo il parametro
<code class="literal">panic=0</code> ai parametri di avvio del proprio sistema.  </p></div><div id="ftn.idp48715440" class="footnote"><p><a href="#idp48715440" class="para"><sup class="para">[4] </sup></a> Normalmente il sistema di gestione di pacchetti di Debian non consente a un
pacchetto di rimuovere o sostituire un file controllato da un altro
pacchetto, a meno che non sia stato definito che il primo pacchetto
sostituisce il secondo.  </p></div><div id="ftn.idp49024624" class="footnote"><p><a href="#idp49024624" class="para"><sup class="para">[5] </sup></a> O per tutto il tempo in cui non uscirà un altro rilascio. Tipicamente solo
due rilasci stabili sono supportati contemporaneamente.  </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch-installing.it.html"><img src="images/prev.png" alt="Indietro" /></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch-information.it.html"><img src="images/next.png" alt="Avanti" /></a></td></tr><tr><td width="40%" align="left" valign="top">Capitolo 3. Sistema d'installazione </td><td width="20%" align="center"><a accesskey="h" href="index.it.html"><img src="images/home.png" alt="Partenza" /></a></td><td width="40%" align="right" valign="top"> Capitolo 5. Problemi di cui essere al corrente per jessie</td></tr></table></div></body></html>