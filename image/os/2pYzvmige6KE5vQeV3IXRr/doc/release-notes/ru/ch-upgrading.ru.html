<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Глава 4. Обновление с Debian 7 (wheezy)</title><link rel="stylesheet" type="text/css" href="debian.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.ru.html" title="Информация о выпуске Debian 8 (jessie) для архитектуры 64-bit PC" /><link rel="up" href="index.ru.html" title="Информация о выпуске Debian 8 (jessie) для архитектуры 64-bit PC" /><link rel="prev" href="ch-installing.ru.html" title="Глава 3. Система установки" /><link rel="next" href="ch-information.ru.html" title="Глава 5. Что нужно знать о jessie" /><meta xmlns="" name="viewport" content="width=device-width, initial-scale=1" /><style xmlns="" type="text/css">
      body {
        background-repeat: no-repeat;
        background-image: none;
      }
    </style></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Глава 4. Обновление с Debian 7 (wheezy)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch-installing.ru.html"><img src="images/prev.png" alt="Пред." /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch-information.ru.html"><img src="images/next.png" alt="След." /></a></td></tr></table><hr /></div><div xml:lang="ru" class="chapter" lang="ru"><div class="titlepage"><div><div><h1 class="title"><a id="ch-upgrading"></a>Глава 4. Обновление с Debian 7 (wheezy)</h1></div></div></div><div class="toc"><p><strong>Содержание</strong></p><dl class="toc"><dt><span class="section"><a href="ch-upgrading.ru.html#backup">4.1. Подготовка к обновлению</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.ru.html#data-backup">4.1.1. Создание резервной копии всех данных и настроек</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#inform-users">4.1.2. Предварительное информирование пользователей</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#services-downtime">4.1.3. Подготовка к перерыву в работе служб</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#recovery">4.1.4. Подготовка к восстановлению</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#upgrade-preparations">4.1.5. Подготовка безопасного окружения для обновления</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.ru.html#system-status">4.2. Проверка состояния системы</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.ru.html#review-actions">4.2.1. Просмотр отложенных действий менеджера пакетов</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#disable-apt-pinning">4.2.2. Отключение фиксации в APT</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#package-status">4.2.3. Проверка состояния пакетов</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#proposed-updates">4.2.4. Секция proposed-updates</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#unofficial-sources">4.2.5. Неофициальные источники</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.ru.html#upgrade-process">4.3. Подготовка источников APT</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.ru.html#network">4.3.1. Добавление интернет-источников в APT</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#localmirror">4.3.2. Добавление локального зеркала в качестве источника APT</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#cdroms">4.3.3. Добавление оптического носителя в качестве источника APT</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.ru.html#upgradingpackages">4.4. Обновление пакетов</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.ru.html#record-session">4.4.1. Запись сеанса</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#updating-lists">4.4.2. Обновление списка пакетов</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#sufficient-space">4.4.3. Проверка доступного пространства для обновления</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#minimal-upgrade">4.4.4. Минимальное обновление системы</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#upgrading-full">4.4.5. Обновление системы</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.ru.html#trouble">4.5. Возможные проблемы во время обновления</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.ru.html#immediate-configure">4.5.1. Dist-upgrade завершается с ошибкой «Could not perform immediate
configuration»</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#expected-removals">4.5.2. Ожидаемые удаления</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#conflicts-loops">4.5.3. Конфликты или зацикливание в требованиях предварительной установки</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#file-conflicts">4.5.4. Файловые конфликты</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#configuration-changes">4.5.5. Изменение настроек</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#console-change">4.5.6. Изменение консоли сеанса</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#package-specific-issues">4.5.7. Повышенное внимание для определённых пакетов</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.ru.html#newkernel">4.6. Обновление ядра и сопутствующих пакетов</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.ru.html#kernel-metapackage">4.6.1. Установка метапакета ядра</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#initramfs-tools-issues">4.6.2. Изменения в монтировании и проверке корневой файловой системы и файловой
системы <code class="filename">/usr</code></a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.ru.html#nownownow">4.7. Перед перезагрузкой</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#for-next">4.8. Подготовка к следующему выпуску</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.ru.html#purge-removed-packages">4.8.1. Вычистка удалённых пакетов</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.ru.html#deprecated">4.9. Исключённые компоненты</a></span></dt><dt><span class="section"><a href="ch-upgrading.ru.html#obsolete">4.10. Устаревшие пакеты</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.ru.html#dummy">4.10.1. Пакеты-пустышки</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="backup"></a>4.1. Подготовка к обновлению</h2></div></div></div><p>
Перед обновлением мы рекомендуем вам также прочитать <a class="xref" href="ch-information.ru.html" title="Глава 5. Что нужно знать о jessie">Глава 5, <em>Что нужно знать о jessie</em></a>. Этот раздел описывает потенциальные проблемы,
которые не имеют прямого отношения к процессу обновления, но всё же важно
узнать о них до установки.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="data-backup"></a>4.1.1. Создание резервной копии всех данных и настроек</h3></div></div></div><p>
Перед обновлением настоятельно рекомендуется сделать резервную копию всей
системы или, по крайней мере, всех данных и настроек, которые вы не можете
позволить себе потерять. Инструменты для обновления и сам процесс достаточно
надёжны, но сбой аппаратного обеспечения в ходе обновления может привести к
серьёзному повреждению системы.
</p><p>
В первую очередь необходимо сделать резервную копию содержимого каталогов
<code class="filename">/etc</code>, <code class="filename">/var/lib/dpkg</code>,
<code class="filename">/var/lib/apt/extended_states</code> и результата работы
команды <code class="literal">dpkg --get-selections "*"</code> (кавычки важны). Если
для управления пакетами вы используете <span class="command"><strong>aptitude</strong></span>, то также
сделайте резервную копию <code class="filename">/var/lib/aptitude/pkgstates</code>.
</p><p>
Обновление само по себе никак не затрагивает каталог
<code class="filename">/home</code>. Однако некоторые приложения (в частности,
некоторые приложения Mozilla, окружения рабочего стола GNOME и KDE) при
первом запуске новой версии перезаписывают имеющиеся пользовательские
настройки новыми настройками по умолчанию. На всякий случай стоит сделать
резервную копию скрытых файлов и каталогов (название которых начинается с
точки) из домашних каталогов пользователей. Это поможет вам в случае
необходимости восстановить старые настройки. Не лишним будет предупредить
пользователей об этой проблеме.
</p><p>
Установка любого пакета должна производиться с привилегиями
суперпользователя. Поэтому вы должны либо войти в систему под именем
суперпользователя <code class="literal">root</code>, либо использовать программы
<span class="command"><strong>su</strong></span> или <span class="command"><strong>sudo</strong></span>, чтобы получить
необходимые права.
</p><p>
Для проведения обновления есть несколько предварительных требований;
проверьте, что они соблюдаются.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="inform-users"></a>4.1.2. Предварительное информирование пользователей</h3></div></div></div><p>
Желательно заранее сообщать всем пользователям о любых планируемых
обновлениях, хотя пользователи, работающие в системе через
<span class="command"><strong>ssh</strong></span>, не должны испытать особых проблем в процессе
обновления и вполне могут продолжать работу. 
</p><p>
Если вы хотите принять дополнительные меры предосторожности, создайте
резервную копию и размонтируйте раздел <code class="filename">/home</code> перед
обновлением.
</p><p>
При обновлении до jessie потребуется обновить ядро, поэтому
потребуется перезагрузка. Обычно, это происходит по окончании обновления.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="services-downtime"></a>4.1.3. Подготовка к перерыву в работе служб</h3></div></div></div><p>
При обновлении может потребоваться обновить пакеты для работающих на данной
машине служб. В этом случае работа служб будет прервана на время обновления,
замены и настройки пакетов.
</p><p>
Точное время простоя служб будет зависеть от количества обновляемых в
системе пакетов, а также от времени, затрачиваемое администратором для
ответов на вопросы о настройке. Заметим, что если процесс обновления
оставить без внимания и не следить за запросами системы,то высока
вероятность увеличить недоступность служб<a href="#ftn.idp62166944" class="footnote" id="idp62166944"><sup class="footnote">[1]</sup></a> на значительный промежуток времени.
</p><p>
Если обновляемая система предоставляет критически важные службы для
пользователей или сети<a href="#ftn.idp62169232" class="footnote" id="idp62169232"><sup class="footnote">[2]</sup></a>, то вы можете
сократить время простоя, если сначала выполните минимальное обновление
системы (см. <a class="xref" href="ch-upgrading.ru.html#minimal-upgrade" title="4.4.4. Минимальное обновление системы">Раздел 4.4.4, «Минимальное обновление системы»</a>), затем обновите ядро и
перезагрузитесь, а затем обновите пакеты, связанные с вашими критическими
службами. Описание обновления этих пакетов перед полным обновлением смотрите
в <a class="xref" href="ch-upgrading.ru.html#upgrading-full" title="4.4.5. Обновление системы">Раздел 4.4.5, «Обновление системы»</a>. Такой порядок позволяет оставить
работающими критические службы на время прохождения полного обновления и
сократить время простоя.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="recovery"></a>4.1.4. Подготовка к восстановлению</h3></div></div></div><p>
Хотя Debian пытается проверить, что система всегда будет в состоянии
загрузиться, есть реальная опасность возникновения проблем после
перезагрузки в обновлённую систему. Большая часть возможных проблем описана
здесь и далее в следующих главах информации о выпуске.
</p><p>
Поэтому лучше удостовериться, что вы сможете вернуть систему в прежнее
состояние, если она не сможет загрузиться или, для систем управляемых
удалённо, не заработает сеть.
</p><p>
Если обновление производится удалённо через <span class="command"><strong>ssh</strong></span>,
рекомендуем вам предусмотреть подключение к локальной консоли сервера через
удалённый последовательный терминал. Может случиться так, что после
обновления ядра и перезагрузки, вам потребуется исправить системные
настройки через локальную консоль. Если система случайно перезагрузится в
середине процесса обновления, вам также потребуется локальная консоль для
восстановления.
</p><p>
Обычно мы рекомендуем использовать <span class="emphasis"><em>режим восстановления</em></span>
из программы установки Debian jessie. Преимущество в использовании
программы установки в том, что вы можете выбирать из множества методов
установки тот, который лучше подходит в вашей ситуации. Дополнительная
информация приведена в разделе <span class="quote">«<span class="quote">Восстановление сломанной
системы</span>»</span> главы 8 <a class="ulink" href="https://www.debian.org/releases/jessie/installmanual" target="_top">руководства по
установке</a> и в <a class="ulink" href="https://wiki.debian.org/DebianInstaller/FAQ" target="_top">ЧаВО по
программе установки Debian</a>.
</p><p>
Если загрузиться не удалось, вам может потребоваться альтернативный способ
загрузки системы для доступа и восстановления. Для этого можно
воспользоваться специальным образом восстановления или Linux-live CD. После
загрузки каким-то из способов, вы сможете смонтировать имеющуюся корневую
файловую систему и выполнить в неё <code class="literal">chroot</code>, чтобы найти и
исправить ошибку.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="recovery-initrd"></a>4.1.4.1. Отладочная оболочка из initrd во время загрузки</h4></div></div></div><p>
Пакет <code class="systemitem">initramfs-tools</code><a id="idp62186272" class="indexterm"></a> добавляет
отладочную оболочку<a href="#ftn.idp62187168" class="footnote" id="idp62187168"><sup class="footnote">[3]</sup></a> в создаваемый
initrd. Например, если initrd не удастся смонтировать корневую файловую
систему, то вы попадёте в эту отладочную оболочку; она предоставляет
основные команды, которые помогут вам выяснить в чём дело и, возможно, даже
всё исправить.
</p><p>
Что нужно проверить: наличие правильных файлов устройств в каталоге
<code class="filename">/dev</code>; какие модули загружены (<code class="literal">cat
/proc/modules</code>); проверить в результатах <span class="command"><strong>dmesg</strong></span>
отсутствие ошибок при загрузке драйверов. Вывод <span class="command"><strong>dmesg</strong></span>
также покажет соответствие назначенных файлов устройств дискам; убедитесь,
что результатом <code class="literal">echo $ROOT</code> является ожидаемое устройство
для корневой файловой системы.
</p><p>
Если вы решили проблему, для выхода из отладочной оболочки наберите
<code class="literal">exit</code>, и процесс загрузки продолжится с места
останова. Естественно, вам нужно устранить причину и пересоздать initrd для
того, чтобы следующая загрузка прошла без проблем.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="recovery-shell-systemd"></a>4.1.4.2. Отладочная оболочка во время загрузки с использованием systemd</h4></div></div></div><p>
    Если не удаётся загрузиться под systemd, можно запустить командную оболочку
с правами суперпользователя, изменив строку команд ядра. Если базовая
загрузка завершается успешно, но некоторые службы не запускаются, может быть
полезным добавить команду <code class="literal">systemd.unit=rescue.target</code> к
параметрам ядра.
  </p><p>
    В противном случае параметр ядра
<code class="literal">systemd.unit=emergency.target</code> как можно раньше
предоставит вам командную оболочку с правами суперпользователя. Тем не
менее, это выполняется до монтирования корневой файловой системы с правами
на чтение. Вам придётся выполнить это вручную с помощью следующей команды:
  </p><pre class="screen">
mount -o remount,rw /
</pre><p>
    Дополнительная информация об отладке сломанной загрузки под systemd может
быть найдена в статье <a class="ulink" href="http://freedesktop.org/wiki/Software/systemd/Debugging/" target="_top">Диагностирования
проблем загрузки</a>.
  </p><p>
    Если ничего не получается, вы можете загрузиться с помощью старой системы
инициализации, sysvinit. Для этого необходимо, чтобы пакет был установлен
<code class="systemitem">sysvinit</code><a id="idp62204608" class="indexterm"></a>, а двоичный файл
<code class="filename">/lib/sysvinit/init</code> был добавлен в initramfs. Если эти
требования выполнены, добавьте параметр
<code class="literal">init=/lib/sysvinit/init</code> в командную строку ядра, это
приведёт к загрузке через sysvinit.
  </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrade-preparations"></a>4.1.5. Подготовка безопасного окружения для обновления</h3></div></div></div><p>
Обновление дистрибутива возможно как локально через виртуальную текстовую
консоль (или подключённый напрямую терминал к последовательному порту), так
и удалённо через <span class="command"><strong>ssh</strong></span>. 
</p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Важно]" src="images/important.png" /></td><th align="left">Важно</th></tr><tr><td align="left" valign="top"><p>
  Если вы используете одну из служб VPN (такую как <code class="systemitem">tinc</code><a id="idp62211664" class="indexterm"></a>), то они могут быть недоступны во время
обновления, см. <a class="xref" href="ch-upgrading.ru.html#services-downtime" title="4.1.3. Подготовка к перерыву в работе служб">Раздел 4.1.3, «Подготовка к перерыву в работе служб»</a>.
  </p></td></tr></table></div><p>
Чтобы ещё более усилить безопасность, советуем запускать обновление в
виртуальной консоли, созданной с помощью программы
<span class="command"><strong>screen</strong></span>, которая позволяет безопасно переподключаться и
таким образом обновление не будет прервано, даже если произойдёт обрыв
связи.
</p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Важно]" src="images/important.png" /></td><th align="left">Важно</th></tr><tr><td align="left" valign="top"><p>
    Ни в коем случае <span class="emphasis"><em>не</em></span> обновляйте систему через
<span class="command"><strong>telnet</strong></span>, <span class="command"><strong>rlogin</strong></span>, <span class="command"><strong>rsh</strong></span>
или из графического сеанса под управлением <span class="command"><strong>xdm</strong></span>,
<span class="command"><strong>gdm</strong></span>, <span class="command"><strong>kdm</strong></span> и т.д., запущенного на
обновляемой системе. Это связано с тем, что все эти службы могут быть
перезапущены при обновлении, что может привести к
<span class="emphasis"><em>недоступности</em></span> системы, обновлённой только
наполовину. Для обновления до нового выпуска <span class="emphasis"><em>настоятельно не
рекомендуется</em></span> использовать приложения GNOME
<span class="command"><strong>update-manager</strong></span>, так как при работе этого инструмента
считается, что сеанс рабочего стола не может прерваться.
  </p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="system-status"></a>4.2. Проверка состояния системы</h2></div></div></div><p>
При описании процесса обновления в этой главе предполагается, что
производится обновление с <span class="quote">«<span class="quote">чистого</span>»</span> wheezy без
установленных пакетов сторонних производителей. Для большей надёжности перед
обновлением лучше удалить сторонние пакеты из системы.
</p><p>
Непосредственные обновления с выпусков Debian старее 7
(wheezy) не поддерживаются. Сначала выполните инструкции,
описанные в <a class="ulink" href="http://www.debian.org/releases/wheezy/releasenotes" target="_top">информации
о выпуске для Debian 7</a>, чтобы выполнить обновление до
7.
</p><p>
Эта процедура также предполагает, что ваша система обновлена до последнего
выпуска wheezy. Если это не так или вы в этом не уверены, следуйте
инструкциям из <a class="xref" href="ap-old-stuff.ru.html#old-upgrade" title="A.1. Обновление системы wheezy">Раздел A.1, «Обновление системы wheezy»</a>.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="review-actions"></a>4.2.1. Просмотр отложенных действий менеджера пакетов</h3></div></div></div><p>
Иногда, использование <span class="command"><strong>apt-get</strong></span> для установки пакетов
вместо <span class="command"><strong>aptitude</strong></span>, может привести к тому, что
<span class="command"><strong>aptitude</strong></span> посчитает некоторые пакеты
<span class="quote">«<span class="quote">неиспользуемыми</span>»</span> и запланирует их удаление. В общем, перед
переходом на следующий выпуск система должна быть полностью обновлена и
считаться <span class="quote">«<span class="quote">чистой</span>»</span>.
</p><p>
Поэтому проверьте, нет ли каких-нибудь отложенных действий в менеджере
пакетов <span class="command"><strong>aptitude</strong></span>. Если для пакета запланировано удаление
или обновление в менеджере пакетов, это может отрицательно сказаться на
процедуре обновления. Заметим, что исправление возможно, пока в вашем
<code class="filename">sources.list</code> указан
<span class="emphasis"><em>wheezy</em></span>, а не <span class="emphasis"><em>stable</em></span> или
<span class="emphasis"><em>jessie</em></span>; см. <a class="xref" href="ap-old-stuff.ru.html#old-sources" title="A.2. Проверка списка источников APT">Раздел A.2, «Проверка списка источников APT»</a>.
</p><p>
Для выполнения этой проверки запустите <span class="command"><strong>aptitude</strong></span> в
<span class="quote">«<span class="quote">интерактивном режиме</span>»</span> и нажмите <span class="keycap"><strong>g</strong></span>
(<span class="quote">«<span class="quote">Начали</span>»</span>). Если после этого будет предложено что-то сделать,
вам нужно просмотреть, что именно и, или отменить эти действия, или
подтвердить их выполнение. Если никаких действий совершить не предлагается,
то будет показано сообщение <span class="quote">«<span class="quote">Ни одного пакета не будет установлено,
обновлено или удалено</span>»</span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="disable-apt-pinning"></a>4.2.2. Отключение фиксации в APT</h3></div></div></div><p>
Если вы настроили APT на установку некоторых пакетов из дистрибутива,
отличного от стабильного (например, тестируемого), вам, возможно, придётся
изменить настройки фиксации в APT (хранятся в файле
<code class="filename">/etc/apt/preferences</code> и каталоге
<code class="filename">/etc/apt/preferences.d/</code>), чтобы стало возможным
обновление пакетов до версии нового стабильного выпуска. Более подробную
информацию о фиксации пакетов в APT можно найти в <span class="citerefentry"><span class="refentrytitle">apt_preferences</span>(5)</span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="package-status"></a>4.2.3. Проверка состояния пакетов</h3></div></div></div><p>
Независимо от способа обновления, рекомендуется сначала проверить состояние
всех пакетов и убедиться, что всем пакетам разрешено обновляться. Следующая
команда покажет пакеты установленные частично (Half-Installed), настройка
которых не удалась (Failed-Config), а также все пакеты в ошибочных
состояниях:
</p><pre class="screen">
# dpkg --audit
</pre><p>
Можно также проверить состояние всех пакетов системы с помощью программы
<span class="command"><strong>aptitude</strong></span> и таких команд, как
</p><pre class="screen">
# dpkg -l | pager
</pre><p>
или
</p><pre class="screen">
# dpkg --get-selections "*" &gt; ~/curr-pkgs.txt
</pre><p>
Перед обновлением желательно снять все фиксации с пакетов. Если один из
значимых для обновления пакетов зафиксирован, обновление завершится
неудачно.
</p><p>
Заметим, что <span class="command"><strong>aptitude</strong></span> использует отличный от
<span class="command"><strong>apt-get</strong></span> и <span class="command"><strong>dselect</strong></span> метод регистрации
зафиксированных пакетов. Определить, какие пакеты зафиксированы через
<span class="command"><strong>aptitude</strong></span>, можно с помощью
</p><pre class="screen">
# aptitude search "~ahold" 
</pre><p>
Если вы хотите проверить, какие пакеты зафиксированы через
<span class="command"><strong>apt-get</strong></span>, используйте
</p><pre class="screen">
# dpkg --get-selections | grep 'hold$'
</pre><p>
Если вы изменяли и перекомпилировали какой-то из пакетов локально, но при
этом не переименовали его и не добавили <span class="quote">«<span class="quote">эпоху</span>»</span> к версии
пакета, то его нужно зафиксировать, чтобы предотвратить обновление.
</p><p>
Состояние фиксации (<span class="quote">«<span class="quote">hold</span>»</span>) пакета через
<span class="command"><strong>apt-get</strong></span> может быть изменено с помощью:
</p><pre class="screen">
# echo <em class="replaceable"><code>имя_пакета</code></em> hold | dpkg --set-selections
</pre><p>
Замените <code class="literal">hold</code> на <code class="literal">install</code>, чтобы
отменить фиксацию.
</p><p>
Если вам нужно что-то исправить, то лучше сначала убедиться, что ваш
<code class="filename">sources.list</code> всё ещё указывает на wheezy, как
объясняется в <a class="xref" href="ap-old-stuff.ru.html#old-sources" title="A.2. Проверка списка источников APT">Раздел A.2, «Проверка списка источников APT»</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="proposed-updates"></a>4.2.4. Секция proposed-updates</h3></div></div></div><p>
    Если вы добавляли секцию <code class="literal">proposed-updates</code> в файл
<code class="filename">/etc/apt/sources.list</code>, то вам нужно удалить её перед
тем как начать обновление системы. Эта предосторожность уменьшит вероятность
конфликтов.
  </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="unofficial-sources"></a>4.2.5. Неофициальные источники</h3></div></div></div><p>
Если вы устанавливали некоторые пакеты не из репозиториев Debian, то знайте,
что при обновлении они могут быть удалены по причине конфликтующих
зависимостей. Если для установки дополнительных пакетов вы добавляли записи
в файл <code class="filename">/etc/apt/sources.list</code>, проверьте, содержит ли
этот архив также пакеты для jessie и, соответственно, исправьте
строку источника вместе со строками остальных источников пакетов Debian.
</p><p>
У некоторых пользователей могут быть установлены
<span class="emphasis"><em>неофициальные</em></span> перенесённые <span class="quote">«<span class="quote">более новые</span>»</span>
версии пакетов, собранные для wheezy. Такие пакеты, скорее всего,
станут причиной проблем при обновлении, так как они могут вызвать конфликты
файлов<a href="#ftn.idp62279184" class="footnote" id="idp62279184"><sup class="footnote">[4]</sup></a>. В <a class="xref" href="ch-upgrading.ru.html#trouble" title="4.5. Возможные проблемы во время обновления">Раздел 4.5, «Возможные проблемы во время обновления»</a>
содержится некоторая информация о том, что делать, если возникли файловые
конфликты.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgrade-process"></a>4.3. Подготовка источников APT</h2></div></div></div><p>
Перед началом процесса обновления вы должны настроить файл конфигурации
<code class="systemitem">apt</code><a id="idp62284048" class="indexterm"></a>,
<code class="filename">/etc/apt/sources.list</code>.
</p><p>
Пакет <code class="systemitem">apt</code><a id="idp62286768" class="indexterm"></a> при запросе на установку
выберет самую последнюю версию пакета из тех, которые можно найти в
источниках, указанных в строках <span class="quote">«<span class="quote"><code class="literal">deb</code></span>»</span> этого
файла. При равных версиях приоритет будет иметь строка, находящаяся в файле
раньше (таким образом, в случае использования нескольких зеркал, обычно
лучше первым указать каталог на локальном жёстком диске, затем
<acronym title="доступный только для чтения компакт-диск">CD-ROM</acronym> и, наконец, зеркала HTTP/FTP).
</p><p>
На выпуск Debian часто ссылаются по его кодовому имени (например,
<code class="literal">wheezy</code>, <code class="literal">jessie</code>) или
по его статусу (например, <code class="literal">oldstable</code> (старый стабильный),
<code class="literal">stable</code> (стабильный), <code class="literal">testing</code>
(тестируемый), <code class="literal">unstable</code> (нестабильный)). Ссылки на выпуск
по кодовому имени имеют то преимущество, что вы никогда неожиданно для себя
не начнёте пользоваться новым выпуском. Поэтому мы здесь так и делаем. В
этом случае вам, конечно, придётся самим следить за анонсами новых
выпусков. Если вы будете ссылаться на дистрибутив по его статусному имени,
то после выхода нового выпуска вы просто увидите большое количество
обновлённых пакетов.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="network"></a>4.3.1. Добавление интернет-источников в APT</h3></div></div></div><p>
Настройка по умолчанию позволяет произвести установку с главных
Интернет-серверов Debian, но вы можете изменить файл
<code class="filename">/etc/apt/sources.list</code> и использовать другие
серверы-зеркала. Лучше использовать ближайший к вам сервер-зеркало.
</p><p>
Адреса HTTP- и FTP-зеркал Debian можно найти по адресу <a class="ulink" href="https://www.debian.org/distrib/ftplist" target="_top">https://www.debian.org/distrib/ftplist</a> (см. раздел <span class="quote">«<span class="quote">Список зеркал
Debian</span>»</span>). HTTP-зеркала обычно быстрее, чем FTP.
</p><p>
Предположим, что ближайшим к вам зеркалом Debian является
<code class="literal">http://mirrors.kernel.org</code>. Просматривая содержимое зеркала
веб-браузером или FTP-клиентом, можно заметить, что основные каталоги
организованы следующим образом:
</p><pre class="programlisting">
http://mirrors.kernel.org/debian/dists/jessie/main/binary-<span class="phrase">amd64</span>/...
http://mirrors.kernel.org/debian/dists/jessie/contrib/binary-<span class="phrase">amd64</span>/...
</pre><p>
Чтобы использовать это зеркало в <code class="systemitem">apt</code><a id="idp62306672" class="indexterm"></a>, добавьте в файл
<code class="filename">sources.list</code>:
</p><pre class="programlisting">deb http://mirrors.kernel.org/debian jessie main contrib</pre><p>
Заметим, что <span class="quote">«<span class="quote"><code class="literal">dists</code></span>»</span> добавляется
автоматически, а параметры после имени выпуска используются для дополнения
сетевого пути до реальных каталогов.
</p><p>
После того, как вы добавили новый источник, отключите присутствовавшие ранее
в файле <code class="filename">sources.list</code> строки
<span class="quote">«<span class="quote"><code class="literal">deb</code></span>»</span>, поставив в начале каждой строки
символ решётки (<code class="literal">#</code>).
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="localmirror"></a>4.3.2. Добавление локального зеркала в качестве источника APT</h3></div></div></div><p>
Вместо HTTP- и FTP-зеркал можно использовать зеркало на локальном диске,
изменив соответствующим образом файл
<code class="filename">/etc/apt/sources.list</code> (диск может быть смонтирован с
помощью <acronym title="сетевая файловая система">NFS</acronym>).
</p><p>
Например, если ваше зеркало пакетов находится в каталоге
<code class="filename">/var/ftp/debian/</code>, то его основные каталоги будут
называться:
</p><pre class="programlisting">
/var/ftp/debian/dists/jessie/main/binary-<span class="phrase">amd64</span>/...
/var/ftp/debian/dists/jessie/contrib/binary-<span class="phrase">amd64</span>/...
</pre><p>
Чтобы пакет <code class="systemitem">apt</code><a id="idp62321904" class="indexterm"></a> мог использовать
этот источник пакетов, добавьте в файл <code class="filename">sources.list</code>:
</p><pre class="programlisting">deb file:/var/ftp/debian jessie main contrib</pre><p>
Заметим, что <span class="quote">«<span class="quote"><code class="literal">dists</code></span>»</span> добавляется
автоматически, а параметры после имени выпуска используются для дополнения
сетевого пути до реальных каталогов.
</p><p>
После того, как вы добавили новый источник, отключите присутствовавшие ранее
в файле <code class="filename">sources.list</code> строки
<span class="quote">«<span class="quote"><code class="literal">deb</code></span>»</span>, поставив в начале каждой строки
символ решётки (<code class="literal">#</code>).
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cdroms"></a>4.3.3. Добавление оптического носителя в качестве источника APT</h3></div></div></div><p>
Если вы хотите использовать <span class="emphasis"><em>только</em></span> компакт-диски (или
DVD или Blu-ray), закомментируйте все присутствующие в файле
<code class="filename">/etc/apt/sources.list</code> строки
<span class="quote">«<span class="quote"><code class="literal">deb</code></span>»</span>, поставив в начале каждой строки
символ решётки (<code class="literal">#</code>).
</p><p>
Убедитесь в том, что в файле <code class="filename">/etc/fstab</code> есть строка,
позволяющая смонтировать компакт-диск в каталог
<code class="filename">/media/cdrom</code>. Например, если файлом устройства вашего
привода чтения компакт-дисков служит <code class="filename">/dev/sr0</code>, то файл
<code class="filename">/etc/fstab</code> должен содержать строку:
</p><pre class="programlisting">
/dev/sr0 /media/cdrom auto noauto,ro 0 0
</pre><p>
Обратите внимание на то, что между словами <code class="literal">noauto,ro</code> в
четвёртом поле строки <span class="emphasis"><em>не должно быть пробелов</em></span>.
</p><p>
Чтобы проверить, что строка fstab написана верно, вставьте компакт-диск в
привод и выполните команды
</p><pre class="screen">
# mount /media/cdrom    # эта команда примонтирует CD к точке монтирования
# ls -alF /media/cdrom  # эта команда должна показать корневой каталог CD-диска
# umount /media/cdrom   # эта команда размонтирует CD
</pre><p>
Затем выполните команду
</p><pre class="screen">
# apt-cdrom add
</pre><p>
для каждого компакт-диска Debian Binary, чтобы добавить все диски в базу
данных APT.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgradingpackages"></a>4.4. Обновление пакетов</h2></div></div></div><p>
Для обновления Debian до нового выпуска рекомендуется использовать
программу управления пакетами <span class="command"><strong>apt-get</strong></span>. В предыдущих
выпусках для этой цели рекомендовалось использовать
<span class="command"><strong>aptitude</strong></span>, но новые версии <span class="command"><strong>apt-get</strong></span>
предоставляют такие же возможности, а также чаще выдают желаемый результат
при обновлении.
</p><p>
Не забудьте смонтировать все необходимые разделы (в первую очередь, корневой
раздел и каталог <code class="filename">/usr</code>) на чтение и запись. Это можно
сделать командой
</p><pre class="screen">
# mount -o remount,rw /<em class="replaceable"><code>точка_монтирования</code></em>
</pre><p>
Затем надо проверить и перепроверить, что источники APT (в
<code class="filename">/etc/apt/sources.list</code>) ссылаются, либо на
<code class="literal">jessie</code>, либо на <code class="literal">stable</code>. Не
должно быть источников, указывающих на wheezy.
</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Примечание]" src="images/note.png" /></td><th align="left">Примечание</th></tr><tr><td align="left" valign="top"><p>
    Строки источников для CD-ROM часто ссылаются на
<span class="quote">«<span class="quote"><code class="literal">unstable</code></span>»</span>, хоть это может показаться
странным, но исправлять их <span class="emphasis"><em>не нужно</em></span>.
  </p></td></tr></table></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="record-session"></a>4.4.1. Запись сеанса</h3></div></div></div><p>
Для записи ваших действий при обновлении настоятельно рекомендуем
использовать программу <span class="command"><strong>/usr/bin/script</strong></span>. В этом случае,
при возникновении каких-либо проблем у вас будет журнал произошедших
событий, и если понадобится, вы сможете включить эту информацию в отчёт об
ошибке. Чтобы начать запись, выполните команду:
</p><pre class="screen">
# script -t 2&gt;~/upgrade-jessie<em class="replaceable"><code>step</code></em>.time -a ~/upgrade-jessie<em class="replaceable"><code>step</code></em>.script
</pre><p>
или похожую. При перезапуске записи (например, при перезагрузке систему)
используйте другое значение вместо <em class="replaceable"><code>step</code></em>, чтобы
различать протоколируемые шаги. Не размещайте файл с записью во временных
каталогах, таких как <code class="filename">/tmp</code> и
<code class="filename">/var/tmp</code> (файлы в этих каталогах могут быть удалены при
обновлении или перезагрузке).
</p><p>
Запись также поможет вам прочитать информацию, которая вышла за пределы
экрана. Если вы находитесь перед монитором компьютера просто переключитесь
на вторую консоль VT2 (нажав <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F2</strong></span>) и, войдя
в систему, запустите <code class="literal">less -R
~root/upgrade-jessie.script</code> для просмотра файла.
</p><p>
После завершения обновления можно остановить <span class="command"><strong>script</strong></span>,
набрав <code class="literal">exit</code> в командной строке.
</p><p>
Если параметром к <span class="command"><strong>script</strong></span> указать <span class="emphasis"><em>-t</em></span>,
то вы сможете воспользоваться программой <span class="command"><strong>scriptreplay</strong></span> для
повтора всего сеанса:
</p><pre class="screen">
# scriptreplay ~/upgrade-jessie.time ~/upgrade-jessie.script
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="updating-lists"></a>4.4.2. Обновление списка пакетов</h3></div></div></div><p>
Во-первых, нужно обновить список доступных пакетов нового выпуска. Это
делается командой:
</p><pre class="screen">
# apt-get update
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sufficient-space"></a>4.4.3. Проверка доступного пространства для обновления</h3></div></div></div><p>
Перед обновлением всей системы, как описано в <a class="xref" href="ch-upgrading.ru.html#upgrading-full" title="4.4.5. Обновление системы">Раздел 4.4.5, «Обновление системы»</a>, убедитесь, что у вас достаточно места на
диске. Сначала все нужные для установки пакеты скачиваются из сети и
сохраняются в <code class="filename">/var/cache/apt/archives</code> (а на время
скачивания, в подкаталог <code class="filename">partial/</code>), поэтому вы должны
проверить место на разделе, который содержит <code class="filename">/var/</code>, так
как туда будут временно записаны загруженные пакеты для установки. После
загрузки вам, вероятно, понадобится дополнительное место в других разделах
файловой системы для установки обновляемых пакетов (скорее всего, они стали
больше) и новых пакетов, которые будут установлены из-за обновлений. Если в
системе не будет достаточного места, то в конечном счёте это приведёт к
неполному обновлению, что позднее бывает сложно исправить.
</p><p>
<span class="command"><strong>apt-get</strong></span> отображает подробную информацию о количестве
требуемого места для установки. Перед выполнением обновления вы можете
увидеть размер необходимого места, запустив:
</p><pre class="screen">
# apt-get -o APT::Get::Trivial-Only=true dist-upgrade
[ ... ]
XXX пакетов обновлено, XXX установлено новых, XXX пакетов отмечено для удаления и XXX пакетов не обновлено.
Необходимо получить xx.xMБ/yyyMБ архивов.
После распаковки будет использовано AAAMБ.
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Примечание]" src="images/note.png" /></td><th align="left">Примечание</th></tr><tr><td align="left" valign="top"><p>
Запуск этой команды в начале процесса обновления может приводить к ошибке по
причинам, описанным далее. В этом случае, запуск команды оценки дискового
пространства нужно провести после выполнения минимального обновления системы
(см. <a class="xref" href="ch-upgrading.ru.html#minimal-upgrade" title="4.4.4. Минимальное обновление системы">Раздел 4.4.4, «Минимальное обновление системы»</a>) и обновления ядра.
</p></td></tr></table></div><p>
Если вам не хватает места для обновления, <span class="command"><strong>apt-get</strong></span>
предупредит об этом:
</p><pre class="screen">
E: Недостаточно свободного места в /var/cache/apt/archives/.
</pre><p>В этом случае освободите место заранее. Вы можете:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
Удалить пакеты, которые были ранее скачаны для установки (из каталога
<code class="filename">/var/cache/apt/archives</code>). При очистке кэша пакетов с
помощью команды <span class="command"><strong>apt-get clean</strong></span> удаляются все ранее
скачанные файлы пакетов.
</p></li><li class="listitem"><p>
Удалить забытые пакеты. Если в wheezy вы использовали
<span class="command"><strong>aptitude</strong></span> или <span class="command"><strong>apt-get</strong></span> для установки
пакетов вручную, то этот факт был запомнен, и поэтому будут помечены как
устаревшие только те пакеты, которые были установлены только для
удовлетворения зависимостей и которые больше не нужны, если пакет, который
от них зависел, был удалён. Пакеты, установленные вручную, не будут помечены
как устаревшие. Для удаления автоматически установленных пакетов, которые
больше не используются, запустите:
</p><pre class="screen">
# apt-get autoremove
</pre><p>
Существуют и другие инструменты для определения неиспользуемых пакетов,
например, <span class="command"><strong>deborphan</strong></span>, <span class="command"><strong>debfoster</strong></span> и
<span class="command"><strong>cruft</strong></span>. Не удаляйте подряд все пакеты, найденные такими
инструментами (в особенности, если при запуске вы указали параметры,
отличные от умолчательных), чтобы не удалить что-нибудь нужное. Настоятельно
рекомендуем перед удалением внимательно просмотреть список предложенных
пакетов (прочесть описание, посмотреть входящие файлы и размер).
</p></li><li class="listitem"><p>
Удалить пакеты, которые занимают слишком много места и в данный момент не
нужны (вы всегда можете установить их снова после обновления). Если
установлен пакет <code class="systemitem">popularity-contest</code><a id="idp62405392" class="indexterm"></a>,
то вы можете использовать команду <span class="command"><strong>popcon-largest-unused</strong></span>
для получения списка неиспользуемых пакетов, но занимающих больше всего
места. Вы можете найти пакеты, которые занимают больше всего дискового
пространства с помощью <span class="command"><strong>dpigs</strong></span> (из пакета <code class="systemitem">debian-goodies</code><a id="idp62409264" class="indexterm"></a>) или <span class="command"><strong>wajig</strong></span>
(запустив <code class="literal">wajig size</code>). Также вы можете получить список
пакетов, которые занимают больше всего места, с помощью <code class="systemitem">aptitude</code><a id="idp62412736" class="indexterm"></a>. Запустите <span class="command"><strong>aptitude</strong></span>
в <span class="emphasis"><em>интерактивном режиме</em></span>, выберите
<span class="guimenu">Окна</span> → <span class="guimenuitem">Новый плоский список
пакетов</span>, нажмите <span class="keycap"><strong>l</strong></span> и введите
<code class="literal">~i</code>, нажмите <span class="keycap"><strong>S</strong></span> и введите
<code class="literal">~installsize</code>. После этого вы получите список для
изучения. 
</p></li><li class="listitem"><p>
  Удалить переводы и файлы локализации из системы, если они ненужны. Вы можете
установить и настроить пакет <code class="systemitem">localepurge</code><a id="idp62421616" class="indexterm"></a>, который поможет удалить
неиспользуемые системные локали. Это сократит использование дискового
пространства в <code class="filename">/usr/share/locale</code>.
</p></li><li class="listitem"><p>
   Временно перенести на другую машину или удалить системные журналы из
<code class="filename">/var/log/</code>.
</p></li><li class="listitem"><p>
    Использовать временный каталог <code class="filename">/var/cache/apt/archives</code>:
вы можете использовать временный каталог под кэш на другой файловой системе
(<acronym title="универсальная последовательная шина">USB</acronym>-носителе, временно подключённом жёстком диске, уже
используемой файловой системе, ...)
  </p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Примечание]" src="images/note.png" /></td><th align="left">Примечание</th></tr><tr><td align="left" valign="top"><p>
      Не используйте файловые системы <acronym title="сетевая файловая система">NFS</acronym>, так как при
обновлении могут возникнуть перебои в работе сети.
    </p></td></tr></table></div><p>
  Например, если у вас есть <acronym title="универсальная последовательная шина">USB</acronym>-диск, смонтированный в
<code class="filename">/media/usbkey</code>:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
	Удалите пакеты, которые были скачаны при установке ранее:

	</p><pre class="screen"># apt-get clean</pre><p>
      </p></li><li class="listitem"><p>
	Скопируйте каталог <code class="filename">/var/cache/apt/archives</code> на
<acronym title="универсальная последовательная шина">USB</acronym>-диск:

	</p><pre class="screen"># cp -ax /var/cache/apt/archives /media/usbkey/</pre><p>
      </p></li><li class="listitem"><p>
	Смонтируйте временный каталог кэша:

	</p><pre class="screen"># mount --bind /media/usbkey/archives /var/cache/apt/archives</pre><p>
      </p></li><li class="listitem"><p>
	После обновления восстановите оригинальный каталог
<code class="filename">/var/cache/apt/archives</code>:

	</p><pre class="screen"># umount /media/usbkey/archives</pre><p>
      </p></li><li class="listitem"><p>
	Удалите оставшийся <code class="filename">/media/usbkey/archives</code>.
      </p></li></ol></div><p>
  Можно создать временный каталог кэша в любой файловой системе, уже
смонтированной в системе.
  </p></li><li class="listitem"><p>
    Выполнить минимальное обновление системы (см. <a class="xref" href="ch-upgrading.ru.html#minimal-upgrade" title="4.4.4. Минимальное обновление системы">Раздел 4.4.4, «Минимальное обновление системы»</a>) или частичное обновление, а затем полное
обновление. После частичного обновления можно очистить кэш пакетов и
приступить к полному обновлению.
  </p></li></ul></div><p>
Заметим, что для безопасного удаления пакетов рекомендуется в
<code class="filename">sources.list</code> исправить источники обратно на
wheezy, как объясняется в <a class="xref" href="ap-old-stuff.ru.html#old-sources" title="A.2. Проверка списка источников APT">Раздел A.2, «Проверка списка источников APT»</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="minimal-upgrade"></a>4.4.4. Минимальное обновление системы</h3></div></div></div><p>
В некоторых случаях выполнение сразу полного обновления (как описано далее)
может привести к удалению большого числа пакетов, которые вы хотите
оставить. Поэтому мы рекомендуем производить обновление в две стадии —
сначала минимальное обновление, чтобы разобраться с конфликтами, а затем
полное обновление, как описано в <a class="xref" href="ch-upgrading.ru.html#upgrading-full" title="4.4.5. Обновление системы">Раздел 4.4.5, «Обновление системы»</a>. 
</p><p>
Для этого сначала выполните:
</p><pre class="screen">
# apt-get upgrade
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Примечание]" src="images/note.png" /></td><th align="left">Примечание</th></tr><tr><td align="left" valign="top"><p>
      В некоторых предыдущих выпусках для обновления рекомендовалось использовать
<span class="command"><strong>aptitude</strong></span>. Данный инструмент не рекомендуется для
обновления с wheezy до jessie.
    </p></td></tr></table></div><p>
Это приведёт к обновлению только тех пакетов, которые можно обновить без
необходимости удаления или установки других пакетов.
</p><p>
Минимальное обновление системы также может оказаться полезным, если в
системе мало свободного места и полное обновление запустить из-за этого
невозможно.
</p><p>
  Если установлен пакет <code class="systemitem">apt-listchanges</code><a id="idp62456400" class="indexterm"></a>, то он показывает важную
информацию об обновляемых пакетах в пейджере (при настройках по
умолчанию). Для выхода из пейджера и продолжения обновления нажмите
<span class="keycap"><strong>q</strong></span> после прочтения.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrading-full"></a>4.4.5. Обновление системы</h3></div></div></div><p>
После выполнения предыдущих шагов теперь можно приступить, собственно, к
обновлению. Выполните команду:
</p><pre class="screen">
# apt-get dist-upgrade
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Примечание]" src="images/note.png" /></td><th align="left">Примечание</th></tr><tr><td align="left" valign="top"><p>
      В некоторых предыдущих выпусках для обновления рекомендовалось использовать
<span class="command"><strong>aptitude</strong></span>. Данный инструмент не рекомендуется для
обновления с wheezy до jessie.
    </p></td></tr></table></div><p>
Эта команда произведёт полное обновление системы, установив последние
доступные версии всех пакетов и разрешив всех изменившиеся между выпусками
зависимости. При необходимости будут установлены новые пакеты (обычно, это
новые версии библиотек или переименованные пакеты) и удалены все вызывающие
конфликты устаревшие пакеты.
</p><p>
При обновлении с набора компакт-дисков система несколько раз попросит вас
вставить в привод соответствующий диск. Возможно, вам придётся вставлять
один и тот же диск несколько раз. Это вызвано тем, что взаимосвязанные
пакеты могут находиться на разных дисках.
</p><p>
Новые версии уже установленных пакетов, которые нельзя обновить не меняя
состояния других пакетов, не будут установлены (программа выведет сообщение,
что пакет зафиксирован, <span class="quote">«<span class="quote">held back</span>»</span>). Разрешить ситуацию можно,
либо отметив такой пакет как подлежащий установке с помощью
<span class="command"><strong>aptitude</strong></span>, либо выполнив команду <code class="literal">apt-get install
<em class="replaceable"><code>пакет</code></em></code>.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="trouble"></a>4.5. Возможные проблемы во время обновления</h2></div></div></div><p>
В следующем разделе описаны известные проблемы, которые могут возникнуть при
обновлении до jessie.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="immediate-configure"></a>4.5.1. Dist-upgrade завершается с ошибкой «Could not perform immediate
configuration»</h3></div></div></div><p>
В некоторых случаях команда <span class="command"><strong>apt-get dist-upgrade</strong></span> может
завершиться с ошибкой после скачивания пакетов:
</p><pre class="screen">
E: Could not perform immediate configuration on '<em class="replaceable"><code>пакет</code></em>'.  Please see man 5 apt.conf under APT::Immediate-Configure for details.
</pre><p>
</p><p>
Если это произошло, запустите <span class="command"><strong>apt-get dist-upgrade -o
APT::Immediate-Configure=0</strong></span> для продолжения обновления.
</p><p>
Другое возможное решение этой проблемы: временно добавьте источники, и для
wheezy, и для jessie в <code class="filename">sources.list</code> и
выполнение <span class="command"><strong>apt-get update</strong></span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="expected-removals"></a>4.5.2. Ожидаемые удаления</h3></div></div></div><p>
В процессе обновления до jessie может потребоваться удалить пакеты в
системе. Точный список пакетов будет зависеть от набора установленных в
системе пакетов. В данном документе даны общие советы об удалении, но если у
вас имеются сомнения, то перед тем как продолжить, рекомендуется проверить
все пакеты, которые предлагаются к удалению. Дополнительную информацию об
устаревших пакетах в jessie см. в <a class="xref" href="ch-upgrading.ru.html#obsolete" title="4.10. Устаревшие пакеты">Раздел 4.10, «Устаревшие пакеты»</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="conflicts-loops"></a>4.5.3. Конфликты или зацикливание в требованиях предварительной установки</h3></div></div></div><p>
Иногда необходимо активизировать параметр
<code class="literal">APT::Force-LoopBreak</code> в APT для временного удаления
пакетов первой необходимости, если возникает циклическая зависимость при
конфликте/требовании предварительной установки. Программа
<span class="command"><strong>apt-get</strong></span> сообщит об этом и прекратит обновление. Чтобы
решить эту проблему, следует указать в командной строке
<span class="command"><strong>apt-get</strong></span> параметр <code class="literal">-o
APT::Force-LoopBreak=1</code>.
</p><p>
Возможна ситуация, когда структура зависимостей в системе может быть
настолько нарушена, что потребуется ручное вмешательство. Обычно это
делается с помощью <span class="command"><strong>apt-get</strong></span> или
</p><pre class="screen">
# dpkg --remove <em class="replaceable"><code>имя_пакета</code></em>
</pre><p>
чтобы удалить <span class="quote">«<span class="quote">проблемные</span>»</span> пакеты или
</p><pre class="screen">
# apt-get -f install
# dpkg --configure --pending
</pre><p>
В чрезвычайных случаях вам может потребоваться принудительная переустановка
командой типа
</p><pre class="screen">
# dpkg --install <em class="replaceable"><code>/путь/к/имя_пакета.deb</code></em>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="file-conflicts"></a>4.5.4. Файловые конфликты</h3></div></div></div><p>
При обновлении с <span class="quote">«<span class="quote">чистого</span>»</span> wheezy конфликтов файлов
быть не должно, но они вполне возможны, если у вас установлены неофициальные
адаптации (backports). При конфликте файлов появляются ошибки:
</p><pre class="screen">
Unpacking <em class="replaceable"><code>&lt;package-foo&gt;</code></em> (from <em class="replaceable"><code>&lt;package-foo-file&gt;</code></em>) ...
dpkg: error processing <em class="replaceable"><code>&lt;package-foo&gt;</code></em> (--install):
 trying to overwrite `<em class="replaceable"><code>&lt;some-file-name&gt;</code></em>',
 which is also in package <em class="replaceable"><code>&lt;package-bar&gt;</code></em>
dpkg-deb: subprocess paste killed by signal (Broken pipe)
 Errors were encountered while processing:
 <em class="replaceable"><code>&lt;package-foo&gt;</code></em>
</pre><p>
Конфликт файлов можно попытаться разрешить принудительным удалением пакета,
указанного в <span class="emphasis"><em>последней</em></span> строке сообщения об ошибке:
</p><pre class="screen">
# dpkg -r --force-depends <em class="replaceable"><code>имя_пакета</code></em>
</pre><p>
После исправления ошибок вы можете продолжить обновление, повторив ранее
описанные команды <span class="command"><strong>apt-get</strong></span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-changes"></a>4.5.5. Изменение настроек</h3></div></div></div><p>
Во время обновления система будет задавать вопросы о настройке или
перенастройке некоторых пакетов. Если вас спросят, нужно ли заменить
какой-то файл в каталоге <code class="filename">/etc/init.d</code> или
<code class="filename">/etc/manpath.config</code>, версией, предоставленной
сопровождающим пакета, обычно следует ответить <span class="quote">«<span class="quote">да</span>»</span>, поскольку
иначе будет нарушена целостность системы. Вы всегда сможете вернуть старые
настройки, потому что предыдущие файлы настройки будут сохранены с
расширением <code class="literal">.dpkg-old</code>.
</p><p>
Если вы не знаете, что делать, запишите имя пакета или файла и разберитесь с
проблемой позднее. Информацию, выводившуюся на экран во время обновления, вы
сможете найти в файле записи программы script.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="console-change"></a>4.5.6. Изменение консоли сеанса</h3></div></div></div><p>
Если вы выполняете обновление через локальную системную консоль, то можете
обнаружить, что в некоторые моменты во время обновления консоль
переключается на другую и вы потеряли визуальный контроль над процессом
обновления. Например, это случится на настольных системах при перезапуске
менеджера экрана.
</p><p>
Чтобы восстановить консоль, на которой запущено обновление, нажмите
<span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F1</strong></span>
для перехода обратно на виртуальный терминал 1 (если вы видите графический
экран входа в систему) или используйте <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F1</strong></span> (если вы
видите локальную консоль в текстовом режиме). Вместо F1 нажмите
функциональную клавишу с номером виртуального терминала, в котором запущено
обновление. Также вы можете использовать <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>стрелка влево</strong></span>
или <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>стрелка
вправо</strong></span> для переключения между терминалами в текстовом
режиме.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="package-specific-issues"></a>4.5.7. Повышенное внимание для определённых пакетов</h3></div></div></div><p>
В большинстве случаев пакеты wheezy должны обновляться до
jessie без проблем. Есть несколько случаев когда может потребоваться
дополнительное действие, или до, или во время обновления; они будут описаны
далее по каждому пакету отдельно.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="issues-systemd"></a>4.5.7.1. systemd</h4></div></div></div><p>
    Обновление Debian с wheezy до jessie по умолчанию изменит
вашу систему инициализации с SysV на systemd. В зависимости от вашей системы
и её настройки вам может потребоваться внести некоторые изменения
вручную. Имеется подробный список известных проблем в <a class="xref" href="ch-information.ru.html#systemd-upgrade-default-init-system" title="5.6. Обновление приводит к установке новой системы инициализации по умолчанию для Jessie">Раздел 5.6, «Обновление приводит к установке новой системы инициализации по умолчанию для
Jessie»</a>.
  </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="issues-lxc"></a>4.5.7.2. LXC</h4></div></div></div><p>
    Если у вас установлен LXC, может потребоваться особое внимание при
обновлении вашей системы и ваших контейнеров. Ознакомьтесь с известными
проблемами и их решениями в <a class="xref" href="ch-information.ru.html#lxc-upgrade-issues" title="5.8. Обновление узлов и контейнеров LXC">Раздел 5.8, «Обновление узлов и контейнеров LXC»</a>.
  </p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="newkernel"></a>4.6. Обновление ядра и сопутствующих пакетов</h2></div></div></div><p>
В этом разделе описано как обновить ядро и указаны потенциальные проблемы,
связанные с этим. Вы можете установить один из пакетов <code class="systemitem">linux-image-*</code><a id="idp62532544" class="indexterm"></a>, предоставленных Debian, или
скомпилировать ядро из исходного кода самостоятельно.
</p><p>
Заметим, что большая часть информации раздела основана на предположении, что
вы будете использовать одно из модульных ядер Debian вместе с <code class="systemitem">initramfs-tools</code><a id="idp62535424" class="indexterm"></a> и <code class="systemitem">udev</code><a id="idp62537120" class="indexterm"></a>. Если вы будете использовать своё
собственное ядро, которому не требуется initrd, или вы используете другой
генератор initrd, то некоторая информация может быть для вас несущественна.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="kernel-metapackage"></a>4.6.1. Установка метапакета ядра</h3></div></div></div><p>
При выполнении dist-upgrade с wheezy до jessie настоятельно
рекомендуется установить метапакет linux-image-* (если вы не сделали этого
ранее). Этот метапакет будет автоматически загружать более новую версию ядра
во время установки обновления. Вы можете проверить, установлен у вас этот
метапакет или нет, с помощью следующей команды:
</p><pre class="screen">
# dpkg -l "linux-image*" | grep ^ii | grep -i meta
</pre><p>
Если в результате вы ничего не увидели, то вам нужно установить новый пакет
linux-image вручную, либо установить метапакет linux-image. Чтобы увидеть
список доступных метапакетов linux-image, выполните:
</p><pre class="screen">
# apt-cache search linux-image- | grep -i meta | grep -v transition
</pre><p>
Если вы не знаете какой пакет выбрать, запустите <code class="literal">uname -r</code>
и поищите пакет с похожим именем. Например, если вы увидели
<code class="literal">2.6.32-5-amd64</code>, то рекомендуется установить <code class="systemitem">linux-image-amd64</code><a id="idp62546176" class="indexterm"></a>. Для выбора подходящего из
предоставляемых пакетов, вы можете также воспользоваться командой
<span class="command"><strong>apt-cache</strong></span>, чтобы посмотреть подробное описание каждого
пакета. Например:
</p><pre class="screen">
# apt-cache show linux-image-amd64
</pre><p>
Затем вам следует использовать команду <code class="literal">apt-get install</code>
для его установки. Когда новое ядро будет установлено, вам следует
перезагрузиться, чтобы получить все преимущества нового ядра. Тем не менее,
ознакомьтесь с <a class="xref" href="ch-upgrading.ru.html#nownownow" title="4.7. Перед перезагрузкой">Раздел 4.7, «Перед перезагрузкой»</a> до выполнения первой
перезагрузки после обновления.
</p><p>
Для любящих приключения в Debian есть лёгкий способ собрать ядро
самостоятельно. Установите пакет <code class="systemitem">linux-source</code><a id="idp62553168" class="indexterm"></a>. Для сборки двоичного пакета можно
использовать цель <code class="literal">deb-pkg</code> из makefile. Дополнительную
информацию можно найти в <a class="ulink" href="http://kernel-handbook.alioth.debian.org/" target="_top">Debian Linux Kernel
Handbook</a> из пакета <code class="systemitem">debian-kernel-handbook</code><a id="idp62556704" class="indexterm"></a>.
</p><p>
Если возможно, предпочтительней обновлять ядро отдельно от основной операции
<code class="literal">dist-upgrade</code>, чтобы уменьшить шансы получить временно
незагружаемую систему. Заметим, что это нужно выполнять только после
процесса минимального обновления, описанного в <a class="xref" href="ch-upgrading.ru.html#minimal-upgrade" title="4.4.4. Минимальное обновление системы">Раздел 4.4.4, «Минимальное обновление системы»</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="initramfs-tools-issues"></a>4.6.2. Изменения в монтировании и проверке корневой файловой системы и файловой
системы <code class="filename">/usr</code></h3></div></div></div><p>
    Пакет <code class="systemitem">initramfs-tools</code><a id="idp62563072" class="indexterm"></a> теперь
запускает <code class="literal">fsck</code> для корневой файловой системы до её
монтирования. Если в качестве системы инициализации выбран
<code class="literal">systemd</code> и имеется отдельная файловая система
<code class="filename">/usr</code>, она также будет проверена с помощью fsck и
примонтирована.
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
	Если <code class="filename">/usr</code> является отдельной файловой системой на
RAID-устройстве, а опция <code class="literal">INITRDSTART</code> в
<code class="filename">/etc/default/mdadm</code> имеет значение, отличное от
'<code class="literal">all</code>', вам нужно будет изменить её так, чтобы данное
устройство было в ней указано.
      </p></li><li class="listitem"><p>
	Если <code class="filename">/usr</code> является отдельной файловой системой на
логическом томе LVM, а строка для <code class="filename">/usr</code> в
<code class="filename">/etc/fstab</code> содержит указание на устройство через
<code class="literal">UUID</code> или <code class="literal">LABEL</code>, вам следует изменить
эту строку так, чтобы ваше устройство было указано в виде
<code class="filename">/dev/mapper/<em class="replaceable"><code>VG</code></em>-<em class="replaceable"><code>LV</code></em></code>
или
<code class="filename">/dev/<em class="replaceable"><code>VG</code></em>/<em class="replaceable"><code>LV</code></em></code>.
      </p></li><li class="listitem"><p>
	Более невозможно смонировать файловую систему <code class="filename">/usr</code> с
созданием синонима.
      </p></li><li class="listitem"><p>
	Если RTC (часы реального времени) установлены на локальное время, а
локальное время перед UTC, <code class="literal">e2fsck</code> выведет предупреждение
во время загрузки об изменении времени назад (<a class="ulink" href="https://bugs.debian.org/767040" target="_top">bug #767040</a>). Вы можете
отключить это, поместив следующие строки в
<code class="filename">/etc/e2fsck.conf</code>:
      </p><pre class="screen">
[options]
broken_system_clock=1
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="nownownow"></a>4.7. Перед перезагрузкой</h2></div></div></div><p>
Когда команда <code class="literal">apt-get dist-upgrade</code> закончила работу,
<span class="quote">«<span class="quote">формально</span>»</span> обновление завершено, но <span class="emphasis"><em>перед</em></span>
перезагрузкой следует проделать ещё несколько действий.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
      При обновлении с Wheezy до Jessie лучше вычистить старые
пакеты <span class="emphasis"><em>before</em></span> до первой перезагрузки. В частности,
устаревшие сценарии инициализации могут приводить к возникновению
ошибок. Подробности о том, как находить и вычищать удалённые пакеты, см. в
<a class="xref" href="ch-upgrading.ru.html#purge-removed-packages" title="4.8.1. Вычистка удалённых пакетов">Раздел 4.8.1, «Вычистка удалённых пакетов»</a>.
    </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="for-next"></a>4.8. Подготовка к следующему выпуску</h2></div></div></div><p>
Для подготовки к следующему выпуску после обновления можно сделать несколько
вещей.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
Удалите устаревшие и неиспользуемые пакеты, как это описано в <a class="xref" href="ch-upgrading.ru.html#sufficient-space" title="4.4.3. Проверка доступного пространства для обновления">Раздел 4.4.3, «Проверка доступного пространства для обновления»</a>  и <a class="xref" href="ch-upgrading.ru.html#obsolete" title="4.10. Устаревшие пакеты">Раздел 4.10, «Устаревшие пакеты»</a>. Проверьте, какие
файлы настроек они использовали и подумайте над вычисткой пакетов вместе с
их файлами настройки. Также см. <a class="xref" href="ch-upgrading.ru.html#purge-removed-packages" title="4.8.1. Вычистка удалённых пакетов">Раздел 4.8.1, «Вычистка удалённых пакетов»</a>.
</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="purge-removed-packages"></a>4.8.1. Вычистка удалённых пакетов</h3></div></div></div><p>
    Как правило, рекомендуется вычистить удалённые пакеты. Это особенно
справедливо в случае, если они были удалены при обновлении более раннего
выпуска (напр., при обновлении до wheezy), или если они были
предоставлены третьими лицами. В частности, старые сценарии init.d могут
вызывать проблемы.
  </p><div class="caution"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Внимание]" src="images/caution.png" /></td><th align="left">Внимание</th></tr><tr><td align="left" valign="top"><p>
      Вычищение пакетов, как правило, приводит также и к вычищению файлов
журналов, возможно вам потребуется сделать их резервные копии.
    </p></td></tr></table></div><p>
    Следующие команды отображают список всех удалённых пакетов, чьи файлы
настройки всё ещё остаются в системе (если таковые имеются):
  </p><pre class="screen">
# dpkg -l | awk '/^rc/ { print $2 }'
</pre><p>
    Эти пакеты могут быть удалены с помощью команды <span class="command"><strong>apt-get
purge</strong></span>. Допустим, вы хотите вычистить все эти пакеты за один раз,
для этого можно использовать следующую команду:
  </p><pre class="screen">
# apt-get purge $(dpkg -l | awk '/^rc/ { print $2 }')
</pre><p>
    Если вы используете <code class="systemitem">aptitude</code><a id="idp62605984" class="indexterm"></a>, вы
можете использовать следующие альтернативы приведённым выше командам:
  </p><pre class="screen">
$ aptitude search '~c'
$ aptitude purge '~c'
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deprecated"></a>4.9. Исключённые компоненты</h2></div></div></div><p>
Начиная со следующего выпуска Debian 9 (stretch),
некоторые возможности будут исключены. Пользователям потребуется перейти на
их альтернативы, чтобы избежать проблем при обновлении до 9.
</p><p>
Это относится к следующим возможностям:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Пакет <code class="systemitem">hardening-wrapper</code><a id="idp62612384" class="indexterm"></a> устарел и
будет удалён в Stretch.
		</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="obsolete"></a>4.10. Устаревшие пакеты</h2></div></div></div><p>
Вместе с появлением множества новых пакетов, довольно много пакетов, которые
входили в wheezy, были удалены. Устаревшие пакеты не будут больше
обновляться. Ничто не мешает вам продолжать пользоваться устаревшими
пакетами, но приблизительно через год после выхода jessie проект
Debian обычно прекращает выпускать для них исправления
безопаности<a href="#ftn.idp62616336" class="footnote" id="idp62616336"><sup class="footnote">[5]</sup></a>, и оказывать другую
своевременную поддержку. Рекомендуется заменить их на доступные
альтернативные пакеты (если таковые имеются).
</p><p>
Пакет может быть удалён из дистрибутива по многим причинам: разработка
программы прекращена, пакет неинтересен никому из разработчиков Debian,
программа вытеснена другой, более функциональной программой или версией
программы, пакет содержит ошибки, из-за которых пока не может быть включён в
jessie. В последнем случае пакет может быть доступен в
<span class="quote">«<span class="quote">нестабильной</span>»</span> ветви дистрибутива.
</p><p>
Определить <span class="quote">«<span class="quote">устаревшие</span>»</span> пакеты в обновлённой системе очень
легко, так как их отмечают программы управления пакетами. Если вы
используете <span class="command"><strong>aptitude</strong></span>, то полный список этих пакетов
находится в разделе <span class="quote">«<span class="quote">Устаревшие и локально созданные пакеты</span>»</span>.
</p><p>
В <a class="ulink" href="https://bugs.debian.org/" target="_top">системе отслеживания ошибок Debian</a> зачастую
содержится дополнительная информация о причинах удаления пакета. Просмотрите
архив сообщений об ошибках интересующего вас пакета, а также архивированные
ошибки на <a class="ulink" href="https://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=ftp.debian.org&amp;archive=yes" target="_top">псевдо-пакет
ftp.debian.org</a>.
</p><p>
  Список устаревших пакетов:
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
	Наследником пакета <code class="systemitem">postgresql-9.1</code><a id="idp62627536" class="indexterm"></a>
является пакет <code class="systemitem">postgresql-9.4</code><a id="idp62629280" class="indexterm"></a>.
После завершения обновления операционной системы, вам следует запланировать
обновление кластеров базы данных PostgreSQL 9.1 до новой версии PostgreSQL
9.4, обновление выполняется с помощью инструмента
<span class="command"><strong>pg_upgradecluster</strong></span>.  Пользователям процедурного языка
PL/perl выпуск jessie предоставляет обновлённый пакет <code class="systemitem">postgresql-plperl-9.1</code><a id="idp62632576" class="indexterm"></a>, связанный с версией
libperl из jessie, это сделано для того, чтобы можно было выполнить
обновление до новой версии perl, доступной в jessie, но сохранить старые
функции базы данных PL/perl до момента обновления самой базы данных.
      </p></li><li class="listitem"><p>
        
        
Наследником пакета <code class="systemitem">python3.2</code><a id="idp62635760" class="indexterm"></a>
является <code class="systemitem">python3.4</code><a id="idp62637472" class="indexterm"></a>. Версия 2.7
поддерживается и в wheezy, и в jessie.
      </p></li><li class="listitem"><p>
        Наследником пакетов <code class="systemitem">ruby1.8</code><a id="idp62640192" class="indexterm"></a> и
<code class="systemitem">ruby1.9.1</code><a id="idp62641888" class="indexterm"></a>; является <code class="systemitem">ruby2.1</code><a id="idp62643600" class="indexterm"></a>.  Установите пакет <code class="systemitem">ruby</code><a id="idp62645344" class="indexterm"></a> для автоматического отслеживания текущей
версии ruby.
      </p></li><li class="listitem"><p>
        Альтернативами пакета <code class="systemitem">mplayer</code><a id="idp62648112" class="indexterm"></a>;
являются пакеты <code class="systemitem">mplayer2</code><a id="idp62649856" class="indexterm"></a> и
<code class="systemitem">mpv</code><a id="idp62651520" class="indexterm"></a> (новый пакет в jessie).
Хотя первый пакет по большей части совместим в mplayer в плане аргументов
командной строки и настроек (а также добавляет несколько новых
возможностей), последний добавляет гораздо больше новых возможностей и
улучшений, а также активно сопровождается основной веткой разработки.
      </p></li><li class="listitem"><p>
        Вместо пакета <code class="systemitem">openoffice.org</code><a id="idp62654624" class="indexterm"></a>;
предлагается использовать <code class="systemitem">libreoffice</code><a id="idp62656416" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        Наследником пакета <code class="systemitem">squid</code><a id="idp62658992" class="indexterm"></a> является
<code class="systemitem">squid3</code><a id="idp62660704" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        Наследником пакета <code class="systemitem">libjpeg-progs</code><a id="idp62663280" class="indexterm"></a>
является <code class="systemitem">libjpeg-turbo-progs</code><a id="idp62664992" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        Наследником пакета <code class="systemitem">openjdk-6-*</code><a id="idp62667568" class="indexterm"></a>
является <code class="systemitem">openjdk-7-*</code><a id="idp62669280" class="indexterm"></a>.
      </p></li></ul></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="dummy"></a>4.10.1. Пакеты-пустышки</h3></div></div></div><p>
Некоторые пакеты из wheezy в jessie были разделены на
несколько пакетов, чаще всего, для облегчения сопровождения системы. Для
простоты обновления в состав jessie нередко входит
<span class="quote">«<span class="quote">пакет-пустышка</span>»</span> (пустой пакет с именем старого пакета из
wheezy). При установке такого пакета устанавливаются новые пакеты
по зависимостям. Сразу же после установки, <span class="quote">«<span class="quote">пустышки</span>»</span>
становятся неиспользуемыми и их можно спокойно удалять.
</p><p>
В описании большинства (но не всех) пакетов-пустышек ясно указано их
предназначение. К сожалению, никаких правил для описания пустышек нет,
поэтому для их обнаружения вам может пригодиться
<span class="command"><strong>deborphan</strong></span> с параметром
<code class="literal">--guess-<em class="replaceable"><code>*</code></em></code>. Некоторые пустышки
удалять после обновления не нужно, так как они впоследствии используются для
определения установленной версии программы.
</p></div></div><div class="footnotes"><br /><hr width="100" align="left" /><div id="ftn.idp62166944" class="footnote"><p><a href="#idp62166944" class="para"><sup class="para">[1] </sup></a>Если приоритет debconf установлен в самый высокий уровень, то ответов на
вопросы о настройке можно избежать, но возможна ситуация, при которой ответы
по умолчанию могут оказаться некорректны в вашей системе и службы могут не
запуститься.</p></div><div id="ftn.idp62169232" class="footnote"><p><a href="#idp62169232" class="para"><sup class="para">[2] </sup></a>Например: службы DNS или DHCP, а именно, когда не предусмотрены резервные
серверы. В отсутствии DHCP пользователи могут быть отключены от сети, если
время аренды меньше чем время, затрачиваемое на обновление.</p></div><div id="ftn.idp62187168" class="footnote"><p><a href="#idp62187168" class="para"><sup class="para">[3] </sup></a> Эту возможность можно выключить, добавив параметр <code class="literal">panic=0</code>
в параметры загрузки.  </p></div><div id="ftn.idp62279184" class="footnote"><p><a href="#idp62279184" class="para"><sup class="para">[4] </sup></a> Обычно, система управления пакетами Debian не позволяет пакету удалить или
заменить файл, принадлежащий другому пакету, за исключением случаев, когда
явно указано, что один пакет заменяет другой.  </p></div><div id="ftn.idp62616336" class="footnote"><p><a href="#idp62616336" class="para"><sup class="para">[5] </sup></a> Или при появлении нового выпуска Debian. Обычно поддержку получают
одновременно не более двух стабильных выпусков.  </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch-installing.ru.html"><img src="images/prev.png" alt="Пред." /></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch-information.ru.html"><img src="images/next.png" alt="След." /></a></td></tr><tr><td width="40%" align="left" valign="top">Глава 3. Система установки </td><td width="20%" align="center"><a accesskey="h" href="index.ru.html"><img src="images/home.png" alt="Начало" /></a></td><td width="40%" align="right" valign="top"> Глава 5. Что нужно знать о jessie</td></tr></table></div></body></html>