<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Capítulo 4. Actualizações a partir de Debian 7 (wheezy)</title><link rel="stylesheet" type="text/css" href="debian.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.pt.html" title="Notas de Lançamento para Debian 8 (jessie), 64-bit PC" /><link rel="up" href="index.pt.html" title="Notas de Lançamento para Debian 8 (jessie), 64-bit PC" /><link rel="prev" href="ch-installing.pt.html" title="Capítulo 3. Sistema de Instalação" /><link rel="next" href="ch-information.pt.html" title="Capítulo 5. Problemas a estar atento na jessie" /><meta xmlns="" name="viewport" content="width=device-width, initial-scale=1" /><style xmlns="" type="text/css">
      body {
        background-repeat: no-repeat;
        background-image: none;
      }
    </style></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Capítulo 4. Actualizações a partir de Debian 7 (wheezy)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch-installing.pt.html"><img src="images/prev.png" alt="Anterior" /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch-information.pt.html"><img src="images/next.png" alt="Próximo" /></a></td></tr></table><hr /></div><div xml:lang="pt" class="chapter" lang="pt"><div class="titlepage"><div><div><h1 class="title"><a id="ch-upgrading"></a>Capítulo 4. Actualizações a partir de Debian 7 (wheezy)</h1></div></div></div><div class="toc"><p><strong>Índice</strong></p><dl class="toc"><dt><span class="section"><a href="ch-upgrading.pt.html#backup">4.1. Preparar para a actualização</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt.html#data-backup">4.1.1. Salvaguardar quaisquer dados ou informação de configuração</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#inform-users">4.1.2. Informar os utilizadores com antecedência</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#services-downtime">4.1.3. Preparar para desligar temporariamente os serviços</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#recovery">4.1.4. Preparar para recuperação</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#upgrade-preparations">4.1.5. Preparar um ambiente seguro para a actualização</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt.html#system-status">4.2. Verificar o estado do sistema</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt.html#review-actions">4.2.1. Rever as acções pendentes no gestor de pacotes</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#disable-apt-pinning">4.2.2. Desactivar o APT pinning</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#package-status">4.2.3. Verificar o estado dos pacotes</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#proposed-updates">4.2.4. Secção de actualizações propostas (proposed-updates)</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#unofficial-sources">4.2.5. Fontes não oficiais</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt.html#upgrade-process">4.3. Preparar as fontes para o APT</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt.html#network">4.3.1. Acrescentar fontes APT da Internet</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#localmirror">4.3.2. Acrescentar fontes APT para um 'mirror' local</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#cdroms">4.3.3. Acrescentar fontes APT a partir de meios ópticos</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt.html#upgradingpackages">4.4. Actualizar pacotes</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt.html#record-session">4.4.1. Gravar a sessão</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#updating-lists">4.4.2. Actualizar a lista de pacotes</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#sufficient-space">4.4.3. Certificar-se que possui espaço suficiente para a actualização</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#minimal-upgrade">4.4.4. Actualização mínima do sistema</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#upgrading-full">4.4.5. Actualizar o sistema</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt.html#trouble">4.5. Possíveis problemas durante a actualização</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt.html#immediate-configure">4.5.1. Dist-upgrade falha com <span class="quote">“<span class="quote">Não pode executar a configuração
imediata</span>”</span></a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#expected-removals">4.5.2. Remoções esperadas</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#conflicts-loops">4.5.3. Conflitos ou Ciclos de Pré-Dependências</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#file-conflicts">4.5.4. Conflitos de ficheiros</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#configuration-changes">4.5.5. Alterações de configuração</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#console-change">4.5.6. Mudança de sessão para consola</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#package-specific-issues">4.5.7. Cuidado especial para pacotes específicos</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt.html#newkernel">4.6. Actualizar o seu kernel e pacotes relacionados</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt.html#kernel-metapackage">4.6.1. Instalar um meta-pacote do kernel</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#initramfs-tools-issues">4.6.2. Alerações à montagem do sistema de ficheiros e verificação da raiz e
<code class="filename">/usr</code></a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt.html#nownownow">4.7. Coisas a fazer antes de reiniciar a máquina</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#for-next">4.8. Preparar para o próximo lançamento</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt.html#purge-removed-packages">4.8.1. Purgar pacotes removidos</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt.html#deprecated">4.9. Componentes descontinuados</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt.html#obsolete">4.10. Pacotes obsoletos</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt.html#dummy">4.10.1. Pacotes fictícios</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="backup"></a>4.1. Preparar para a actualização</h2></div></div></div><p>
Nós sugerimos que antes de actualizar que também leia a informação em <a class="xref" href="ch-information.pt.html" title="Capítulo 5. Problemas a estar atento na jessie">Capítulo 5, <em>Problemas a estar atento na jessie</em></a>. Esse capítulo cobre potenciais problemas não
directamente relacionados com o processo de actualização mas que podem no
entanto ser importantes conhecer antes de começar.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="data-backup"></a>4.1.1. Salvaguardar quaisquer dados ou informação de configuração</h3></div></div></div><p>
Antes de actualizar o seu sistema é fortemente recomendado que efectue uma
cópia de segurança total, ou que pelo menos salvaguarde quaisquer dados ou
informações de configuração a que não se pode dar ao luxo de perder. As
ferramentas de actualização e o processo são bastante fiáveis, mas uma falha
de hardware durante a actualização poderia resultar num sistema extremamente
danificado.
</p><p>
A principal informação que quererá salvaguardar é o conteúdo de
<code class="filename">/etc</code>, <code class="filename">/var/lib/dpkg</code>,
<code class="filename">/var/lib/apt/extended_states</code> e o resultado de
<code class="literal">dpkg --get-selections "*"</code> (as aspas são importantes). Se
você usa o <span class="command"><strong>aptitude</strong></span> para gerir os pacotes no seu sistema,
vai querer também salvaguardar
<code class="filename">/var/lib/aptitude/pkgstates</code>.
</p><p>
O processo de actualização em si não modifica nada no directório
<code class="filename">/home</code>.No entanto, algumas aplicações (e.g. partes do
conjunto Mozilla, e dos ambientes de desktop GNOME e KDE) são conhecidos por
sobrescreverem configurações existentes dos utilizadores por novos valores
predefinidos quando uma nova versão da aplicação é iniciada pela primeira
vez por um utilizador. Como precaução, você pode querer fazer uma cópia de
segurança dos ficheiros e directórios ocultos (<span class="quote">“<span class="quote">dotfiles</span>”</span>) nos
directórios dos utilizadores. Esta cópia de segurança pode ajudar a
restaurar ou recriar as antigas configurações. Pode também querer informar
os utilizadores acerca disto.
</p><p>
Qualquer operação de instalação de um pacote tem que ser corrida com
privilégios de super-utilizador, por isso ou inicie uma sessão como
<code class="literal">root</code> ou utilize <span class="command"><strong>su</strong></span> ou
<span class="command"><strong>sudo</strong></span> para obter os direitos de acesso necessários.
</p><p>
Esta actualização possui poucas condições prévias, deverá verificá-las antes
de iniciar a actualização.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="inform-users"></a>4.1.2. Informar os utilizadores com antecedência</h3></div></div></div><p>
É sensato informar todos os utilizadores com antecedência sobre qualquer
actualização que estiver a planear, apesar dos utilizadores que acedam ao
sistema através uma ligação <span class="command"><strong>ssh</strong></span> pouco devem notar durante
a actualização, e devem conseguir continuar a trabalhar. 
</p><p>
Se quiser tomar precauções extra, faça uma cópia de segurança ou desmonte a
partição <code class="filename">/home</code> antes de fazer a actualização.
</p><p>
Você terá de fazer uma actualização do kernel ao actualizar para
jessie, por isso será necessário reiniciar a máquina. Tipicamente,
isto será feito após terminar a actualização.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="services-downtime"></a>4.1.3. Preparar para desligar temporariamente os serviços</h3></div></div></div><p>
Podem existir serviços associados a pacotes que serão incluídos na
actualização. Se for este o caso, note que, durante a actualização, esses
serviços serão parados enquanto os pacotes a ser actualizados estão a ser
substituídos e configurados. Durante este tempo, estes serviços não estarão
disponíveis.
</p><p>
O tempo exacto que estes serviços estarão desligados irá variar dependendo
do número de pacotes a serem actualizados no sistema, e também inclui o
tempo que o administrador do sistema demora a responder às questões de
configuração das diferentes actualizações de pacotes. Note que se o processo
de actualização for deixado desacompanhado e o sistema solicitar alguma
entrada durante toda a actualização, existe uma grande possibilidade dos
serviços ficarem indisponíveis<a href="#ftn.idp65681808" class="footnote" id="idp65681808"><sup class="footnote">[1]</sup></a> durante
um período significativo de tempo.
</p><p>
Se o sistema a ser actualizado disponibilizar serviços críticos para os seus
utilizadores ou para a sua rede <a href="#ftn.idp65683536" class="footnote" id="idp65683536"><sup class="footnote">[2]</sup></a>, pode
reduzir o tempo de indisponibilidade se fizer uma actualização mínima ao
sistema, conforme descrito em <a class="xref" href="ch-upgrading.pt.html#minimal-upgrade" title="4.4.4. Actualização mínima do sistema">Secção 4.4.4, “Actualização mínima do sistema”</a>, seguida de
uma actualização ao kernel e de reiniciar. De seguida actualize os pacotes
associados aos seus serviços críticos. Actualize estes pacotes antes de
fazer a actualização completa descrita em <a class="xref" href="ch-upgrading.pt.html#upgrading-full" title="4.4.5. Actualizar o sistema">Secção 4.4.5, “Actualizar o sistema”</a>. Deste modo pode assegurar que estes serviços
críticos estão a funcionar e disponíveis durante todo o processo de
actualização e dessa forma o tempo de indisponibilidade é reduzido.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="recovery"></a>4.1.4. Preparar para recuperação</h3></div></div></div><p>
Embora Debian tente assegurar que o seu sistema se mantenha funcional em
todos os momentos, há sempre a hipótese que experimente problemas ao
reiniciar o seu sistema após uma grande actualização. Problemas potenciais
conhecidos estão documentados neste e nos próximos capítulos destas Notas de
Lançamento.
</p><p>
Por esta razão faz sentido assegurar que será capaz de recuperar o seu
sistema não conseguir reiniciar ou, para sistemas geridos remotamente, não
conseguir activar a rede.
</p><p>
Se estiver a actualizar remotamente através de uma ligação
<span class="command"><strong>ssh</strong></span> é recomendado que tome as precauções necessárias para
ser capaz de aceder ao servidor através de um terminal série remoto. Existe
uma hipótese de que, após a actualização do kernel e de reiniciar, você
tenha de corrigir a configuração do sistema através duma consola local. Além
disso, se o sistema for reiniciado acidentalmente a meio de uma actualização
existe a hipótese de que você necessite de fazer a recuperação utilizando
uma consola local.
</p><p>
Geralmente recomendamos a utilização do <span class="emphasis"><em>modo de
recuperação</em></span> do instalador Debian jessie. A vantagem de
utilizar o instalador é que pode escolher de entre os seus muitos métodos o
que melhor se adequa à sua situação. Para mais informação, por favor
consulte a secção <span class="quote">“<span class="quote">Recuperar um Sistema Estragado</span>”</span> no capítulo
8 do <a class="ulink" href="https://www.debian.org/releases/jessie/installmanual" target="_top">Guia de instalação</a> e a <a class="ulink" href="https://wiki.debian.org/DebianInstaller/FAQ" target="_top">FAQ do Instalador Debian</a>.
</p><p>
Se isso falhar, precisará de um modo alternativo de arrancar o seu sistema
para que possa aceder-lhe e repará-lo. Uma opção é utilizar uma imagem
especial de recuperação ou um live CD de Linux. Após arrancar com ele,
deverá ser capaz de montar o seu sistema de ficheiros raiz e
<code class="literal">chroot</code> nele para investigar e resolver o problema.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="recovery-initrd"></a>4.1.4.1. Shell de depuração durante o arranque utilizando o initrd</h4></div></div></div><p>
O pacote <code class="systemitem">initramfs-tools</code><a id="idp65698448" class="indexterm"></a> inclui uma
shell de depuração<a href="#ftn.idp65699296" class="footnote" id="idp65699296"><sup class="footnote">[3]</sup></a> nos initrds que
gera. Se, por exemplo, o initrd for incapaz de montar o sistema de ficheiros
raiz, você será deixado nesta shell de depuração que tem comandos básicos
para ajudar a descobrir e talvez resolver o problema.
</p><p>
Coisas básicas a verificar são: a presença dos ficheiros de dispositivo
correctos em <code class="filename">/dev</code>; que módulos estão carregados
(<code class="literal">cat /proc/modules</code>); mensagens do
<span class="command"><strong>dmesg</strong></span> que podem ter erros no carregamento de drivers. As
mensagens do <span class="command"><strong>dmesg </strong></span> também irão mostrar que ficheiros de
dispositivo estão associados a que discos; deve verificar isso com a
mensagem de <code class="literal">echo $ROOT</code> para se certificar que o sistema
de ficheiros raiz está no dispositivo esperado.
</p><p>
Se conseguir resolver o problema, escrever <code class="literal">exit</code> irá
terminar a shell de depuração e continuar o processo de arranque no ponto
onde falhou. Claro que também precisará de resolver o problema subjacente e
gerar de novo a initrd para que o próximo arranque não falhe de novo.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="recovery-shell-systemd"></a>4.1.4.2. Shell de depuração durante o arranque utilizando o systemd</h4></div></div></div><p>
    Se o arranque falhar sob systemd, é possível obter uma shell root de
depuração ao alterar a linha de comandos do kernel. Se o arranque básico
tiver sucesso, mas alguns serviços falhem o arranque, pode ser útil
adicionar <code class="literal">systemd.unit=rescue.target</code> aos parâmetros do
kernel.
  </p><p>
    Caso contrário, o parâmetro de kernel
<code class="literal">systemd.unit=emergency.target</code> irá disponibilizar-lhe uma
shell root no ponto mais cedo possível. No entanto, isto é feito antes de
montar o sistema de ficheiros raiz com permissões de leitura-escrita. Você
terá que fazê-lo manualmente com:
  </p><pre class="screen">
mount -o remount,rw /
</pre><p>
    Mais informações sobre depuração de um arranque problemático sob systemd
podem ser encontradas no artigo  <a class="ulink" href="http://freedesktop.org/wiki/Software/systemd/Debugging/" target="_top"> Diagnosticar
Problemas de Arranque</a>
  </p><p>
    Se tudo o resto falhar, você poderá ser capaz de arrancar via sistema antigo
sysvinit. Isto requer que o <code class="systemitem">sysvinit</code><a id="idp65715104" class="indexterm"></a>
esteja ainda instalado e que o binário
<code class="filename">/lib/sysvinit/init</code> esteja incluído na sua initramfs. Se
este requerimentos forem satisfeitos, adicione
<code class="literal">init=/lib/sysvinit/init</code> na linha de comandos do kernel e
ele irá arrancar com a biblioteca sysvinit.
  </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrade-preparations"></a>4.1.5. Preparar um ambiente seguro para a actualização</h3></div></div></div><p>
A actualização da distribuição deve ser efectuada localmente a partir de uma
consola virtual de texto (ou directamente ligada a um terminal série), ou
remotamente através de uma ligação <span class="command"><strong>ssh</strong></span>. 
</p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Importante]" src="images/important.png" /></td><th align="left">Importante</th></tr><tr><td align="left" valign="top"><p>
  Se você está a usar alguns serviços VPN (como o <code class="systemitem">tinc</code><a id="idp65722096" class="indexterm"></a>) eles podem não estar disponíveis durante o
processo de actualização. Por favor veja <a class="xref" href="ch-upgrading.pt.html#services-downtime" title="4.1.3. Preparar para desligar temporariamente os serviços">Secção 4.1.3, “Preparar para desligar temporariamente os serviços”</a>.
  </p></td></tr></table></div><p>
De modo a ganhar uma margem extra de segurança quando actualizar
remotamente, nós sugerimos que corra os processos de actualização na consola
virtual disponibilizada pelo programa <span class="command"><strong>screen</strong></span>, o qual
permite uma re-ligação segura e assegura que o processo de actualização não
é interrompido mesmo que o processo da ligação remota falhe.
</p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Importante]" src="images/important.png" /></td><th align="left">Importante</th></tr><tr><td align="left" valign="top"><p>
    Você <span class="emphasis"><em>não</em></span> deve actualizar usando
<span class="command"><strong>telnet</strong></span>, <span class="command"><strong>rlogin</strong></span>,
<span class="command"><strong>rsh</strong></span>, ou a partir de uma sessão do X gerida pelo
<span class="command"><strong>xdm</strong></span>, pelo <span class="command"><strong>gdm</strong></span> ou pelo
<span class="command"><strong>kdm</strong></span> etc. na máquina que estiver a actualizar. Isto porque
cada um desses serviços podem ser terminados durante esta actualização, o
que pode resultar num sistema <span class="emphasis"><em>inacessível</em></span> que ficou
apenas meio actualizado. O uso da aplicação do GNOME
<span class="command"><strong>update-manager</strong></span> é <span class="emphasis"><em>fortemente
desaconselhado</em></span> para as actualizações para novos lançamentos, pois
esta ferramenta necessita que a sessão de ambiente de trabalho permaneça
activa.
  </p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="system-status"></a>4.2. Verificar o estado do sistema</h2></div></div></div><p>
O processo de actualização descrito neste capítulo foi desenhado para
actualizações de sistemas wheezy  <span class="quote">“<span class="quote">puros</span>”</span> sem pacotes
de terceiros. Para uma maior fiabilidade do processo de actualização, pode
querer remover pacotes de terceiros do seu sistema antes de começar a
actualização.
</p><p>
As actualizações directas a partir de lançamentos Debian mais antigos que
7 (wheezy)  não são suportados. Por favor siga as
instruções nas <a class="ulink" href="https://www.debian.org/releases/wheezy/releasenotes" target="_top">Notas de
Lançamento para Debian 7</a> para primeiro actualizar para
7.
</p><p>
Este procedimento também assume que o seu sistema foi actualizado até ao
último ponto da versão wheezy. Se não tiver feito esta
actualização ou não tem a certeza, siga as instruções em <a class="xref" href="ap-old-stuff.pt.html#old-upgrade" title="A.1. Actualizar o seu sistema wheezy">Secção A.1, “Actualizar o seu sistema wheezy”</a>.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="review-actions"></a>4.2.1. Rever as acções pendentes no gestor de pacotes</h3></div></div></div><p>
Em alguns casos, a utilização do <span class="command"><strong>apt-get</strong></span> para instalar
pacotes em vez do <span class="command"><strong>aptitude</strong></span> pode fazer o
<span class="command"><strong>aptitude</strong></span> considerar um pacote como <span class="quote">“<span class="quote">não
utilizado</span>”</span> e marcá-lo para remoção. De um modo geral, você deve
assegurar-se que o sistema está totalmente actualizado e
<span class="quote">“<span class="quote">limpo</span>”</span> antes de proceder com a actualização.
</p><p>
Devido a disto você deve verificar novamente se existem acções pendentes no
gestor de pacotes <span class="command"><strong>aptitude</strong></span>. Se um pacote estiver marcado
para remoção ou para actualização no gestor de pacotes, poderá ter um
impacto negativo no procedimento de actualização. Note que para corrigir
isto apenas é possível se o seu <code class="filename">sources.list</code> ainda
apontar para <span class="emphasis"><em>wheezy</em></span>; e não para
<span class="emphasis"><em>stable</em></span> ou <span class="emphasis"><em>jessie</em></span>; veja
<a class="xref" href="ap-old-stuff.pt.html#old-sources" title="A.2. Verificar a sua lista de fontes">Secção A.2, “Verificar a sua lista de fontes”</a>.
</p><p>
Para fazer esta revisão, arranque o <span class="command"><strong>aptitude</strong></span> em
<span class="quote">“<span class="quote">modo visual</span>”</span> e carregue em <span class="keycap"><strong>g</strong></span>
(<span class="quote">“<span class="quote">Go</span>”</span>). Se mostrar quaisquer acções, você deve revê-las e, ou
corrigi-las ou implementar as acções sugeridas. Se não forem sugeridas
acções ser-lhe-á apresentada uma mensagem a dizer <span class="quote">“<span class="quote">Nenhum pacote está
marcado para ser instalado, removido ou actualizado</span>”</span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="disable-apt-pinning"></a>4.2.2. Desactivar o APT pinning</h3></div></div></div><p>
Se configurou o APT para instalar determinados pacotes a partir de uma
distribuição que não a stable (e,g,. a partir da testing), pode ter que
alterar a sua configuração de APT pinning (guardada em
<code class="filename">/etc/apt/preferences</code> e em
<code class="filename">/etc/apt/preferences.d/</code>) para permitir a actualização
de pacotes para versões existentes na nova versão estável. Mais informação
acerca do APT pinning pode ser encontrada em <span class="citerefentry"><span class="refentrytitle">apt_preferences</span>(5)</span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="package-status"></a>4.2.3. Verificar o estado dos pacotes</h3></div></div></div><p>
Independentemente do método utilizado para a actualização, é recomendado que
primeiro verifique o estado de todos os pacotes, e verificar que todos os
pacotes estão em modo de actualização. O seguinte comando listará todos os
pacotes que possuem o estado Metade-Instalado (Half-Installed) ou
Configuração-Falhada (Failed-Config), e aqueles que apresentem qualquer erro
no estado.
</p><pre class="screen">
# dpkg --audit
</pre><p>
Pode também inspeccionar o estado de todos os pacotes no seu sistema
utilizando o <span class="command"><strong>aptitude</strong></span> ou com comandos como
</p><pre class="screen">
# dpkg -l | pager
</pre><p>
ou
</p><pre class="screen">
# dpkg --get-selections "*" &gt; ~/curr-pkgs.txt
</pre><p>
É desejável que remova todos os bloqueios ('holds') antes da
actualização. Se algum pacote essencial à actualização estiver bloqueado, a
actualização irá falhar.
</p><p>
Note que o <span class="command"><strong>aptitude</strong></span> utiliza um método diferente para
registar os pacotes bloqueados que o <span class="command"><strong>apt-get</strong></span> e
<span class="command"><strong>dselect</strong></span>. Pode identificar pacotes bloqueados para o
<span class="command"><strong>aptitude</strong></span> com
</p><pre class="screen">
# aptitude search "~ahold" 
</pre><p>
Se quiser verificar que pacotes tem bloqueados para o
<span class="command"><strong>apt-get</strong></span> deverá utilizar
</p><pre class="screen">
# dpkg --get-selections | grep 'hold$'
</pre><p>
Se alterar e recompilar localmente um pacote e não o renomear ou colocar
numa versão modificada, terá que o bloquear para prevenir que o mesmo seja
alterado.
</p><p>
O estado <span class="quote">“<span class="quote">hold</span>”</span> do pacote para o <span class="command"><strong>apt-get</strong></span>
pode ser alterado utilizando:
</p><pre class="screen">
# echo <em class="replaceable"><code>nome_do_pacote</code></em> hold | dpkg --set-selections
</pre><p>
Substitua <code class="literal">hold</code> por <code class="literal">install</code> para
remover o estado <span class="quote">“<span class="quote">hold</span>”</span>.
</p><p>
Se existe alguma coisa que necessita de corrigir, o melhor é certificar-se
que o seu ficheiro <code class="filename">sources.list</code> continua a apontar para
a wheezy conforme é explicado em <a class="xref" href="ap-old-stuff.pt.html#old-sources" title="A.2. Verificar a sua lista de fontes">Secção A.2, “Verificar a sua lista de fontes”</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="proposed-updates"></a>4.2.4. Secção de actualizações propostas (proposed-updates)</h3></div></div></div><p>
    Se você listou a secção <code class="literal">proposed-updates</code> no seu ficheiro
<code class="filename">/etc/apt/sources.list</code>, deverá removê-la desse ficheiro
antes de tentar actualizar o seu sistema. Isto é uma precaução para reduzir
a probabilidade de conflitos.
  </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="unofficial-sources"></a>4.2.5. Fontes não oficiais</h3></div></div></div><p>
Se possuir pacotes que não sejam da Debian no seu sistema, deverá saber que
estes podem ser removidos durante a actualização, devido a conflitos entre
dependências. Se estes pacotes foram instalados adicionando um arquivo de
pacotes extra ao seu <code class="filename">/etc/apt/sources.list</code>, deverá
verificar se aquele arquivo também oferece pacotes compilados para a
jessie e altere a linha da fonte de acordo com o mesmo tipo de linhas
de fontes para os pacotes Debian.
</p><p>
Alguns utilizadores poderão ter versões <span class="quote">“<span class="quote">mais recentes</span>”</span> de
pacotes de backports <span class="emphasis"><em>não oficiais</em></span>, que
<span class="emphasis"><em>estejam</em></span> instalados no seu sistema Debian
wheezy. Tais pacotes irão provavelmente criar problemas durante a
actualização, pois destes poderão resultar em conflitos de
ficheiros<a href="#ftn.idp65785632" class="footnote" id="idp65785632"><sup class="footnote">[4]</sup></a>. <a class="xref" href="ch-upgrading.pt.html#trouble" title="4.5. Possíveis problemas durante a actualização">Secção 4.5, “Possíveis problemas durante a actualização”</a>
tem alguma informação sobre como lidar com conflitos de ficheiros à medida
que aparecem.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgrade-process"></a>4.3. Preparar as fontes para o APT</h2></div></div></div><p>
Antes de iniciar a actualização deverá configurar o ficheiro de configuração
do <code class="systemitem">apt</code><a id="idp65790016" class="indexterm"></a> para listas de pacotes, o
<code class="filename">/etc/apt/sources.list</code>.
</p><p>
O <code class="systemitem">apt</code><a id="idp65792736" class="indexterm"></a> irá considerar todos os
pacotes que podem ser encontrados através de qualquer linha
<span class="quote">“<span class="quote"><code class="literal">deb</code></span>”</span>, e instalará o pacote com o número de
versão mais elevado, dando prioridade às primeiras linhas no ficheiro (assim
onde tiver múltiplas localizações de 'mirrors', tipicamente deverá ter
primeiro um disco local, depois CD-ROMs e então 'mirrors' HTTP/FTP).
</p><p>
Um lançamento pode ser normalmente referido pelo seu nome de código (por
ex. <code class="literal">wheezy</code>;, <code class="literal">jessie</code>)
e pelo seu nome de estado (por ex. <code class="literal">oldstable</code>,
<code class="literal">stable</code>, <code class="literal">testing</code>,
<code class="literal">unstable</code>). Referir-se a um lançamento pelo seu nome de
código tem a vantagem que que nunca será surpreendido por um novo lançamento
e por esta razão é o método utilizado aqui. Significa com certeza que terá
de ser você mesmo a estar atento a anúncios de lançamento. Se pelo contrário
utilizar o nome de estado, irá ver carregamentos de actualizações para os
pacotes disponíveis assim que acontecer um lançamento.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="network"></a>4.3.1. Acrescentar fontes APT da Internet</h3></div></div></div><p>
A configuração predefinida é definida para instalação a partir de um
servidor principal de Debian na Internet, mas poderá desejar modificar o
<code class="filename">/etc/apt/sources.list</code> para utilizar outros 'mirrors',
de preferência um 'mirror' mais próximo de si em termos de rede.
</p><p>
Endereços de 'mirrors' Debian HTTP ou FTP podem ser encontrados em <a class="ulink" href="https://www.debian.org/distrib/ftplist" target="_top">https://www.debian.org/distrib/ftplist</a> (veja na secção <span class="quote">“<span class="quote">Lista de
'mirrors' Debian</span>”</span>). OS 'mirrors' HTTP geralmente são mais rápidos do
que os 'mirrors' FTP.
</p><p>
Por exemplo, suponha que o 'mirror' Debian mais perto de si é
<code class="literal">http://mirrors.kernel.org/</code>. Quando inspeccionar aquele
'mirror' com um navegador web ou um programa FTP, irá notar que os
directórios principais estão organizados desta forma:
</p><pre class="programlisting">
http://mirrors.kernel.org/debian/dists/jessie/main/binary-<span class="phrase">amd64</span>/...
http://mirrors.kernel.org/debian/dists/jessie/contrib/binary-<span class="phrase">amd64</span>/...
</pre><p>
Para utilizar este 'mirror' com o <code class="systemitem">apt</code><a id="idp65809824" class="indexterm"></a>, adicione esta linha ao seu ficheiro
<code class="filename">sources.list</code>:
</p><pre class="programlisting">deb http://mirrors.kernel.org/debian jessie main contrib</pre><p>
Note que <code class="literal">dists</code>' é acrescentado implicitamente, e que os
argumentos que se seguem ao nome do lançamento são utilizados para expandir
o caminho em múltiplos directórios.
</p><p>
Depois de adicionar as suas novas fontes, desactive as linhas
<span class="quote">“<span class="quote"><code class="literal">deb</code></span>”</span> previamente existentes em
<code class="filename">sources.list</code>, colocando um cardinal
(<code class="literal">#</code>) à frente das mesmas.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="localmirror"></a>4.3.2. Acrescentar fontes APT para um 'mirror' local</h3></div></div></div><p>
Em vez de utilizar os 'mirrors' de pacotes HTTP ou FTP, pode desejar
modificar o <code class="filename">/etc/apt/sources.list</code> de modo a utilizar um
'mirror' num disco local (possivelmente montado sobre
<acronym title="Sistema de Ficheiros de Rede">NFS</acronym>).
</p><p>
Por exemplo, o seu 'mirror' de pacotes poderá estar sob
<code class="filename">/var/ftp/debian/</code>, e pode ter directórios principais
como estes:
</p><pre class="programlisting">
/var/ftp/debian/dists/jessie/main/binary-<span class="phrase">amd64</span>/...
/var/ftp/debian/dists/jessie/contrib/binary-<span class="phrase">amd64</span>/...
</pre><p>
Para utilizar isto com o <code class="systemitem">apt</code><a id="idp65823824" class="indexterm"></a>,
acrescente esta linha ao seu ficheiro <code class="filename">sources.list</code>:
</p><pre class="programlisting">deb file:/var/ftp/debian jessie main contrib</pre><p>
Note que <code class="literal">dists</code>' é acrescentado implicitamente, e que os
argumentos que se seguem ao nome do lançamento são utilizados para expandir
o caminho em múltiplos directórios.
</p><p>
Depois de adicionar as suas novas fontes, desactive as linhas
<span class="quote">“<span class="quote"><code class="literal">deb</code></span>”</span> previamente existentes em
<code class="filename">sources.list</code>, colocando um cardinal
(<code class="literal">#</code>) à frente das mesmas.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cdroms"></a>4.3.3. Acrescentar fontes APT a partir de meios ópticos</h3></div></div></div><p>
Se quiser utilizar <span class="emphasis"><em>apenas</em></span> CDs (ou DVDs, ou discos
Blu-ray), comente as linhas <span class="quote">“<span class="quote"><code class="literal">deb</code></span>”</span>existentes
em <code class="filename">/etc/apt/sources.list</code> colocando um cardinal
(<code class="literal">#</code>) à frente das mesmas.
</p><p>
Certifique-se que existe uma linha no <code class="filename">/etc/fstab</code> que
permita a montagem do seu leitor de CD-ROM no ponto de montagem
<code class="filename">/media/cdrom</code>. Por exemplo, se o seu leitor de CD-ROM
for o dispositivo <code class="filename">/dev/sr0</code>, o
<code class="filename">/etc/fstab</code> deverá conter uma linha como:
</p><pre class="programlisting">
/dev/sr0 /media/cdrom auto noauto,ro 0 0
</pre><p>
Note que <span class="emphasis"><em>não podem existir espaços</em></span> que entre as
palavras <code class="literal">noauto,ro</code> encontradas no quarto campo.
</p><p>
Para verificar que tal funciona, insira um CD e tente correr
</p><pre class="screen">
# mount /media/cdrom    # isto irá montar o CD no ponto de montagem
# ls -alF /media/cdrom  # isto irá mostrar o directório raiz do CD
# umount /media/cdrom   # isto irá desmontar o CD
</pre><p>
A seguir, corra:
</p><pre class="screen">
# apt-cdrom add
</pre><p>
para cada CD-ROM de Binários Debian que possua, para adicionar informação de
cada CD à base de dados APT.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgradingpackages"></a>4.4. Actualizar pacotes</h2></div></div></div><p>
A forma recomendada para actualizar a partir de lançamentos anteriores
Debian é usar a ferramenta de gestão de pacotes
<span class="command"><strong>apt-get</strong></span>. Em lançamentos anteriores, o
<span class="command"><strong>aptitude</strong></span> era recomendado para este objectivo, mas as
versões recentes do <span class="command"><strong>apt-get</strong></span> disponibilizam
funcionalidades equivalentes e também têm mostrado serem mais consistentes a
dar os resultados de actualização desejados.
</p><p>
Não se esqueça de montar todas as partições necessárias (nomeadamente a
partição root e <code class="filename">/usr</code>) em modo de leitura-escrita, com
um comando como:
</p><pre class="screen">
# mount -o remount,rw /<em class="replaceable"><code>ponto_de_montagem</code></em>
</pre><p>
De seguida você deverá confirmar novamente que as entradas das fontes do APT
(em <code class="filename">/etc/apt/sources.list</code>), se referem a
<span class="quote">“<span class="quote"><code class="literal">jessie</code></span>”</span> ou a
<span class="quote">“<span class="quote"><code class="literal">stable</code></span>”</span>. Não deverão existir quaisquer
entradas de fontes que apontem para wheezy.
</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
    As linhas de fontes de um CD-ROM poderão por vezes referirem-se a
<span class="quote">“<span class="quote"><code class="literal">unstable</code></span>”</span>; e embora isto possa ser confuso,
você <span class="emphasis"><em>não</em></span> deverá alterá-las.
  </p></td></tr></table></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="record-session"></a>4.4.1. Gravar a sessão</h3></div></div></div><p>
É-lhe fortemente recomendado que utilize o programa
<span class="command"><strong>/usr/bin/script</strong></span> para gravar uma transcrição da sessão de
actualização. Assim caso ocorra qualquer problema, terá o relatório sobre o
que aconteceu, e se necessário poderá fornecer informação exacta sob a forma
de um relatório de erro. Para iniciar a gravação, escreva:
</p><pre class="screen">
# script -t 2&gt;~/upgrade-jessie<em class="replaceable"><code>step</code></em>.time -a ~/upgrade-jessie<em class="replaceable"><code>step</code></em>.script
</pre><p>
ou semelhante. Se tiver que re-executar o ficheiro transcrito (ex., se tiver
que reiniciar o sistema) use valores <em class="replaceable"><code>step</code></em>
diferentes para indicar qual passo da actualização está a registar. Não
coloque o ficheiro transcrito num directório temporário como
<code class="filename">/tmp</code> ou <code class="filename">/var/tmp</code> (os ficheiros
nesses directórios podem ser apagados durante a actualização ou durante
qualquer reinicio).
</p><p>
O transcrito permitir-lhe-á também rever informação que tenha sido deslocada
para fora do ecrã. Se está na consola do sistema, mude para VT2 (utilizando
<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F2</strong></span>)
e, depois de iniciar a sessão, utilize <code class="literal">less -R
~root/upgrade-jessie.script</code> para visualizar o ficheiro.
</p><p>
Depois de ter completado a actualização, pode parar o
<span class="command"><strong>script</strong></span> escrevendo <code class="literal">exit</code> na aviso de
comando.
</p><p>
Se você utilizou a opção <span class="emphasis"><em>-t</em></span> para o
<span class="command"><strong>script</strong></span> você pode utilizar o programa
<span class="command"><strong>scriptreplay</strong></span> para ver uma repetição de toda a sessão:
</p><pre class="screen">
# scriptreplay ~/upgrade-jessie.time ~/upgrade-jessie.script
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="updating-lists"></a>4.4.2. Actualizar a lista de pacotes</h3></div></div></div><p>
Primeiro precisa de ser obtida a lista de pacotes disponíveis para o novo
lançamento. Isto é feito executando:
</p><pre class="screen">
# apt-get update
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sufficient-space"></a>4.4.3. Certificar-se que possui espaço suficiente para a actualização</h3></div></div></div><p>
Você terá de se certificar antes de fazer a actualização do seu sistema, que
existe espaço suficiente em disco quando iniciar a actualização completa do
sistema descrita em <a class="xref" href="ch-upgrading.pt.html#upgrading-full" title="4.4.5. Actualizar o sistema">Secção 4.4.5, “Actualizar o sistema”</a>. Primeiro, qualquer
pacote necessário para a instalação que é obtido a partir da rede é guardado
em <code class="filename">/var/cache/apt/archives</code> (e no subdirectório
<code class="filename">partial/</code> durante o download), por isso você tem de se
assegurar que tem espaço suficiente no sistema de ficheiros da partição onde
está o <code class="filename">/var/</code> para descarregar temporariamente os
pacotes que serão instalados no seu sistema. Depois do download,
provavelmente irá necessitar de mais espaço nos sistemas de ficheiros das
outras partições de modo a instalar quer os pacotes actualizados (que podem
conter binários maiores ou mais dados) e os novos pacotes que serão obtidos
para a actualização. Se o seu sistema não possui espaço suficiente, você
poderá acabar com uma actualização incompleta que da qual pode ser difícil
recuperar.
</p><p>
O <span class="command"><strong>apt-get</strong></span> pode mostrar-lhe informação detalhada sobre o
espaço em disco necessário para a instalação. Antes de efectuar a
actualização do sistema, pode ver esta estimativa ao correr:
</p><pre class="screen">
# apt-get -o APT::Get::Trivial-Only=true dist-upgrade
[ ... ]
XXX actualizados, XXX novos instalados , XXX a remover e XXX não actualizados.
Necessário obter xx.xMB de arquivos. 
Após esta operação serão usados AAAMB de espaço de disco adicional.
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
Correr este comando no inicio do processo de actualização pode dar um erro,
pelas razões descritas nas secções seguintes. Nesse caso terá de aguardar
até ter feito a actualização mínima ao sistema como em <a class="xref" href="ch-upgrading.pt.html#minimal-upgrade" title="4.4.4. Actualização mínima do sistema">Secção 4.4.4, “Actualização mínima do sistema”</a> antes de correr este comando para estimar o
espaço em disco.
</p></td></tr></table></div><p>
Se não tiver espaço suficiente para a actualização, o
<span class="command"><strong>apt-get</strong></span> irá alertá-lo com uma mensagem como esta:
</p><pre class="screen">
E: Você não tem espaço livre suficiente em /var/cache/apt/archives/.
</pre><p>Nesta situação, certifique-se que liberta espaço antes de continuar. Você
pode:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
Remover pacotes que tenham sido previamente descarregados para instalação
(em <code class="filename">/var/cache/apt/archives</code>). Limpar a 'cache' de
pacotes ao correr <span class="command"><strong>apt-get clean</strong></span> irá remover todos os
ficheiros de pacotes anteriormente descarregados.
</p></li><li class="listitem"><p>
Remova os pacotes esquecidos. Se utilizou o <span class="command"><strong>aptitude</strong></span> ou o
<span class="command"><strong>apt-get</strong></span> para instalar manualmente pacotes na
wheezy, ele irá seguir esses pacotes que instalou manualmente e
será capaz de marcar como obsoletos os pacotes obtidos apenas por
dependências e que já não são necessários se o pacote foi removido. Não irá
marcar para remoção pacotes que você instalou manualmente. Para remover os
pacotes instalados automaticamente e que já não são utilizados, execute:
</p><pre class="screen">
# apt-get autoremove
</pre><p>
Para descobrir pacotes redundantes pode também utilizar o
<span class="command"><strong>deborphan</strong></span>, <span class="command"><strong>debfoster</strong></span> ou
<span class="command"><strong>cruft</strong></span>. Não remova cegamente os pacotes que estas
ferramentas apresentam, especialmente se estiver a utilizar opções
agressivas e não-predefinidas que são sujeitas a gerarem falsos positivos. É
altamente recomendado que reveja manualmente os pacotes sugeridos para
remoção (por ex. o seu conteúdo, dimensão e descrição) antes de os remover.
</p></li><li class="listitem"><p>
Remova os pacotes que ocupam demasiado espaço e não são actualmente
necessários (pode sempre reinstala-los depois da actualização). Se tiver
instalado o <code class="systemitem">popularity-contest</code><a id="idp65898768" class="indexterm"></a>, pode
utilizar o <span class="command"><strong>popcon-largest-unsed</strong></span> para listar os pacotes
que não utiliza e que ocupam mais espaço. Pode encontrar pacotes que tomam o
maior espaço com o <span class="command"><strong>dpigs</strong></span> (disponível no pacote
<code class="systemitem">debian-goodies</code><a id="idp65902160" class="indexterm"></a>) ou com o
<span class="command"><strong>wajig</strong></span> (correndo <code class="literal">wajig size</code>). Podem
também ser encontrados com a <code class="systemitem">aptitude</code><a id="idp65905360" class="indexterm"></a>. Inicie o <span class="command"><strong>aptitude</strong></span>
em <span class="quote">“<span class="quote">visual mode</span>”</span>, seleccione
<span class="guimenu">Vistas</span> → <span class="guimenuitem">Nova Lista Plana de
Pacotes</span>, pressione <span class="keycap"><strong>l</strong></span> e insira
<code class="literal">~i</code>, pressione <span class="keycap"><strong>S</strong></span> e insira
<code class="literal">~installsize</code>, então irá ter uma boa lista para trabalhar. 
</p></li><li class="listitem"><p>
  Remova ficheiros de localizações e traduções do seu sistema se não forem
necessárias. Você pode instalar o pacote <code class="systemitem">localepurge</code><a id="idp65913872" class="indexterm"></a> e configurá-lo para que apenas os
'locales' seleccionados são mantidos no sistema. Isto irá reduzir o espaço
de disco consumido em <code class="filename">/usr/share/locale</code>.
</p></li><li class="listitem"><p>
   Mova temporariamente para outro sistema, ou remova permanentemente, os
relatórios do sistema residentes em <code class="filename">/var/log/</code>.
</p></li><li class="listitem"><p>
    Use um <code class="filename">/var/cache/apt/archives</code> temporário: Você pode
usar um directório de cache temporário de outro sistema de ficheiros
(dispositivo de armazenamento <acronym title="Barramento Série Universal">USB</acronym>, disco rijo temporário,
sistema de ficheiros já em utilização, ...)
  </p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      Não use uma montagem <acronym title="Sistema de Ficheiros de Rede">NFS</acronym> porque a ligação de rede pode
ser interrompida durante a actualização.
    </p></td></tr></table></div><p>
  Por exemplo, se você tem um dispositivo <acronym title="Barramento Série Universal">USB</acronym> montado em
<code class="filename">/media/usbkey</code>:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
	remove os pacotes que foram descarregados préviamente para instalação:

	</p><pre class="screen"># apt-get clean</pre><p>
      </p></li><li class="listitem"><p>
	copia o directório <code class="filename">/var/cache/apt/archives</code> para o
dispositivo <acronym title="Barramento Série Universal">USB</acronym>:

	</p><pre class="screen"># cp -ax /var/cache/apt/archives /media/usbkey/</pre><p>
      </p></li><li class="listitem"><p>
	monta o directório de cache temporário no que está presente:

	</p><pre class="screen"># mount --bind /media/usbkey/archives /var/cache/apt/archives</pre><p>
      </p></li><li class="listitem"><p>
	após a actualização, restaura o directório
<code class="filename">/var/cache/apt/archives</code> original:

	</p><pre class="screen"># umount /media/usbkey/archives</pre><p>
      </p></li><li class="listitem"><p>
	remove o restante <code class="filename">/media/usbkey/archives</code>.
      </p></li></ol></div><p>
  Você pode criar o directório de cache temporário em qualquer sistema de
ficheiros que esteja montado no seu sistema.
  </p></li><li class="listitem"><p>
    Faça uma actualização mínima do sistema (veja <a class="xref" href="ch-upgrading.pt.html#minimal-upgrade" title="4.4.4. Actualização mínima do sistema">Secção 4.4.4, “Actualização mínima do sistema”</a>)  ou actualizações parciais do sistema seguido
de uma actualização completa. Isto irá tornar possível actualizar o sistema
parcialmente, e permitir-lhe limpar a cache de pacotes antes da actualização
completa.
  </p></li></ul></div><p>
Note que, de modo para remover pacotes em segurança, é aconselhável mudar o
seu <code class="filename">sources.list</code> de novo para wheezy conforme
é explicado em <a class="xref" href="ap-old-stuff.pt.html#old-sources" title="A.2. Verificar a sua lista de fontes">Secção A.2, “Verificar a sua lista de fontes”</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="minimal-upgrade"></a>4.4.4. Actualização mínima do sistema</h3></div></div></div><p>
Em alguns casos, fazer a actualização completa (conforme descrito abaixo)
directamente pode remover grandes quantidades de pacotes que poderá querer
manter. Portanto recomendamos um processo de actualização em duas partes:
primeiro uma actualização mínima para ultrapassar estes conflitos, e depois
uma actualização completa conforme descrito em <a class="xref" href="ch-upgrading.pt.html#upgrading-full" title="4.4.5. Actualizar o sistema">Secção 4.4.5, “Actualizar o sistema”</a>. 
</p><p>
Para fazer isto, primeiro correr:
</p><pre class="screen">
# apt-get upgrade
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      O processo de actualização para alguns lançamentos anteriores recomendava o
uso do <span class="command"><strong>aptitude</strong></span> para a actualização. Esta ferramenta não
é recomendada para actualizações de wheezy para jessie.
    </p></td></tr></table></div><p>
Isto tem o efeito de actualizar os pacotes que podem ser actualizados sem
que nenhum outro pacote seja removido ou instalado.
</p><p>
A actualização mínima ao sistema também pode ser útil quando o sistema tem
pouco espaço disponível e não se pode executar uma actualização completa
devido a restrições de espaço.
</p><p>
  Se o pacote <code class="systemitem">apt-listchanges</code><a id="idp65946480" class="indexterm"></a> estiver
instalado, irá mostrar (na sua configuração predefinida), num pager, a
informação importante sobre os pacote actualizados.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrading-full"></a>4.4.5. Actualizar o sistema</h3></div></div></div><p>
Após ter executado os passos anteriores, você está agora pronto para
continuar com a parte principal da actualização. Execute:
</p><pre class="screen">
# apt-get dist-upgrade
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      O processo de actualização para alguns lançamentos anteriores recomendava o
uso do <span class="command"><strong>aptitude</strong></span> para a actualização. Esta ferramenta não
é recomendada para actualizações de wheezy para jessie.
    </p></td></tr></table></div><p>
Isto irá executar uma actualização completa do sistema, instalando as
versões disponíveis mais recentes de todos os pacotes, e resolvendo todas as
possíveis alterações de dependências entre pacotes em diferentes
lançamentos. Se necessário, irá instalar alguns pacotes novos (normalmente
novas versões de bibliotecas, ou pacotes renomeados), e remover quaisquer
pacotes em conflito e obsoletos.
</p><p>
Quando a actualização for feita a partir de um conjunto de CD-ROMs (ou
DVDs), ser-lhe-á pedido que insira CDs específicos em determinados pontos
durante a actualização. Pode ter que inserir o mesmo CD múltiplas vezes,
isto devido a pacotes inter-relacionados que foram espalhados pelos CDs.
</p><p>
As novas versões dos pacotes actualmente instalados que não possam ser
actualizadas sem alterar o estado de instalação de outro pacote serão
deixadas na sua versão actual (mostradas como <span class="quote">“<span class="quote">held
back</span>”</span>). Isto pode ser resolvido ou utilizando o
<span class="command"><strong>aptitude</strong></span> de modo a escolher estes pacotes para instalação
ou tentando <code class="literal">apt-get install
<em class="replaceable"><code>pacote</code></em></code>.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="trouble"></a>4.5. Possíveis problemas durante a actualização</h2></div></div></div><p>
As seguinte secções descrevem problemas conhecidos que podem aparecer
durante uma actualização para jessie.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="immediate-configure"></a>4.5.1. Dist-upgrade falha com <span class="quote">“<span class="quote">Não pode executar a configuração
imediata</span>”</span></h3></div></div></div><p>
Nalguns casos a etapa <span class="command"><strong>apt-get dist-upgrade</strong></span> pode falhar
após fazer o download dos pacotes com:
</p><pre class="screen">
E: Não pode executar a configuração imediata em '<em class="replaceable"><code>pacote</code></em>'. Para detalhes por favor veja man 5 apt.conf em APT::Immediate-Configure.
</pre><p>
</p><p>
Se isso acontecer, se em vez disso correr <span class="command"><strong>apt-get dist-upgrade -o
APT::Immediate-Configure=0</strong></span> deverá permitir que a actualização
aconteça.
</p><p>
Outra forma possível de contornar este problema é temporariamente
acrescentar ambas as fontes de wheezy e de jessie ao seu
<code class="filename">sources.list</code> e correr <span class="command"><strong>apt-get
update</strong></span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="expected-removals"></a>4.5.2. Remoções esperadas</h3></div></div></div><p>
O processo de actualização para jessie pode pedir a remoção de
pacotes no sistema. A lista exacta de pacotes irá variar dependendo do
conjunto de pacotes que está instalado. Estas notas de lançamento dão
conselhos gerais acerca destas remoções, mas em caso de dúvida, é
recomendado que examine as propostas de remoção de pacotes de cada método
antes de prosseguir. Para mais informações acerca de pacotes tornados
obsoletos em jessie, veja <a class="xref" href="ch-upgrading.pt.html#obsolete" title="4.10. Pacotes obsoletos">Secção 4.10, “Pacotes obsoletos”</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="conflicts-loops"></a>4.5.3. Conflitos ou Ciclos de Pré-Dependências</h3></div></div></div><p>
Por vezes é necessário activar a opção
<code class="literal">APT::Force-LoopBreak</code> no APT para ser possível remover
temporariamente um pacote essencial devido a um ciclo vicioso de
Conflitos/Pré-Dependências. O <span class="command"><strong>apt-get</strong></span> irá alertá-lo disto
e abortará a actualização. Você pode contornar isto especificando a opção
<code class="literal">-o APT::Force-LoopBreak=1</code> na linha de comandos do
<span class="command"><strong>apt-get</strong></span>.
</p><p>
É possível que uma estrutura de dependências do sistema se torne corrupta de
modo a necessitar de intervenção manual. Normalmente isto significa utilizar
o <span class="command"><strong>apt-get</strong></span> ou
</p><pre class="screen">
# dpkg --remove <em class="replaceable"><code>nome_do_pacote</code></em>
</pre><p>
para eliminar alguns dos pacotes que estão a criar problemas, ou
</p><pre class="screen">
# apt-get -f install
# dpkg --configure --pending
</pre><p>
Em casos extremos poderá ter que forçar a reinstalação com um comando como
</p><pre class="screen">
# dpkg --install <em class="replaceable"><code>/caminho/para/nome_do_pacote.deb</code></em>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="file-conflicts"></a>4.5.4. Conflitos de ficheiros</h3></div></div></div><p>
Os conflitos de ficheiros não devem ocorrer se estiver a actualizar a partir
de um sistema wheezy <span class="quote">“<span class="quote">pure</span>”</span>, mas podem acontecer se
tiver instalado 'backports' não-oficiais. Um conflito de ficheiros irá
resultar num erro como:
</p><pre class="screen">
A desempacotar <em class="replaceable"><code>&lt;pacote-foo&gt;</code></em> (de <em class="replaceable"><code>&lt;ficheiro-de-pacote-foo&gt;</code></em>) ...
dpkg: erro ao processar <em class="replaceable"><code>&lt;pacote-foo&gt;</code></em> (--install):
 tentando sobrescrever `<em class="replaceable"><code>&lt;algum-nome-de-ficheiro&gt;</code></em>',
 o qual está também no pacote <em class="replaceable"><code>&lt;pacote-bar&gt;</code></em>
dpkg-deb: sub-processo de colagem morto pelo sinal ('pipe' quebrado)
 Foram encontrados erros enquanto se processava:
 <em class="replaceable"><code>&lt;pacote-foo&gt;</code></em>
</pre><p>
Pode tentar resolver um conflito de ficheiro, efectuando a remoção forçada
do pacote mencionado na <span class="emphasis"><em>última</em></span> linha da mensagem de
erro:
</p><pre class="screen">
# dpkg -r --force-depends <em class="replaceable"><code>nome_do_pacote</code></em>
</pre><p>
Depois de corrigir as coisas, deverá ser capaz de continuar a actualização
repetindo os comandos do <span class="command"><strong>apt-get</strong></span> descritos atrás.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-changes"></a>4.5.5. Alterações de configuração</h3></div></div></div><p>
Durante a actualização, ser-lhe-ão colocadas questões acerca da configuração
ou da re-configuração de vários pacotes. Quando lhe for perguntado se algum
ficheiro no directório <code class="filename">/etc/init.d</code>, ou no ficheiro
<code class="filename">/etc/manpath.config</code> deve ser substituído pela versão do
'maintainer' do pacote, normalmente é necessário responder 'sim' para
garantir a consistência do sistema. Pode sempre reverter para as versões
anteriores, já que estas serão guardadas com uma extensão
<code class="literal">.dpkg-old</code>.
</p><p>
Se não tiver a certeza acerca do que fazer, anote o nome do pacote ou do
ficheiro e resolva os problemas mais tarde. Pode procurar o ficheiro
transcrito de modo a rever a informação que esteve no ecrã durante a
actualização.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="console-change"></a>4.5.6. Mudança de sessão para consola</h3></div></div></div><p>
Se estiver a correr a actualização usando a consola local do sistema, pode
descobrir que em certos pontos durante a actualização a consola é mudada
para uma vista diferente e você perde a visibilidade do processo de
actualização. Por exemplo, isto pode acontecer em sistemas de ambiente de
trabalho quando o gestor de ecrã for reiniciado.
</p><p>
Para recuperar a consola onde a actualização estava a correr você tem de
usar <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F1</strong></span>
(se estiver no ecrã de arranque gráfico) ou usar <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F1</strong></span> (se
estiver em consola local de modo de texto) para mudar de novo para o
terminal virtual 1. Substitua F1 pela tecla de função com o mesmo número do
terminal virtual onde a actualização estava a correr. Você também pode usar
<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>Seta
Esquerda</strong></span> ou <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>Seta Direita</strong></span>
para mudar entre os diferentes terminais de modo de texto.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="package-specific-issues"></a>4.5.7. Cuidado especial para pacotes específicos</h3></div></div></div><p>
Na maioria dos casos, os pacotes deverão actualizar suavemente entre
wheezy e jessie. Existe um pequeno número de casos onde
pode ser necessária alguma intervenção manual, seja antes ou durante a
actualização; estes estão detalhados em baixo numa base de por-pacote.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="issues-systemd"></a>4.5.7.1. systemd</h4></div></div></div><p>
    A actualização Debian de wheezy para jessie irá migrar por
predefinição o seu sistema de init de SysV para systemd. Dependendo do seu
sistema e configuração, você pode precisar de fazer algumas alterações
manuais. Nós temos os problemas conhecidos em detalhe em <a class="xref" href="ch-information.pt.html#systemd-upgrade-default-init-system" title="5.6. Actualizar instala o novo sistema init predefinido em Jessie">Secção 5.6, “Actualizar instala o novo sistema init predefinido em Jessie”</a>.
  </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="issues-lxc"></a>4.5.7.2. LXC</h4></div></div></div><p>
    Se você tem o LXC instalado, poderá precisar de ter especial cuidado ao
actualizar o seu sistema e os seus recipientes. Por favor veja <a class="xref" href="ch-information.pt.html#lxc-upgrade-issues" title="5.8. Considerações de actualização para máquinas e containers LXC">Secção 5.8, “Considerações de actualização para máquinas e containers LXC”</a> para problemas conhecidos e soluções.
  </p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="newkernel"></a>4.6. Actualizar o seu kernel e pacotes relacionados</h2></div></div></div><p>
Esta secção explica como actualizar o seu kernel e identifica potenciais
problemas relacionados com esta actualização. Tanto pode instalar um dos
pacotes <code class="systemitem">linux-image-*</code><a id="idp66015536" class="indexterm"></a> fornecidos
pela Debian, ou compilar um kernel personalizado a partir do código fonte.
</p><p>
Note que muita da informação nesta secção é baseada na premissa que irá
utilizar um dos kernels modulares da Debian, juntamente com os pacotes
<code class="systemitem">initramfs-tools</code><a id="idp66018096" class="indexterm"></a> e <code class="systemitem">udev</code><a id="idp66019760" class="indexterm"></a>. Se escolher utilizar um kernel
personalizado que não precisa de uma initrd ou se utiliza um gerador de
initrds diferente, alguma da informação pode não ser relevante para si.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="kernel-metapackage"></a>4.6.1. Instalar um meta-pacote do kernel</h3></div></div></div><p>
Quando executar dist-upgrade de wheezy para jessie, é
fortemente recomendado que instale um novo meta-pacote linux-image-*, se
ainda não o fez anteriormente. Estes meta-pacotes irão puxar automaticamente
uma versão mais recente do kernel durante as actualizações. Você pode
verificar se tem um instalado ao correr:
</p><pre class="screen">
# dpkg -l "linux-image*" | grep ^ii | grep -i meta
</pre><p>
Se não vir nenhuma saída 'output', então poderá ter de ou instalar um novo
pacote linux-image manualmente ou instalar um meta-pacote linux-image. Para
ver uma lista de meta-pacotes linux-image disponíveis, corra:
</p><pre class="screen">
# apt-cache search linux-image- | grep -i meta | grep -v transition
</pre><p>
Se não estiver seguro sobre que pacote selecionar, corra <code class="literal">uname
-r</code> e procure um pacote com um nome semelhante. Por exemplo, se vir
'<code class="literal">2.6.32-5-amd64</code>', é recomendado que instale o <code class="systemitem">linux-image-amd64</code><a id="idp66028144" class="indexterm"></a>. Pode também utilizar o
<span class="command"><strong>apt-cache</strong></span> para ver uma descrição longa acerca de cada
pacote de modo a ajudar a escolher o melhor dos disponíveis. Por exemplo:
</p><pre class="screen">
# apt-cache show linux-image-amd64
</pre><p>
Deverá então utilizar <code class="literal">apt-get install</code> para o
instalar. Uma vez que este novo kernel esteja instalado deverá reinicializar
na primeira oportunidade para obter os benefícios disponibilizados pela nova
versão do kernel. No entanto, por favor veja <a class="xref" href="ch-upgrading.pt.html#nownownow" title="4.7. Coisas a fazer antes de reiniciar a máquina">Secção 4.7, “Coisas a fazer antes de reiniciar a máquina”</a>
antes de executar o primeiro arranque após a actualização.
</p><p>
Para os mais aventureiros existe um modo mais fácil de compilar o seu
próprio kernel personalizado em Debian. Instale o código-fonte do kernel,
disponibilizado em <code class="systemitem">linux-source</code><a id="idp66034496" class="indexterm"></a>. Você pode fazer uso do alvo do
<code class="literal">deb-pkg</code> disponível no makefile do código-fonte para
construir um pacote binário. Pode ser encontrada main informação no <a class="ulink" href="http://kernel-handbook.alioth.debian.org/" target="_top">Debian Linux Kernel
Handbook</a>, o qual também pode ser encontrado como o pacote
<code class="systemitem">debian-kernel-handbook</code><a id="idp66038032" class="indexterm"></a>.
</p><p>
Se possível, é vantajoso para si em actualizar o pacote do kernel
separadamente do <code class="literal">dist-upgrade</code> principal para reduzir as
probabilidades de ter um sistema temporariamente incapaz de arrancar. Note
que isto deve apenas ser feito após o processo mínimo de actualização
descrito em <a class="xref" href="ch-upgrading.pt.html#minimal-upgrade" title="4.4.4. Actualização mínima do sistema">Secção 4.4.4, “Actualização mínima do sistema”</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="initramfs-tools-issues"></a>4.6.2. Alerações à montagem do sistema de ficheiros e verificação da raiz e
<code class="filename">/usr</code></h3></div></div></div><p>
    <code class="systemitem">initramfs-tools</code><a id="idp66044032" class="indexterm"></a> irá agora também
correr o <code class="literal">fsck</code> no sistema de ficheiros raiz antes de o
montar. Se o programa init escolhido for o <code class="literal">systemd</code> e
houver um sistema de ficheiros <code class="filename">/usr/</code> separado, irá
também fazer fsck a este e montar <code class="filename">/usr</code>.
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
	Se <code class="filename">/usr</code> for um sistema de ficheiros separado num
dispositivo RAID e a definição <code class="literal">INITRDSTART</code> em
<code class="filename">/etc/default/mdadm</code> não for '<code class="literal">all</code>',
irá ter que a alterar de forma a incluir esse dispositivo.
      </p></li><li class="listitem"><p>
	Se <code class="filename">/usr</code> for um sistema de ficheiros separado num volume
lógico LVM, e a linha para <code class="filename">/usr</code> em
<code class="filename">/etc/fstab</code> especificar o dispositivo por
<code class="literal">UUID</code> ou por <code class="literal">LABEL</code>, terá de alterar
esta linha para especificar o dispositivo utilizando o formato
<code class="filename">/dev/mapper/<em class="replaceable"><code>VG</code></em>-<em class="replaceable"><code>LV</code></em></code>
ou
<code class="filename">/dev/<em class="replaceable"><code>VG</code></em>/<em class="replaceable"><code>LV</code></em></code>.
      </p></li><li class="listitem"><p>
	Já não é possível fazer bind-mount ao sistema de ficheiros
<code class="filename">/usr</code>.
      </p></li><li class="listitem"><p>
	Se o RTC (Real Time Clock) estiver definido para a hora local e a hora local
for à frente de UTC, o <code class="literal">e2fsck</code> irá escrever um aviso
durante o arranque sobre a hora mudar para trás (<a class="ulink" href="https://bugs.debian.org/767040" target="_top">bug #767040</a>). Pode desativar
isto ao colocar as seguintes linhas em
<code class="filename">/etc/e2fsck.conf</code>:
      </p><pre class="screen">
[options]
broken_system_clock=1
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="nownownow"></a>4.7. Coisas a fazer antes de reiniciar a máquina</h2></div></div></div><p>
Quando o <code class="literal">apt-get dist-upgrade</code> tiver terminado, a
actualização <span class="quote">“<span class="quote">formal</span>”</span> estará completa, mas existem algumas
coisas com as quais é preciso ter atenção <span class="emphasis"><em>antes</em></span> do
próximo reiniciar do sistema.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
      Quando se actualiza de Wheezy para Jessie, pode ser boa
ideia purgar os pacotes antigos <span class="emphasis"><em>antes</em></span> do primeiro
arranque. Em particular, os scripts de init obsoletos podem causar
problemas. Por favor veja <a class="xref" href="ch-upgrading.pt.html#purge-removed-packages" title="4.8.1. Purgar pacotes removidos">Secção 4.8.1, “Purgar pacotes removidos”</a> para
detalhes sobre encontrar e purgar pacotes removidos.
    </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="for-next"></a>4.8. Preparar para o próximo lançamento</h2></div></div></div><p>
Após a actualização existem várias coisas que você pode fazer para se
preparar para o próximo lançamento.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
Remova os novos pacotes obsoletos e não utilizados conforme descrito em
<a class="xref" href="ch-upgrading.pt.html#obsolete" title="4.10. Pacotes obsoletos">Secção 4.10, “Pacotes obsoletos”</a> e em <a class="xref" href="ch-upgrading.pt.html#obsolete" title="4.10. Pacotes obsoletos">Secção 4.10, “Pacotes obsoletos”</a>. Você deve rever
que ficheiros de configuração eles utilizam e considerar purgar os pacotes
para remover os seus ficheiros de configuração. Veja também <a class="xref" href="ch-upgrading.pt.html#purge-removed-packages" title="4.8.1. Purgar pacotes removidos">Secção 4.8.1, “Purgar pacotes removidos”</a>.
</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="purge-removed-packages"></a>4.8.1. Purgar pacotes removidos</h3></div></div></div><p>
    Geralmente é aconselhável purgar os pacotes removidos. Isto é especialmente
verdadeiro se estes foram removidos numa actualização de lançamento anterior
(ex. a partir da actualização para wheezy) ou se estes foram
fornecidos por pacotes de terceiros. Em particular, scripts de init.d
antigos são conhecidos por causarem problemas.
  </p><div class="caution"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Cuidado]" src="images/caution.png" /></td><th align="left">Cuidado</th></tr><tr><td align="left" valign="top"><p>
      Purgar um pacote irá geralmente também purgar os seus ficheiros de relatório
(log), então você poderá querer fazer-lhes cópias de backup primeiro.
    </p></td></tr></table></div><p>
    O seguinte comando mostra uma lista de todos os pacotes removidos que podem
ter deixado ficheiros de configuração no sistema (se existentes):
  </p><pre class="screen">
# dpkg -l | awk '/^rc/ { print $2 }'
</pre><p>
    Os pacotes podem ser removidos ao usar <span class="command"><strong>apt-get
purge</strong></span>. Assumindo que deseja purgá-los todos de uma vez, pode usar
o seguinte comando:
  </p><pre class="screen">
# apt-get purge $(dpkg -l | awk '/^rc/ { print $2 }')
</pre><p>
    Se você usar o <code class="systemitem">aptitude</code><a id="idp66084288" class="indexterm"></a>, também pode
usar a seguinte alternativa para os comandos em cima:
  </p><pre class="screen">
$ aptitude search '~c'
$ aptitude purge '~c'
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deprecated"></a>4.9. Componentes descontinuados</h2></div></div></div><p>
Com o próximo lançamento da Debian 9 (nome de código
stretch) algumas funções serão descontinuadas. Os utilizadores
terão que migrar para outras alternativas para prevenir problemas quando
actualizar para 9.
</p><p>
Isto inclui as seguintes funcionalidades:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>O pacote <code class="systemitem">hardening-wrapper</code><a id="idp66094368" class="indexterm"></a> foi
depreciado e é esperado que seja removido no lançamento Stretch.
		</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="obsolete"></a>4.10. Pacotes obsoletos</h2></div></div></div><p>
Ao introduzir imensos novos pacotes, a jessie também remove e omite
imensos pacotes antigos que estavam na wheezy. Não fornece um
caminho de actualização para estes pacotes obsoletos. Ao mesmo tempo que
nada o impede de continuar a utilizar um pacote obsoleto enquanto o desejar,
o projecto Debian irá normalmente descontinuar o suporte de segurança para o
mesmo um ano depois do lançamento da jessie<a href="#ftn.idp66097792" class="footnote" id="idp66097792"><sup class="footnote">[5]</sup></a>, e não irá disponibilizar como normalmente
disponibilizar outro suporte entretanto. É recomendado substituí-los por
alternativas, se existirem.
</p><p>
Existem muitas razões para que pacotes possam ter sido retirados da
distribuição: não serem mais mantida uma evolução; não existir mais um
Debian 'Developer' interessado em manter os pacotes; a funcionalidade que
estes fornecem ter sido ultrapassada por outro software diferente (ou uma
nova versão); ou deixados de serem considerados adequados para a
jessie devido a bugs neles. No último caso, os pacotes podem no
entanto continuar a estarem presentes na distribuição
<span class="quote">“<span class="quote">unstable</span>”</span>.
</p><p>
A detecção dos pacotes que num sistema actualizado são
<span class="quote">“<span class="quote">obsoletos</span>”</span> é fácil pelo facto dos 'front-ends' de gestão de
pacotes os marcarem como tal. Se estiver a utilizar o
<span class="command"><strong>aptitude</strong></span>, verá a lista destes pacotes na entrada
<span class="quote">“<span class="quote">Pacotes obsoletos e criados localmente</span>”</span>.
</p><p>
O <a class="ulink" href="https://bugs.debian.org/" target="_top">Debian Bug Tracking System</a> frequentemente
fornece informação adicional sobre a razão da remoção do pacote. Deverá
rever ambos os relatórios de erro do pacote e os relatórios de bugs
arquivados para o <a class="ulink" href="https://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=ftp.debian.org&amp;archive=yes" target="_top">ftp.debian.org
pseudo-package</a>.
</p><p>
  A lista de pacotes obsoletos inclui:
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
	<code class="systemitem">postgresql-9.1</code><a id="idp66107216" class="indexterm"></a>, o sucessor é
<code class="systemitem">postgresql-9.4</code><a id="idp66108928" class="indexterm"></a>. Assim que a
actualização do sistema operativo esteja completa, você deve planear
actualizar também os seus cluster de base de dados do PostgreSQL 9.1 para a
nova versão 9.4 do PostgreSQL usando a ferramenta
<span class="command"><strong>pg_upgradecluster</strong></span>. Para os utilizadores da linguagem
procedural PL/perl, jessie disponibiliza um pacote <code class="systemitem">postgresql-plperl-9.1</code><a id="idp66111824" class="indexterm"></a> actualizado com ligações à
versão de jessie da libperl de modo a permitir a actualização para a nova
versão de perl em jessie enquanto mantêm funções utilizáveis da base de
dados PL/Perl antiga até que a base de dados seja também actualizada.
      </p></li><li class="listitem"><p>
        
        
<code class="systemitem">python3.2</code><a id="idp66114800" class="indexterm"></a>, sucessor é o <code class="systemitem">python3.4</code><a id="idp66116512" class="indexterm"></a>. (A versão 2.7 é suportada em ambos
wheezy e jessie.)
      </p></li><li class="listitem"><p>
        <code class="systemitem">ruby1.8</code><a id="idp66119088" class="indexterm"></a> e <code class="systemitem">ruby1.9.1</code><a id="idp66120752" class="indexterm"></a>; o sucessor é <code class="systemitem">ruby2.1</code><a id="idp66122464" class="indexterm"></a>.  Por favor instale o pacote <code class="systemitem">ruby</code><a id="idp66124176" class="indexterm"></a> para acompanhar automaticamente a versão de
ruby actual.
      </p></li><li class="listitem"><p>
        <code class="systemitem">mplayer</code><a id="idp66126752" class="indexterm"></a>; alternativas são
<code class="systemitem">mplayer2</code><a id="idp66128480" class="indexterm"></a>, e <code class="systemitem">mpv</code><a id="idp66130144" class="indexterm"></a> (novo em jessie). Enquanto o primeiro
é maioritariamente compatível com o mplayer em termos de argumentos de linha
de comandos e configuração (também adiciona algumas novas funcionalidades),
o segundo adiciona imensas novas funcionalidades e melhoramentos, e é
mantido activamente pelo autor original.
      </p></li><li class="listitem"><p>
        <code class="systemitem">openoffice.org</code><a id="idp66133184" class="indexterm"></a>; por favor use o
<code class="systemitem">libreoffice</code><a id="idp66134880" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        <code class="systemitem">squid</code><a id="idp66137344" class="indexterm"></a>, o sucessor é <code class="systemitem">squid3</code><a id="idp66139056" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        <code class="systemitem">libjpeg-progs</code><a id="idp66141520" class="indexterm"></a>, o sucessor é
<code class="systemitem">libjpeg-turbo-progs</code><a id="idp66143232" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        <code class="systemitem">openjdk-6</code><a id="idp66145696" class="indexterm"></a>, sucessor é o <code class="systemitem">openjdk-7</code><a id="idp66147408" class="indexterm"></a>.
      </p></li></ul></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="dummy"></a>4.10.1. Pacotes fictícios</h3></div></div></div><p>
Alguns pacotes da wheezy foram separados em vários pacotes na
jessie, muitas vezes para melhorar a manutenção do sistema. Para
facilitar a actualização em alguns casos, a jessie fornece pacotes
<span class="quote">“<span class="quote">dummy</span>”</span>: pacotes vazios que têm o mesmo nome que o pacote
antigo na wheezy com dependências que provocam a instalação dos
novos pacotes. Estes pacotes <span class="quote">“<span class="quote">dummy</span>”</span> são considerados
redundantes depois da actualização e podem ser removidos em segurança.
</p><p>
A maior parte (mas nem todas) das descrições dos pacotes fictícios indicam o
seu objectivo. As descrições dos pacotes para os pacotes fictícios não são
uniformes, no entanto você pode achar o <span class="command"><strong>deborphan</strong></span> com a
opção <code class="literal">--guess-<em class="replaceable"><code>*</code></em></code>
(ex. <code class="literal">--guess-dummy</code>) útil para detectá-los no seu
sistema. Note que alguns pacotes fictícios não se destinam a serem removidos
depois de uma actualização, e em vez disso, são utilizadas para seguir as
actuais versões disponíveis de um programa ao longo do tempo.
</p></div></div><div class="footnotes"><br /><hr width="100" align="left" /><div id="ftn.idp65681808" class="footnote"><p><a href="#idp65681808" class="para"><sup class="para">[1] </sup></a>Se a prioridade de debconf estiver definida para um nível muito alto pode
prevenir avisos de configuração, mas os serviços que se regem em respostas
predefinidas que não estão aplicáveis no seu sistema irão falhar o arranque.</p></div><div id="ftn.idp65683536" class="footnote"><p><a href="#idp65683536" class="para"><sup class="para">[2] </sup></a>Por exemplo: os serviços DNS ou DHCP, especialmente quando não houver
redundância ou alta disponibilidade. No caso do DHCP, os utilizadores finais
podem ficar desligados da rede se o tempo de lease for menor que o tempo que
durar a completar o processo de actualização.</p></div><div id="ftn.idp65699296" class="footnote"><p><a href="#idp65699296" class="para"><sup class="para">[3] </sup></a> Esta função pode ser desactivada ao adicionar o parametro
<code class="literal">panic=0</code> aos parametros de arranque.  </p></div><div id="ftn.idp65785632" class="footnote"><p><a href="#idp65785632" class="para"><sup class="para">[4] </sup></a> O sistema de gestão de pacotes da Debian normalmente não permite que um
pacote remova ou substitua um ficheiro pertencente a outro pacote, a não ser
que tenha definido para substituir esse pacote.  </p></div><div id="ftn.idp66097792" class="footnote"><p><a href="#idp66097792" class="para"><sup class="para">[5] </sup></a> Ou enquanto não for feito outro lançamento durante esse periodo de
tempo. Tipicamente apenas dois lançamentos estáveis são suportados em
qualquer altura.  </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch-installing.pt.html"><img src="images/prev.png" alt="Anterior" /></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch-information.pt.html"><img src="images/next.png" alt="Próximo" /></a></td></tr><tr><td width="40%" align="left" valign="top">Capítulo 3. Sistema de Instalação </td><td width="20%" align="center"><a accesskey="h" href="index.pt.html"><img src="images/home.png" alt="Início" /></a></td><td width="40%" align="right" valign="top"> Capítulo 5. Problemas a estar atento na jessie</td></tr></table></div></body></html>