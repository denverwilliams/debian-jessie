<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Capítulo 4. Atualizações a partir do Debian 7 (wheezy)</title><link rel="stylesheet" type="text/css" href="debian.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.pt-br.html" title="Notas de lançamento do Debian 8 (jessie), PC 64 bits" /><link rel="up" href="index.pt-br.html" title="Notas de lançamento do Debian 8 (jessie), PC 64 bits" /><link rel="prev" href="ch-installing.pt-br.html" title="Capítulo 3. Sistema de instalação" /><link rel="next" href="ch-information.pt-br.html" title="Capítulo 5. Problemas a serem considerados para a jessie" /><meta xmlns="" name="viewport" content="width=device-width, initial-scale=1" /><style xmlns="" type="text/css">
      body {
        background-repeat: no-repeat;
        background-image: none;
      }
    </style></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Capítulo 4. Atualizações a partir do Debian 7 (wheezy)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch-installing.pt-br.html"><img src="images/prev.png" alt="Anterior" /></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch-information.pt-br.html"><img src="images/next.png" alt="Próxima" /></a></td></tr></table><hr /></div><div xml:lang="pt_BR" class="chapter" lang="pt_BR"><div class="titlepage"><div><div><h1 class="title"><a id="ch-upgrading"></a>Capítulo 4. Atualizações a partir do Debian 7 (wheezy)</h1></div></div></div><div class="toc"><p><strong>Índice</strong></p><dl class="toc"><dt><span class="section"><a href="ch-upgrading.pt-br.html#backup">4.1. Preparando para a atualização</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt-br.html#data-backup">4.1.1. Faça backup de quaisquer dados ou informações de configuração</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#inform-users">4.1.2. Informe os usuários com antecedência</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#services-downtime">4.1.3. Preparar para a indisponibilidade dos serviços</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#recovery">4.1.4. Preparar para recuperação</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#upgrade-preparations">4.1.5. Preparar um ambiente seguro para a atualização</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt-br.html#system-status">4.2. Verificando a situação do sistema</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt-br.html#review-actions">4.2.1. Rever as ações pendentes no gerenciador de pacotes</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#disable-apt-pinning">4.2.2. Desabilitando o pinning do APT</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#package-status">4.2.3. Verificando a situação dos pacotes</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#proposed-updates">4.2.4. A seção <span class="quote">“<span class="quote">proposed-updates</span>”</span></a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#unofficial-sources">4.2.5. Fontes não oficiais</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt-br.html#upgrade-process">4.3. Preparando as fontes para o APT</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt-br.html#network">4.3.1. Adicionar fontes da Internet ao APT</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#localmirror">4.3.2. Adicionando fontes ao APT para um espelho local</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#cdroms">4.3.3. Adicionando fontes ao APT a partir de mídia ótica</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt-br.html#upgradingpackages">4.4. Atualizando pacotes</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt-br.html#record-session">4.4.1. Gravando a sessão</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#updating-lists">4.4.2. Atualizando a lista de pacotes</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#sufficient-space">4.4.3. Certifique-se que você tem espaço suficiente para a atualização</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#minimal-upgrade">4.4.4. Atualização mínima do sistema</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#upgrading-full">4.4.5. Atualizando o sistema</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt-br.html#trouble">4.5. Possíveis problemas durante a atualização</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt-br.html#immediate-configure">4.5.1. O dist-upgrade falha com <span class="quote">“<span class="quote">Could not perform immediate
configuration</span>”</span></a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#expected-removals">4.5.2. Remoções esperadas</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#conflicts-loops">4.5.3. Loops de conflitos ou pré-dependências</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#file-conflicts">4.5.4. Conflitos de arquivo</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#configuration-changes">4.5.5. Mudanças de configuração</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#console-change">4.5.6. Mudança de sessão para o console</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#package-specific-issues">4.5.7. Cuidados especiais com pacotes específicos</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt-br.html#newkernel">4.6. Atualizando o seu kernel e pacotes relacionados</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt-br.html#kernel-metapackage">4.6.1. Instalando um metapacote do kernel</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#initramfs-tools-issues">4.6.2. Mudanças na montagem e verificação do sistema de arquivos raiz e
<code class="filename">/usr</code></a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt-br.html#nownownow">4.7. Coisas para fazer antes de reinicializar</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#for-next">4.8. Preparar para a próxima versão</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt-br.html#purge-removed-packages">4.8.1. Expurgando pacotes removidos</a></span></dt></dl></dd><dt><span class="section"><a href="ch-upgrading.pt-br.html#deprecated">4.9. Componentes obsoletos</a></span></dt><dt><span class="section"><a href="ch-upgrading.pt-br.html#obsolete">4.10. Pacotes obsoletos</a></span></dt><dd><dl><dt><span class="section"><a href="ch-upgrading.pt-br.html#dummy">4.10.1. Pacotes fictícios</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="backup"></a>4.1. Preparando para a atualização</h2></div></div></div><p>
Nós sugerimos que antes de atualizar você também leia as informações na
<a class="xref" href="ch-information.pt-br.html" title="Capítulo 5. Problemas a serem considerados para a jessie">Capítulo 5, <em>Problemas a serem considerados para a jessie</em></a>. Esse capítulo aborda potenciais problemas,
os quais não estão diretamente relacionados ao processo de atualização, mas
que ainda pode ser importante conhecer antes que você comece.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="data-backup"></a>4.1.1. Faça backup de quaisquer dados ou informações de configuração</h3></div></div></div><p>
Antes de atualizar o seu sistema, é fortemente recomendado que você faça um
backup completo ou, pelo menos, faça backup de quaisquer dados ou
informações de configuração que você não possa perder. As ferramentas de
atualização e o processo são bastante confiáveis, mas uma falha de hardware
no meio de uma atualização pode resultar em um sistema severamente
danificado.
</p><p>
As principais coisas que você terá que fazer backup são os conteúdos do
<code class="filename">/etc</code>, <code class="filename">/var/lib/dpkg</code>,
<code class="filename">/var/lib/apt/extended_states</code> e a saída do <code class="literal">dpkg
--get-selections "*"</code> (as aspas são importantes). Caso você utilize
o <span class="command"><strong>aptitude</strong></span> para gerenciar pacotes em seu sistema, você
também terá que fazer backup do
<code class="filename">/var/lib/aptitude/pkgstates</code>.
</p><p>
O processo de atualização em si não modifica nada no diretório
<code class="filename">/home</code>. Porém, alguns aplicativos (por exemplo, partes
da suíte Mozilla e os ambientes de área de trabalho GNOME e KDE) são
conhecidos por sobrescrever as configurações existentes dos usuários com
novos padrões, quando uma nova versão do aplicativo é iniciada pela primeira
vez por um usuário. Como precaução, você pode fazer um backup dos arquivos e
diretórios ocultos (<span class="quote">“<span class="quote">dotfiles</span>”</span>) nos diretórios home dos
usuários. Esse backup pode ajudar a recuperar ou recriar antigas
configurações. Você também pode informar os usuários sobre isso.
</p><p>
Qualquer operação de instalação de pacote deve ser executada com privilégios
de superusuário, para isso, faça login como <code class="literal">root</code> ou use o
<span class="command"><strong>su</strong></span> ou o <span class="command"><strong>sudo</strong></span> para obter os direitos de
acesso necessários.
</p><p>
A atualização possui algumas condições prévias; você deve verificá-las antes
de começar a executar a atualização.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="inform-users"></a>4.1.2. Informe os usuários com antecedência</h3></div></div></div><p>
É sensato informar a todos os usuários com antecedência sobre qualquer
atualização que você esteja planejando, embora os usuários que acessem o seu
sistema via uma conexão <span class="command"><strong>ssh</strong></span> pouco devam notar durante a
atualização, e devam ser capazes de continuar trabalhando. 
</p><p>
Caso você deseje tomar precauções extras, faça backup ou desmonte a partição
<code class="filename">/home</code> antes de atualizar.
</p><p>
Você terá que fazer uma atualização de kernel quando atualizar para o
jessie, então, uma reinicialização será necessária. Normalmente, isso
será feito depois que a atualização for concluída.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="services-downtime"></a>4.1.3. Preparar para a indisponibilidade dos serviços</h3></div></div></div><p>
Poderão haver serviços que são oferecidos pelo sistema que estão associados
aos pacotes que serão incluídos na atualização. Se esse for o caso, por
favor, note que durante a atualização esses serviços serão interrompidos,
enquanto os seus pacotes associados estiverem sendo substituídos e
configurados. Durante esse tempo, esses serviços não estarão disponíveis.
</p><p>
O tempo exato de indisponibilidade desses serviços variará dependendo do
número de pacotes sendo atualizados no sistema, e isso também inclui o tempo
que o administrador do sistema gasta respondendo a quaisquer perguntas de
configuração das atualizações dos pacotes. Observe que, se o processo de
atualização for deixado sem acompanhamento e o sistema solicitar uma entrada
durante a atualização, existe uma grande possibilidade dos serviços ficarem
indisponíveis<a href="#ftn.idp49265552" class="footnote" id="idp49265552"><sup class="footnote">[1]</sup></a> por um período
significativo de tempo.
</p><p>
Se o sistema que está sendo atualizado fornecer serviços críticos para os
seus usuários ou para a rede<a href="#ftn.idp49267264" class="footnote" id="idp49267264"><sup class="footnote">[2]</sup></a>, você pode
reduzir o tempo de indisponibilidade caso você faça uma atualização mínima
do sistema, como descrito na <a class="xref" href="ch-upgrading.pt-br.html#minimal-upgrade" title="4.4.4. Atualização mínima do sistema">Seção 4.4.4, “Atualização mínima do sistema”</a>, seguida de
uma atualização do kernel e reinicialização, e então atualizar os pacotes
associados aos seus serviços críticos. Atualize esses pacotes antes de fazer
a atualização completa descrita na <a class="xref" href="ch-upgrading.pt-br.html#upgrading-full" title="4.4.5. Atualizando o sistema">Seção 4.4.5, “Atualizando o sistema”</a>. Dessa
forma, você pode garantir que esses serviços essenciais estejam funcionando
e disponíveis durante o processo de atualização completa, e o seu tempo de
indisponibilidade seja reduzido.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="recovery"></a>4.1.4. Preparar para recuperação</h3></div></div></div><p>
Embora o Debian tente garantir que o seu sistema permaneça inicializável a
todo o momento, sempre há uma chance de você ter problemas ao reinicializar
o seu sistema após a atualização. Problemas possíveis conhecidos são
documentados neste e nos próximos capítulos destas notas de lançamento.
</p><p>
Por essa razão faz sentido garantir que você seja capaz de recuperar o seu
sistema caso não consiga reinicializar ou, para sistemas gerenciados
remotamente, não consiga levantar a rede.
</p><p>
Caso você esteja atualizando remotamente através de um link
<span class="command"><strong>ssh</strong></span>, é recomendado que você tome as precauções
necessárias para ser capaz de acessar o servidor por meio de um terminal
serial remoto. Há uma chance de que, após atualizar o kernel e
reinicializar, você tenha que corrigir a configuração do sistema por meio de
um console local. Além disso, se o sistema for reinicializado acidentalmente
no meio de uma atualização, existe uma chance de que precise recuperá-lo
usando um console local.
</p><p>
Geralmente, nós recomendamos usar o <span class="emphasis"><em>modo de recuperação</em></span>
do Instalador Debian do jessie. A vantagem de usar o instalador é que
você pode escolher entre os seus vários métodos para encontrar aquele que
melhor se adéqua à sua situação. Para mais informações, por favor, consulte
a seção <span class="quote">“<span class="quote">Recuperando um sistema quebrado</span>”</span> no capítulo 8 do
<a class="ulink" href="https://www.debian.org/releases/jessie/installmanual" target="_top">Guia de Instalação</a> e a <a class="ulink" href="https://wiki.debian.org/DebianInstaller/FAQ" target="_top">FAQ do Instalador Debian</a>.
</p><p>
Se isso falhar, você precisará de uma forma alternativa de inicializar seu
sistema, e assim poder acessá-lo e repará-lo. Um opção é usar uma imagem
especial de recuperação ou um live CD de Linux. Após a inicialização a
partir dele, você deverá ser capaz de montar o seu sistema de arquivos raiz
e fazer <code class="literal">chroot</code> nele para investigar e corrigir o
problema.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="recovery-initrd"></a>4.1.4.1. Shell de depuração durante a inicialização usando initrd</h4></div></div></div><p>
O pacote <code class="systemitem">initramfs-tools</code><a id="idp49283120" class="indexterm"></a> inclui um
shell de depuração<a href="#ftn.idp49283968" class="footnote" id="idp49283968"><sup class="footnote">[3]</sup></a> nas initrds que ele
gera. Se, por exemplo, a initrd for incapaz de montar o seu sistema de
arquivos raiz, você será deixado nesse shell de depuração que tem comandos
básicos disponíveis para ajudar a rastrear o problema e possivelmente
corrigi-lo.
</p><p>
Coisas básicas a serem verificadas: presença dos arquivos de dispositivo
corretos em <code class="filename">/dev</code>; quais módulos estão carregados
(<code class="literal">cat /proc/modules</code>); saída do <span class="command"><strong>dmesg</strong></span>
com erros de carregamento de drivers. A saída do <span class="command"><strong>dmesg</strong></span>
também exibirá quais arquivos de dispositivo foram associados a quais
discos; você deve verificar isso com a saída do <code class="literal">echo
$ROOT</code> para certificar-se que o sistema de arquivos raiz está no
dispositivo esperado.
</p><p>
Caso você consiga resolver o problema, digitando <code class="literal">exit</code>
sairá do shell de depuração e continuará o processo de inicialização a
partir do ponto em que ele falhou. Claro que você também precisará corrigir
a causa do problema e gerar novamente a initrd, pois assim a próxima
inicialização não falhará novamente.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="recovery-shell-systemd"></a>4.1.4.2. Shell de depuração durante a inicialização usando systemd</h4></div></div></div><p>
    No caso da inicialização falhar sob o systemd, é possível obter um shell
root de depuração alterando-se a linha de comando do kernel. Caso a
inicialização básica funcione, mas alguns dos serviços falhem ao iniciar,
pode ser útil adicionar <code class="literal">systemd.unit=rescue.target</code> aos
parâmetros do kernel.
  </p><p>
    Caso contrário, o parâmetro do kernel
<code class="literal">systemd.unit=emergency.target</code> irá fornecer-lhe um shell
root no momento mais imediato possível. Porém, isso é feito antes da
montagem do sistema de arquivos raiz com permissões de leitura e
escrita. Você terá que fazer isso manualmente com:
  </p><pre class="screen">
mount -o remount,rw /
</pre><p>
    Mais informações sobre depuração de uma inicialização quebrada sob systemd
podem ser encontradas no artigo <a class="ulink" href="http://freedesktop.org/wiki/Software/systemd/Debugging/" target="_top">Diagnosticando
problemas de inicialização</a>.
  </p><p>
    Se tudo isso falhar, é provável que você possa inicializar através do antigo
sistema sysvinit. Isso requer que o <code class="systemitem">sysvinit</code><a id="idp49299936" class="indexterm"></a> ainda esteja instalado e o executável
<code class="filename">/lib/sysvinit/init</code> esteja incluído no seu
initramfs. Caso estes requisitos sejam atendidos, adicione
<code class="literal">init=/lib/sysvinit/init</code> à linha de comando do kernel e
ele inicializará com o executável do sysvinit.
  </p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrade-preparations"></a>4.1.5. Preparar um ambiente seguro para a atualização</h3></div></div></div><p>
A atualização da distribuição deve ser feita localmente a partir de um
console virtual em modo texto (ou um terminal serial conectado diretamente),
ou remotamente através de um link <span class="command"><strong>ssh</strong></span>. 
</p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Importante]" src="images/important.png" /></td><th align="left">Importante</th></tr><tr><td align="left" valign="top"><p>
  Caso você esteja usando alguns serviços VPN (tais como <code class="systemitem">tinc</code><a id="idp49306608" class="indexterm"></a>), eles podem não estar disponíveis ao longo
do processo de atualização. Por favor, veja a <a class="xref" href="ch-upgrading.pt-br.html#services-downtime" title="4.1.3. Preparar para a indisponibilidade dos serviços">Seção 4.1.3, “Preparar para a indisponibilidade dos serviços”</a>.
  </p></td></tr></table></div><p>
A fim de conseguir uma margem extra de segurança quando atualizar
remotamente, nós sugerimos que você execute o processo de atualização no
console virtual fornecido pelo programa <span class="command"><strong>screen</strong></span>, que
permite uma reconexão segura e garante que o processo de atualização não
seja interrompido mesmo se o processo de conexão remota falhar.
</p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Importante]" src="images/important.png" /></td><th align="left">Importante</th></tr><tr><td align="left" valign="top"><p>
    Você <span class="emphasis"><em>não</em></span> deve atualizar utilizando
<span class="command"><strong>telnet</strong></span>, <span class="command"><strong>rlogin</strong></span>,
<span class="command"><strong>rsh</strong></span>, ou a partir de uma sessão X gerenciada por
<span class="command"><strong>xdm</strong></span>, <span class="command"><strong>gdm</strong></span> ou <span class="command"><strong>kdm</strong></span>,
etc., na máquina que você estiver atualizando. Isso é porque cada um desses
serviços pode muito bem ser terminado durante a atualização, o que pode
resultar em um sistema <span class="emphasis"><em>inacessível</em></span> que está apenas
parcialmente atualizado. O uso do aplicativo
<span class="command"><strong>update-manager</strong></span> do GNOME é <span class="emphasis"><em>fortemente
desencorajado</em></span> para atualizações para novas versões, pois essa
ferramenta precisa que a sessão da área de trabalho se mantenha ativa.
  </p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="system-status"></a>4.2. Verificando a situação do sistema</h2></div></div></div><p>
O processo de atualização descrito neste capítulo foi idealizado para
atualizações a partir de sistemas wheezy <span class="quote">“<span class="quote">puros</span>”</span> sem
pacotes de terceiros. Para uma maior confiabilidade do processo de
atualização, você pode remover pacotes de terceiros do seu sistema antes de
começar a atualização.
</p><p>
Atualizações diretas a partir de versões do Debian mais antigas do que a
7 (wheezy) não são suportadas. Por favor, siga as
instruções nas <a class="ulink" href="https://www.debian.org/releases/wheezy/releasenotes" target="_top">Notas de
lançamento para Debian 7</a> para atualizar para
7 primeiro.
</p><p>
Esse procedimento também assume que o seu sistema foi atualizado para a
versão pontual mais recente do wheezy. Caso você não tenha feito
isso ou não tenha certeza, siga as instruções na <a class="xref" href="ap-old-stuff.pt-br.html#old-upgrade" title="A.1. Atualizando seu sistema wheezy">Seção A.1, “Atualizando seu sistema wheezy”</a>.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="review-actions"></a>4.2.1. Rever as ações pendentes no gerenciador de pacotes</h3></div></div></div><p>
Em alguns casos, o uso do <span class="command"><strong>apt-get</strong></span> para instalação de
pacotes, em vez do <span class="command"><strong>aptitude</strong></span>, pode fazer o
<span class="command"><strong>aptitude</strong></span> considerar um pacote como <span class="quote">“<span class="quote">não
usado</span>”</span> e agendá-lo para remoção. Em geral, você deve certificar-se
que o sistema está totalmente atualizado e <span class="quote">“<span class="quote">limpo</span>”</span> antes de
proceder com a atualização.
</p><p>
Por causa disso, você deve rever se existem quaisquer ações pendentes no
gerenciador de pacotes <span class="command"><strong>aptitude</strong></span>. Se um pacote estiver
agendado para remoção ou atualização no gerenciador de pacotes, ele pode
impactar negativamente no procedimento de atualização. Note que só é
possível corrigir isso se o seu <code class="filename">sources.list</code> ainda
apontar para o <span class="emphasis"><em>wheezy</em></span> e não para
<span class="emphasis"><em>stable</em></span> ou <span class="emphasis"><em>jessie</em></span>; veja a
<a class="xref" href="ap-old-stuff.pt-br.html#old-sources" title="A.2. Verificando sua lista de fontes (sources list)">Seção A.2, “Verificando sua lista de fontes (sources list)”</a>.
</p><p>
Para fazer esta revisão, inicie o <span class="command"><strong>aptitude</strong></span> em <span class="quote">“<span class="quote">modo
visual</span>”</span> e pressione <span class="keycap"><strong>g</strong></span> (<span class="quote">“<span class="quote">Go</span>”</span>). Se ele
mostrar quaisquer ações, você deve revê-las e corrigi-las ou implementar as
ações sugeridas. Se nenhuma ação for sugerida será apresentada uma mensagem
dizendo <span class="quote">“<span class="quote">Nenhum pacote está agendado para ser instalado, removido ou
atualizado</span>”</span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="disable-apt-pinning"></a>4.2.2. Desabilitando o pinning do APT</h3></div></div></div><p>
Caso você tenha configurado o APT para instalar determinados pacotes a
partir de uma distribuição diferente da "stable" (por exemplo, da
"testing"), você pode ter que mudar sua configuração de pinning do APT
(guardada em <code class="filename">/etc/apt/preferences</code> e
<code class="filename">/etc/apt/preferences.d/</code>) para permitir a atualização
dos pacotes para as versões existentes na nova versão "stable". Mais
informações sobre pinning do APT podem ser encontradas em <span class="citerefentry"><span class="refentrytitle">apt_preferences</span>(5)</span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="package-status"></a>4.2.3. Verificando a situação dos pacotes</h3></div></div></div><p>
Independentemente do método usado para atualização, é recomendado que você
primeiro verifique a situação de todos os pacotes, e verifique se todos
estão em uma situação atualizável. O seguinte comando exibirá quaisquer
pacotes que tenham uma situação de <span class="quote">“<span class="quote">Half-Installed</span>”</span> ou
<span class="quote">“<span class="quote">Failed-Config</span>”</span>, e aqueles com alguma situação de erro.
</p><pre class="screen">
# dpkg --audit
</pre><p>
Você também pode inspecionar o estado de todos os pacotes em seu sistema
utilizando o <span class="command"><strong>aptitude</strong></span> ou com comandos como
</p><pre class="screen">
# dpkg -l | pager
</pre><p>
ou
</p><pre class="screen">
# dpkg --get-selections "*" &gt; ~/curr-pkgs.txt
</pre><p>
É desejável remover quaisquer retenções (holds) em pacotes antes da
atualização. Se qualquer pacote que seja essencial para a atualização
estiver retido, a atualização falhará.
</p><p>
Note que o <span class="command"><strong>aptitude</strong></span> usa um método para registrar os
pacotes que estão retidos diferente do <span class="command"><strong>apt-get</strong></span> e do
<span class="command"><strong>dselect</strong></span>. Você pode identificar pacotes retidos pelo
<span class="command"><strong>aptitude</strong></span> com
</p><pre class="screen">
# aptitude search "~ahold"
</pre><p>
Caso você queira verificar quais pacotes você tem retidos pelo
<span class="command"><strong>apt-get</strong></span>, você deve usar
</p><pre class="screen">
# dpkg --get-selections | grep 'hold$'
</pre><p>
Se você alterou e recompilou um pacote localmente, e não o renomeou ou
colocou uma época na versão, você deve colocá-lo em retenção para evitar que
seja atualizado.
</p><p>
O estado do pacote em <span class="quote">“<span class="quote">hold</span>”</span> pelo <span class="command"><strong>apt-get</strong></span>
pode ser alterado usando:
</p><pre class="screen">
# echo <em class="replaceable"><code>nome_do_pacote</code></em> hold | dpkg --set-selections
</pre><p>
Substitua <code class="literal">hold</code> por <code class="literal">install</code> para
remover o estado de <span class="quote">“<span class="quote">hold</span>”</span>.
</p><p>
Se existir alguma coisa que você precisa corrigir, é melhor certificar-se
que o seu <code class="filename">sources.list</code> ainda se refere a
wheezy como explicado na <a class="xref" href="ap-old-stuff.pt-br.html#old-sources" title="A.2. Verificando sua lista de fontes (sources list)">Seção A.2, “Verificando sua lista de fontes (sources list)”</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="proposed-updates"></a>4.2.4. A seção <span class="quote">“<span class="quote">proposed-updates</span>”</span></h3></div></div></div><p>
    Caso você tenha a seção <span class="quote">“<span class="quote"><code class="literal">proposed-updates</code></span>”</span>
presente no seu arquivo <code class="filename">/etc/apt/sources.list</code>, você
deve removê-la desse arquivo antes de tentar atualizar o seu sistema. Essa é
uma precaução para reduzir a probabilidade de conflitos.
  </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="unofficial-sources"></a>4.2.5. Fontes não oficiais</h3></div></div></div><p>
Caso você tenha quaisquer pacotes não-Debian no seu sistema, você deve estar
ciente de que esses podem ser removidos durante a atualização por causa de
dependências conflitantes. Se esses pacotes foram instalados pela adição de
um repositório extra no seu <code class="filename">/etc/apt/sources.list</code>, você
deve verificar se tal repositório também oferece pacotes compilados para
jessie e alterar a linha da fonte correspondente ao mesmo tempo que
alterar as suas linhas das fontes para os pacotes Debian.
</p><p>
Alguns usuários podem ter versões atualizadas retroativamente
(<span class="quote">“<span class="quote">backported</span>”</span>) <span class="emphasis"><em>não-oficiais</em></span> <span class="quote">“<span class="quote">mais
novas</span>”</span> dos pacotes que <span class="emphasis"><em>estão</em></span> no Debian
instaladas no seu sistema wheezy. Tais pacotes são mais prováveis
de causar problemas durante a atualização, pois podem resultar em conflitos
de arquivo<a href="#ftn.idp49370864" class="footnote" id="idp49370864"><sup class="footnote">[4]</sup></a>. A <a class="xref" href="ch-upgrading.pt-br.html#trouble" title="4.5. Possíveis problemas durante a atualização">Seção 4.5, “Possíveis problemas durante a atualização”</a>
tem algumas informações sobre como lidar com conflitos de arquivo caso eles
devam ocorrer.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgrade-process"></a>4.3. Preparando as fontes para o APT</h2></div></div></div><p>
Antes de iniciar a atualização você deve ajustar as listas de pacote no
arquivo de configuração do <code class="systemitem">apt</code><a id="idp49375344" class="indexterm"></a>,
<code class="filename">/etc/apt/sources.list</code>.
</p><p>
O <code class="systemitem">apt</code><a id="idp49378016" class="indexterm"></a> considerará todos os pacotes
que possam ser encontrados através de qualquer linha iniciada por
<span class="quote">“<span class="quote"><code class="literal">deb</code></span>”</span>, e instalará o pacote com o número de
versão mais elevado, dando prioridade à primeira linha do arquivo (assim,
onde você tiver múltiplas localizações de espelhos, normalmente indicará
primeiro um disco rígido local, depois <acronym title="Compact Disc Read Only Memory">CD-ROM</acronym>s, e então
os espelhos HTTP/FTP).
</p><p>
Uma versão pode frequentemente ser referida tanto pelo seu codinome (por
exemplo, <code class="literal">wheezy</code>,
<code class="literal">jessie</code>) como pelo seu nome de estado (ou seja,
<code class="literal">oldstable</code>, <code class="literal">stable</code>,
<code class="literal">testing</code>, <code class="literal">unstable</code>). Referir-se a uma
versão pelo seu codinome tem a vantagem que você nunca será surpreendido por
uma nova versão, e por essa razão essa abordagem é adotada aqui. Isso
significa certamente que você mesmo terá que ficar atento aos anúncios de
lançamento. Caso você use o nome de estado em vez disso, verá apenas grandes
quantidades de atualizações dos pacotes disponíveis assim que um lançamento
acontecer.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="network"></a>4.3.1. Adicionar fontes da Internet ao APT</h3></div></div></div><p>
A configuração padrão é definida para instalação a partir dos principais
servidores do Debian na Internet, mas é possível que você deseje modificar o
<code class="filename">/etc/apt/sources.list</code> para usar outros espelhos,
preferencialmente um espelho que esteja localizado o mais próximo de você em
termos de rede.
</p><p>
Os endereços dos espelhos HTTP ou FTP do Debian podem ser encontrados em
<a class="ulink" href="https://www.debian.org/distrib/ftplist" target="_top">https://www.debian.org/distrib/ftplist</a> (veja na seção <span class="quote">“<span class="quote">lista de
espelhos do Debian</span>”</span>). Espelhos HTTP geralmente são mais rápidos do
que espelhos FTP.
</p><p>
Por exemplo, suponha que seu espelho Debian mais próximo seja
<code class="literal">http://mirrors.kernel.org</code>. Quando examinar esse espelho com
um navegador web ou programa de FTP, você notará que os diretórios
principais estão organizados assim:
</p><pre class="programlisting">
http://mirrors.kernel.org/debian/dists/jessie/main/binary-<span class="phrase">amd64</span>/...
http://mirrors.kernel.org/debian/dists/jessie/contrib/binary-<span class="phrase">amd64</span>/...
</pre><p>
Para usar esse espelho com o <code class="systemitem">apt</code><a id="idp49395616" class="indexterm"></a>,
você adiciona esta linha ao seu arquivo <code class="filename">sources.list</code>:
</p><pre class="programlisting">deb http://mirrors.kernel.org/debian jessie main contrib</pre><p>
Note que o <span class="quote">“<span class="quote"><code class="literal">dists</code></span>”</span> é adicionado
implicitamente, e os argumentos após o nome da versão são usados para
expandir o caminho em múltiplos diretórios.
</p><p>
Após adicionar suas novas fontes, desabilite as linhas
<span class="quote">“<span class="quote"><code class="literal">deb</code></span>”</span> previamente existentes em
<code class="filename">sources.list</code> pondo um sinal de cerquilha
(<code class="literal">#</code>) no início delas.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="localmirror"></a>4.3.2. Adicionando fontes ao APT para um espelho local</h3></div></div></div><p>
Em vez de usar espelhos de pacotes HTTP ou FTP, é possível que você deseje
modificar o <code class="filename">/etc/apt/sources.list</code> para usar um espelho
em um disco local (possivelmente montado sobre <acronym title="Network File System">NFS</acronym>).
</p><p>
Por exemplo, seu espelho de pacotes pode estar sob
<code class="filename">/var/ftp/debian/</code>, e ter diretórios principais assim:
</p><pre class="programlisting">
/var/ftp/debian/dists/jessie/main/binary-<span class="phrase">amd64</span>/...
/var/ftp/debian/dists/jessie/contrib/binary-<span class="phrase">amd64</span>/...
</pre><p>
Para usar isso com o <code class="systemitem">apt</code><a id="idp49409776" class="indexterm"></a>, adicione
esta linha ao seu arquivo <code class="filename">sources.list</code>:
</p><pre class="programlisting">deb file:/var/ftp/debian jessie main contrib</pre><p>
Note que o <span class="quote">“<span class="quote"><code class="literal">dists</code></span>”</span> é adicionado
implicitamente, e os argumentos após o nome da versão são usados para
expandir o caminho em múltiplos diretórios.
</p><p>
Após adicionar suas novas fontes, desabilite as linhas
<span class="quote">“<span class="quote"><code class="literal">deb</code></span>”</span> previamente existentes em
<code class="filename">sources.list</code> pondo um sinal de cerquilha
(<code class="literal">#</code>) no início delas.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cdroms"></a>4.3.3. Adicionando fontes ao APT a partir de mídia ótica</h3></div></div></div><p>
Caso você queira usar <span class="emphasis"><em>apenas</em></span> CDs (ou mídias de DVDs ou
Blu-ray), comente as linhas <span class="quote">“<span class="quote"><code class="literal">deb</code></span>”</span> já
existentes em <code class="filename">/etc/apt/sources.list</code> pondo um sinal de
cerquilha (<code class="literal">#</code>) no início delas.
</p><p>
Certifique-se de que existe uma linha em <code class="filename">/etc/fstab</code> que
habilite a montagem do seu drive de CD-ROM no ponto de montagem
<code class="filename">/media/cdrom</code>. Por exemplo, caso
<code class="filename">/dev/sr0</code> seja o seu drive de CD-ROM, o
<code class="filename">/etc/fstab</code> deve conter uma linha como:
</p><pre class="programlisting">
/dev/sr0 /media/cdrom auto noauto,ro 0 0
</pre><p>
Note que não deve haver <span class="emphasis"><em>nenhum espaço</em></span> entre as palavras
<code class="literal">noauto,ro</code> no quarto campo.
</p><p>
Para verificar se funciona, insira um CD e tente executar
</p><pre class="screen">
# mount /media/cdrom    # isso montará o CD no ponto de montagem
# ls -alF /media/cdrom  # isso deverá exibir o diretório raiz do CD
# umount /media/cdrom   # isso desmontará o CD
</pre><p>
Depois, execute:
</p><pre class="screen">
# apt-cdrom add
</pre><p>
para cada CD-ROM de binários do Debian que você tiver, para adicionar os
dados a respeito de cada CD à base de dados do APT.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgradingpackages"></a>4.4. Atualizando pacotes</h2></div></div></div><p>
A forma recomendada para atualizar a partir de versões anteriores do
Debian é usar a ferramenta de gerenciamento de pacotes
<span class="command"><strong>apt-get</strong></span>. Nos lançamentos anteriores, o
<span class="command"><strong>aptitude</strong></span> era recomendado para esse propósito, mas as
versões recentes do <span class="command"><strong>apt-get</strong></span> fornecem uma funcionalidade
equivalente e também têm demonstrado maior consistência dando os resultados
desejados nas atualizações.
</p><p>
Não esqueça de montar todas as partições necessárias (especialmente as
partições raiz e <code class="filename">/usr</code>) com permissões de leitura e
escrita, com um comando como:
</p><pre class="screen">
# mount -o remount,rw /<em class="replaceable"><code>ponto-de-montagem</code></em>
</pre><p>
Em seguida, você deve confirmar novamente se as entradas das fontes do APT
(em <code class="filename">/etc/apt/sources.list</code>) referem-se a
<span class="quote">“<span class="quote"><code class="literal">jessie</code></span>”</span> ou a
<span class="quote">“<span class="quote"><code class="literal">stable</code></span>”</span>. Não devem haver quaisquer entradas
de fontes que apontem para wheezy
</p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
    As linhas de fontes de um CD-ROM podem às vezes se referir à
<span class="quote">“<span class="quote"><code class="literal">unstable</code></span>”</span>; embora isso possa ser confuso,
você <span class="emphasis"><em>não</em></span> deve alterá-las.
  </p></td></tr></table></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="record-session"></a>4.4.1. Gravando a sessão</h3></div></div></div><p>
É fortemente recomendado que você utilize o programa
<span class="command"><strong>/usr/bin/script</strong></span> para gravar uma transcrição da sessão de
atualização. Então, se um problema ocorrer, você terá um registro do que
aconteceu e, se necessário, poderá fornecer informações precisas em um
relatório de bug. Para iniciar a gravação, digite:
</p><pre class="screen">
# script -t 2&gt;~/upgrade-jessie-<em class="replaceable"><code>etapa</code></em>.hora -a ~/upgrade-jessie-<em class="replaceable"><code>etapa</code></em>.script
</pre><p>
ou semelhante. Caso você tenha que reexecutar a transcrição (por exemplo,
caso você tenha que reinicializar o sistema) use valores diferentes para
<em class="replaceable"><code>etapa</code></em> para indicar qual etapa da atualização você
está registrando. Não ponha o arquivo de transcrição em um diretório
temporário como <code class="filename">/tmp</code> ou <code class="filename">/var/tmp</code>
(arquivos nesses diretórios podem ser excluídos durante a atualização ou
durante qualquer reinicialização).
</p><p>
A transcrição também permitirá que você reveja informações que rolaram para
fora da tela. Caso você esteja no console do sistema, apenas mude para VT2
(usando <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F2</strong></span>)  e, após
se autenticar, use <code class="literal">less -R
~root/upgrade-jessie-etapa.script</code> para ver o arquivo.
</p><p>
Depois que você tiver completado a atualização, pode parar o
<span class="command"><strong>script</strong></span> digitando <code class="literal">exit</code> no prompt.
</p><p>
Caso você tenha usado a opção <span class="emphasis"><em>-t</em></span> para o
<span class="command"><strong>script</strong></span>, você pode usar o programa
<span class="command"><strong>scriptreplay</strong></span> para reproduzir toda a sessão:
</p><pre class="screen">
# scriptreplay ~/upgrade-jessie-etapa.hora ~/upgrade-jessie-etapa.script
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="updating-lists"></a>4.4.2. Atualizando a lista de pacotes</h3></div></div></div><p>
Primeiro, a lista de pacotes disponíveis para a nova versão precisa ser
obtida. Isso é feito executando:
</p><pre class="screen">
# apt-get update
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="sufficient-space"></a>4.4.3. Certifique-se que você tem espaço suficiente para a atualização</h3></div></div></div><p>
Você tem que se certificar, antes de atualizar o seu sistema, que você terá
espaço em disco rígido suficiente quando iniciar a atualização completa do
sistema descrita na <a class="xref" href="ch-upgrading.pt-br.html#upgrading-full" title="4.4.5. Atualizando o sistema">Seção 4.4.5, “Atualizando o sistema”</a>. Primeiro, qualquer
pacote necessário para instalação que for obtido pela rede é armazenado em
<code class="filename">/var/cache/apt/archives</code> (e no subdiretório
<code class="filename">partial/</code>, durante o download), então você deve
certificar-se que tem espaço suficiente na partição do sistema de arquivos
que contém o <code class="filename">/var/</code> para download temporário dos pacotes
que serão instalados em seu sistema. Após o download, você provavelmente
precisará de mais espaço em outras partições de sistemas de arquivos, tanto
para instalação de pacotes atualizados (que podem conter executáveis maiores
ou mais dados) quanto para novos pacotes que serão puxados pela
atualização. Caso o seu sistema não tenha espaço suficiente, você pode
acabar com uma atualização incompleta que pode ser difícil de recuperar.
</p><p>
O <span class="command"><strong>apt-get</strong></span> pode exibir informações detalhadas sobre o
espaço em disco necessário para a instalação. Antes de executar a
atualização, você pode ver essa estimativa executando:
</p><pre class="screen">
# apt-get -o APT::Get::Trivial-Only=true dist-upgrade
[ ... ]
XXX atualizados, XXX novos instalados, XXX para remover e XXX não atualizados.
Necessário obter xx.xMB de arquivos.
Após essa operação, AAAMB de espaço de disco adicional serão usados.
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
Ao executar esse comando no início do processo de atualização, pode ocorrer
um erro, devido às razões descritas nas próximas seções. Nesse caso, você
precisará esperar até que tenha feito a atualização mínima do sistema, como
na <a class="xref" href="ch-upgrading.pt-br.html#minimal-upgrade" title="4.4.4. Atualização mínima do sistema">Seção 4.4.4, “Atualização mínima do sistema”</a>, antes de executar esse comando para
estimar o espaço em disco.
</p></td></tr></table></div><p>
Caso você não tenha espaço suficiente em disco para a atualização, o
<span class="command"><strong>apt-get</strong></span> o avisará com uma mensagem como esta:
</p><pre class="screen">
E: Você não tem espaço livre suficiente em /var/cache/apt/archives/.
</pre><p>Nessa situação, certifique-se de liberar espaço suficiente antes. Você pode:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
Remover pacotes que tenham sido previamente baixados para instalação (em
<code class="filename">/var/cache/apt/archives</code>). Limpar o cache de pacotes
executando <span class="command"><strong>apt-get clean</strong></span> removerá todos os arquivos de
pacote previamente baixados.
</p></li><li class="listitem"><p>
Remover pacotes esquecidos. Caso você tenha utilizado o
<span class="command"><strong>aptitude</strong></span> ou <span class="command"><strong>apt-get</strong></span> para instalar
pacotes manualmente no wheezy, ele terá mantido o registro desses
pacotes que você instalou manualmente e será capaz de marcar como
redundantes aqueles pacotes obtidos apenas por dependências que não são mais
necessárias devido ao pacote ter sido removido. Eles não marcarão para
remoção pacotes que você instalou manualmente. Para remover automaticamente
pacotes que não são mais usados, execute:
</p><pre class="screen">
# apt-get autoremove
</pre><p>
Você também pode usar o <span class="command"><strong>deborphan</strong></span>,
<span class="command"><strong>debfoster</strong></span> ou <span class="command"><strong>cruft</strong></span> para encontrar
pacotes redundantes. Não remova cegamente os pacotes apresentados por essas
ferramentas, especialmente se você estiver usando opções agressivas
diferentes do padrão que são propensas a falsos positivos. É altamente
recomendado que você revise manualmente os pacotes sugeridos para remoção
(ou seja, seus conteúdos, tamanhos e descrições) antes de removê-los.
</p></li><li class="listitem"><p>
Remova pacotes que ocupam muito espaço e não são necessários atualmente
(você sempre pode reinstalá-los após a atualização). Caso você tenha o
<code class="systemitem">popularity-contest</code><a id="idp49485248" class="indexterm"></a> instalado, você
pode usar o <span class="command"><strong>popcon-largest-unused</strong></span> para listar os pacotes
que você não usa e que ocupam mais espaço. Você pode encontrar apenas os
pacotes que ocupam mais espaço em disco com <span class="command"><strong>dpigs</strong></span>
(disponível no pacote <code class="systemitem">debian-goodies</code><a id="idp49488736" class="indexterm"></a>) ou com o
<span class="command"><strong>wajig</strong></span> (executando <code class="literal">wajig size</code>). Eles
também podem ser encontrados com o <code class="systemitem">aptitude</code><a id="idp49491952" class="indexterm"></a>. Inicie o <span class="command"><strong>aptitude</strong></span>
em <span class="quote">“<span class="quote">modo visual</span>”</span>, selecione
<span class="guimenu">Visões</span> → <span class="guimenuitem">Nova lista de pacotes
plana</span>, pressione <span class="keycap"><strong>l</strong></span> e digite
<code class="literal">~i</code>, então pressione <span class="keycap"><strong>S</strong></span> e digite
<code class="literal">~installsize</code>. Isso lhe dará uma lista conveniente para
trabalhar. 
</p></li><li class="listitem"><p>
  Remover traduções e arquivos de localização do sistema se eles não forem
necessários. Você pode instalar o pacote <code class="systemitem">localepurge</code><a id="idp49500544" class="indexterm"></a> e configurá-lo para que apenas
alguns locales selecionados sejam mantidos no sistema. Isso reduzirá o
espaço de disco consumido em <code class="filename">/usr/share/locale</code>.
</p></li><li class="listitem"><p>
   Mover temporariamente para um outro sistema, ou remover permanentemente,
registros do sistema existentes em <code class="filename">/var/log/</code>.
</p></li><li class="listitem"><p>
    Usar um <code class="filename">/var/cache/apt/archives</code> temporário: Você pode
usar um diretório de cache temporário de um outro sistema de arquivos
(dispositivo de armazenamento <acronym title="Universal Serial Bus">USB</acronym>, disco rígido
temporário, sistema de arquivos já em uso, ...)
  </p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      Não use uma montagem <acronym title="Network File System">NFS</acronym> pois a conexão de rede pode ser
interrompida durante a atualização.
    </p></td></tr></table></div><p>
  Por exemplo, caso você tenha um pendrive <acronym title="Universal Serial Bus">USB</acronym> montado em
<code class="filename">/media/pendrive</code>:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
	remova os pacotes que tenham sido previamente baixados para instalação: 

	</p><pre class="screen"># apt-get clean</pre><p>
      </p></li><li class="listitem"><p>
	copie o diretório <code class="filename">/var/cache/apt/archives</code> para o drive
<acronym title="Universal Serial Bus">USB</acronym>:

	</p><pre class="screen"># cp -ax /var/cache/apt/archives /media/pendrive/</pre><p>
      </p></li><li class="listitem"><p>
	monte o diretório de cache temporário no lugar do atual:

	</p><pre class="screen"># mount --bind /media/pendrive/archives /var/cache/apt/archives</pre><p>
      </p></li><li class="listitem"><p>
	após a atualização, restaure o diretório
<code class="filename">/var/cache/apt/archives</code> original:

	</p><pre class="screen"># umount /media/pendrive/archives</pre><p>
      </p></li><li class="listitem"><p>
	remova o <code class="filename">/media/pendrive/archives</code> restante.
      </p></li></ol></div><p>
  Você pode criar o diretório de cache temporário em qualquer sistema de
arquivos que esteja montado em seu sistema.
  </p></li><li class="listitem"><p>
    Fazer uma atualização mínima do sistema (veja a <a class="xref" href="ch-upgrading.pt-br.html#minimal-upgrade" title="4.4.4. Atualização mínima do sistema">Seção 4.4.4, “Atualização mínima do sistema”</a>) ou atualizações parciais do sistema seguidas
por uma atualização completa. Isso permitirá atualizar o sistema
parcialmente, e permite limpar o cache de pacotes antes da atualização
completa.
  </p></li></ul></div><p>
Note que para remover pacotes com segurança, é aconselhável mudar o seu
<code class="filename">sources.list</code> de volta para wheezy como
descrito na <a class="xref" href="ap-old-stuff.pt-br.html#old-sources" title="A.2. Verificando sua lista de fontes (sources list)">Seção A.2, “Verificando sua lista de fontes (sources list)”</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="minimal-upgrade"></a>4.4.4. Atualização mínima do sistema</h3></div></div></div><p>
Em alguns casos, fazer a atualização completa (como descrito abaixo)
diretamente pode remover um grande número de pacotes que você queira
manter. Nós portanto recomendamos um processo de atualização em duas partes:
primeiro uma atualização mínima para superar esses conflitos, depois uma
atualização completa como descrito na <a class="xref" href="ch-upgrading.pt-br.html#upgrading-full" title="4.4.5. Atualizando o sistema">Seção 4.4.5, “Atualizando o sistema”</a>. 
</p><p>
Para fazer isso, primeiro execute:
</p><pre class="screen">
# apt-get upgrade
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      O processo de atualização para algumas versões anteriores recomendava o uso
do <span class="command"><strong>aptitude</strong></span> para a atualização. Essa ferramenta não é
recomendada para atualizações do wheezy para a jessie.
    </p></td></tr></table></div><p>
Isso tem como efeito a atualização daqueles pacotes que podem ser
atualizados sem a necessidade de que quaisquer outros pacotes sejam
removidos ou instalados.
</p><p>
A atualização mínima do sistema também pode ser útil quando o sistema
estiver com pouco espaço e uma atualização completa não puder ser feita
devido às restrições de espaço.
</p><p>
  Se o pacote <code class="systemitem">apt-listchanges</code><a id="idp49533072" class="indexterm"></a> estiver
instalado, ele mostrará (em sua configuração padrão) informações importantes
sobre pacotes atualizados em um paginador. Pressione <span class="keycap"><strong>q</strong></span> após
a leitura para sair do paginador e continue a atualização.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrading-full"></a>4.4.5. Atualizando o sistema</h3></div></div></div><p>
Uma vez que você tenha cumprido os passos anteriores, agora está pronto para
continuar com a parte principal da atualização. Execute:
</p><pre class="screen">
# apt-get dist-upgrade
</pre><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png" /></td><th align="left">Nota</th></tr><tr><td align="left" valign="top"><p>
      O processo de atualização para algumas versões anteriores recomendava o uso
do <span class="command"><strong>aptitude</strong></span> para a atualização. Essa ferramenta não é
recomendada para atualizações do wheezy para a jessie.
    </p></td></tr></table></div><p>
Isso realizará uma atualização completa do sistema, instalando as versões
mais novas disponíveis de todos os pacotes, e resolvendo todas as mudanças
de dependências possíveis entre pacotes em lançamentos diferentes. Se
necessário, instalará alguns pacotes novos (normalmente novas versões de
bibliotecas, ou pacotes renomeados), e removerá quaisquer pacotes obsoletos
em conflito.
</p><p>
Quando atualizar a partir de um conjunto de CD-ROMs (ou DVDs), será pedido
para inserir CDs específicos em vários pontos durante a atualização. Você
pode ter que inserir o mesmo CD várias vezes; isso é devido a pacotes
inter-relacionados que foram espalhados através dos CDs.
</p><p>
As novas versões dos pacotes instalados atualmente que não puderem ser
atualizadas sem mudar a situação da instalação de um outro pacote serão
deixadas em sua versão atual (exibidas como <span class="quote">“<span class="quote">held back</span>”</span>). Isso
pode ser resolvido tanto utilizando o <span class="command"><strong>aptitude</strong></span> para
escolher esses pacotes para instalação, como tentando <code class="literal">apt-get
install <em class="replaceable"><code>pacote</code></em></code>.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="trouble"></a>4.5. Possíveis problemas durante a atualização</h2></div></div></div><p>
As seções seguintes descrevem problemas conhecidos que podem aparecer
durante uma atualização para a jessie.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="immediate-configure"></a>4.5.1. O dist-upgrade falha com <span class="quote">“<span class="quote">Could not perform immediate
configuration</span>”</span></h3></div></div></div><p>
Em alguns casos a etapa <span class="command"><strong>apt-get dist-upgrade</strong></span> pode falhar
após baixar os pacotes com:
</p><pre class="screen">
E: Não foi possível realizar a configuração imediata no '<em class="replaceable"><code>pacote</code></em>'. Por favor, veja man 5 apt.conf sob APT::Immediate-Configure para detalhes.
</pre><p>
</p><p>
Caso isso ocorra, executar <span class="command"><strong>apt-get dist-upgrade -o
APT::Immediate-Configure=0</strong></span> em vez disso deve permitir que a
atualização prossiga.
</p><p>
Outra possível solução para esse problema é adicionar temporariamente as
fontes do wheezy e jessie ao seu
<code class="filename">sources.list</code> e executar <span class="command"><strong>apt-get
update</strong></span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="expected-removals"></a>4.5.2. Remoções esperadas</h3></div></div></div><p>
O processo de atualização para a jessie pode solicitar a remoção de
pacotes no sistema. A lista exata dos pacotes variará dependendo do conjunto
de pacotes que você tenha instalado. Estas notas de lançamento dão conselhos
gerais sobre essas remoções, mas se estiver em dúvida, é recomendado que
você examine as remoções de pacotes propostas por cada método antes de
prosseguir. Para mais informações sobre pacotes obsoletos no jessie,
veja <a class="xref" href="ch-upgrading.pt-br.html#obsolete" title="4.10. Pacotes obsoletos">Seção 4.10, “Pacotes obsoletos”</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="conflicts-loops"></a>4.5.3. Loops de conflitos ou pré-dependências</h3></div></div></div><p>
Algumas vezes é necessário habilitar a opção
<code class="literal">APT::Force-LoopBreak</code> no APT para que seja possível
remover temporariamente um pacote essencial devido a um loop de
<span class="quote">“<span class="quote">Conflitos/Pré-Dependências</span>”</span>. O <span class="command"><strong>apt-get</strong></span> o
alertará sobre isso e cancelará a atualização. Você pode contornar isso
especificando a opção <code class="literal">-o APT::Force-LoopBreak=1</code> na linha
de comando do <span class="command"><strong>apt-get</strong></span>.
</p><p>
É possível que uma estrutura de dependências do sistema possa estar tão
corrompida de modo que necessite de intervenção manual. Normalmente, isso
significa usar o <span class="command"><strong>apt-get</strong></span> ou
</p><pre class="screen">
# dpkg --remove <em class="replaceable"><code>nome_do_pacote</code></em>
</pre><p>
para eliminar alguns dos pacotes problemáticos, ou
</p><pre class="screen">
# apt-get -f install
# dpkg --configure --pending
</pre><p>
Em casos extremos, você poderá ter que forçar a reinstalação com um comando
como
</p><pre class="screen">
# dpkg --install <em class="replaceable"><code>/caminho/para/nome_do_pacote.deb</code></em>
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="file-conflicts"></a>4.5.4. Conflitos de arquivo</h3></div></div></div><p>
Os conflitos de arquivo não devem ocorrer caso você atualize a partir de um
sistema <span class="quote">“<span class="quote">puro</span>”</span> wheezy, mas podem ocorrer caso você
tenha portes retroativos não oficiais instalados. Um conflito de arquivo
resultará em um erro como:
</p><pre class="screen">
Descompactando <em class="replaceable"><code>&lt;pacote-foo&gt;</code></em> (de <em class="replaceable"><code>&lt;arquivo-de-pacote-foo&gt;</code></em>) ...
dpkg: erro processando <em class="replaceable"><code>&lt;pacote-foo&gt;</code></em> (--install):
 tentando sobrescrever '<em class="replaceable"><code>&lt;algum-nome-de-arquivo&gt;</code></em>',
 que também está no pacote <em class="replaceable"><code>&lt;pacote-bar&gt;</code></em>
dpkg-deb: sub-processo de colagem morto pelo sinal (pipe quebrado)
 Erros foram encontrados enquanto processando:
 <em class="replaceable"><code>&lt;pacote-foo&gt;</code></em>
</pre><p>
Você pode tentar resolver um conflito de arquivo com a remoção forçada do
pacote mencionado na <span class="emphasis"><em>última</em></span> linha da mensagem de erro:
</p><pre class="screen">
# dpkg -r --force-depends <em class="replaceable"><code>nome_do_pacote</code></em>
</pre><p>
Após consertar as coisas, você deve ser capaz de continuar a atualização
repetindo os comandos do <span class="command"><strong>apt-get</strong></span> descritos anteriormente.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuration-changes"></a>4.5.5. Mudanças de configuração</h3></div></div></div><p>
Durante a atualização, serão feitas perguntas com relação a configuração ou
reconfiguração de diversos pacotes. Quando você for perguntado se algum
arquivo no diretório <code class="filename">/etc/init.d</code>, ou o arquivo
<code class="filename">/etc/manpath.config</code> deve ser substituído pela versão do
mantenedor do pacote, normalmente é necessário responder <span class="quote">“<span class="quote">yes</span>”</span>
para garantir a coerência do sistema. Você sempre pode reverter para as
versões antigas, já que serão guardadas com uma extensão
<code class="literal">.dpkg-old</code>.
</p><p>
Caso você não tenha certeza do que fazer, anote o nome do pacote ou arquivo
e resolva em um momento posterior. Você pode procurar no arquivo transcrito
para rever as informações que estavam na tela durante a atualização.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="console-change"></a>4.5.6. Mudança de sessão para o console</h3></div></div></div><p>
Caso você esteja executando a atualização usando o console local do sistema,
você pode achar que em alguns momentos durante a atualização o console é
comutado para uma visão diferente e você perde a visibilidade do processo de
atualização. Por exemplo, isso pode acontecer em sistemas desktop quando o
gerenciador de tela é reiniciado.
</p><p>
Para recuperar o console onde a atualização estava em execução você terá que
usar <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F1</strong></span> (se estiver na tela de inicialização gráfica)
ou <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>F1</strong></span> (se estiver no console
local em modo texto) para mudar de volta para o terminal virtual
1. Substitua F1 pela tecla de função com o mesmo número do terminal virtual
onde a atualização estava em execução. Você também pode usar <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>Seta Esquerda</strong></span>
ou <span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>Seta
Direita</strong></span> para mudar entre os diferentes terminais em modo
texto.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="package-specific-issues"></a>4.5.7. Cuidados especiais com pacotes específicos</h3></div></div></div><p>
Na maioria dos casos, os pacotes deverão atualizar sem problemas entre
wheezy e jessie. Existe um pequeno número de casos onde
alguma intervenção pode ser necessária, seja antes ou durante a atualização;
esses estão detalhados a seguir baseados por pacote.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="issues-systemd"></a>4.5.7.1. systemd</h4></div></div></div><p>
    A atualização do Debian de wheezy para jessie migrará, por
padrão, o seu sistema init do SysV para o systemd. Dependendo do seu sistema
e configuração, você pode precisar fazer algumas alterações manuais. Nós
detalhamos os problemas conhecidos em <a class="xref" href="ch-information.pt-br.html#systemd-upgrade-default-init-system" title="5.6. A atualização instala o novo sistema init padrão para Jessie">Seção 5.6, “A atualização instala o novo sistema init padrão para Jessie”</a>.
  </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="issues-lxc"></a>4.5.7.2. LXC</h4></div></div></div><p>
    Caso você tenha o LXC instalado, você pode precisar tomar cuidados especiais
ao atualizar o seu sistema e os seus contêineres. Por favor, dê uma olhada
em <a class="xref" href="ch-information.pt-br.html#lxc-upgrade-issues" title="5.8. Considerações de atualização para hospedeiros e contêineres LXC">Seção 5.8, “Considerações de atualização para hospedeiros e contêineres LXC”</a> para problemas conhecidos e
soluções.
  </p></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="newkernel"></a>4.6. Atualizando o seu kernel e pacotes relacionados</h2></div></div></div><p>
Esta seção explica como atualizar o seu kernel e identifica potenciais
problemas relacionados com essa atualização. Você pode instalar um dos
pacotes <code class="systemitem">linux-image-*</code><a id="idp49603856" class="indexterm"></a> fornecidos
pelo Debian, ou compilar um kernel customizado a partir do fonte.
</p><p>
Note que muitas das informações nesta seção são baseadas na suposição de que
você usará um dos kernels modulares do Debian, juntamente com o <code class="systemitem">initramfs-tools</code><a id="idp49606320" class="indexterm"></a> e o <code class="systemitem">udev</code><a id="idp49608016" class="indexterm"></a>. Caso você escolha utilizar um kernel
customizado que não requeira uma initrd ou se você utilizar um gerador de
initrd diferente, algumas das informações podem não ser relevantes para
você.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="kernel-metapackage"></a>4.6.1. Instalando um metapacote do kernel</h3></div></div></div><p>
Quando você fizer dist-upgrade do wheezy para a jessie, é
fortemente recomendado que você instale um metapacote linux-image-*, caso
você não tenha feito isso antes. Esses metapacotes trarão automaticamente
uma nova versão do kernel durante as atualizações. Você pode verificar se
você tem um instalado executando:
</p><pre class="screen">
# dpkg -l "linux-image*" | grep ^ii | grep -i meta
</pre><p>
Caso você não veja nenhuma saída, então você precisará instalar um novo
pacote linux-image manualmente ou instalar um metapacote linux-image. Para
ver uma lista dos metapacotes linux-image disponíveis, execute:
</p><pre class="screen">
# apt-cache search linux-image- | grep -i meta | grep -v transition
</pre><p>
Caso você esteja inseguro sobre qual pacote selecionar, execute
<code class="literal">uname -r</code> e procure um pacote com um nome semelhante. Por
exemplo, caso você veja '<code class="literal">2.6.32-5-amd64</code>', é recomendado
que você instale <code class="systemitem">linux-image-amd64</code><a id="idp49616528" class="indexterm"></a>. Você também pode usar
<span class="command"><strong>apt-cache</strong></span> para ver uma longa descrição de cada pacote a
fim de ajudar a escolher o melhor disponível. Por exemplo:
</p><pre class="screen">
# apt-cache show linux-image-amd64
</pre><p>
Você deve então usar <code class="literal">apt-get install</code> para instalá-lo. Uma
vez que o novo kernel esteja instalado, você deverá reinicializar assim que
for possível para obter os benefícios oferecidos pela nova versão do
kernel. Porém, por favor, dê uma olhada em <a class="xref" href="ch-upgrading.pt-br.html#nownownow" title="4.7. Coisas para fazer antes de reinicializar">Seção 4.7, “Coisas para fazer antes de reinicializar”</a>
antes de realizar a primeira reinicialização após a atualização.
</p><p>
Para os mais aventureiros, existe uma forma fácil de compilar seu próprio
kernel customizado no Debian. Instale os fontes do kernel, fornecidos no
pacote <code class="systemitem">linux-source</code><a id="idp49622880" class="indexterm"></a>. Você pode fazer
uso do alvo <code class="literal">deb-pkg</code> disponível no makefile dos fontes
para construir um pacote binário. Mais informações podem ser encontradas no
<a class="ulink" href="http://kernel-handbook.alioth.debian.org/" target="_top">Debian Linux Kernel
Handbook</a>, o qual também pode ser encontrado como o pacote
<code class="systemitem">debian-kernel-handbook</code><a id="idp49626400" class="indexterm"></a>.
</p><p>
Se possível, é vantajoso atualizar o pacote do kernel separadamente do
<code class="literal">dist-upgrade</code> principal para reduzir as chances de ter um
sistema temporariamente não-inicializável. Note que isso deve ser feito
somente após o processo de atualização mínima descrito na <a class="xref" href="ch-upgrading.pt-br.html#minimal-upgrade" title="4.4.4. Atualização mínima do sistema">Seção 4.4.4, “Atualização mínima do sistema”</a>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="initramfs-tools-issues"></a>4.6.2. Mudanças na montagem e verificação do sistema de arquivos raiz e
<code class="filename">/usr</code></h3></div></div></div><p>
    O <code class="systemitem">initramfs-tools</code><a id="idp49632384" class="indexterm"></a> agora também
executará o <code class="literal">fsck</code> no sistema de arquivos raiz antes de
montá-lo. Caso o programa init escolhido seja o <code class="literal">systemd</code> e
haja um sistema de arquivos <code class="filename">/usr</code> separado, ele também
fará o fsck e montará o <code class="filename">/usr</code>.
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
	Caso o <code class="filename">/usr</code> esteja em um sistema de arquivos separado
em um dispositivo RAID e a configuração do <code class="literal">INITRDSTART</code> em
<code class="filename">/etc/default/mdadm</code> não seja '<code class="literal">all</code>',
você precisará mudá-la para incluir esse dispositivo.
      </p></li><li class="listitem"><p>
	Caso o <code class="filename">/usr</code> esteja em um sistema de arquivos separado
em um volume lógico LVM, e a linha para o <code class="filename">/usr</code> em
<code class="filename">/etc/fstab</code> especifique o dispositivo pelo
<code class="literal">UUID</code> ou <code class="literal">LABEL</code>, você deve alterar esta
linha para especificar o dispositivo usando o formato
<code class="filename">/dev/mapper/<em class="replaceable"><code>VG</code></em>-<em class="replaceable"><code>LV</code></em></code>
ou
<code class="filename">/dev/<em class="replaceable"><code>VG</code></em>/<em class="replaceable"><code>LV</code></em></code>.
      </p></li><li class="listitem"><p>
	Não é mais possível fazer bind-mount no sistema de arquivos
<code class="filename">/usr</code>.
      </p></li><li class="listitem"><p>
	Caso o RTC (relógio de tempo real) esteja ajustado para o horário local e o
horário local esteja à frente do UTC, o <code class="literal">e2fsck</code>
apresentará um aviso durante a inicialização sobre a mudança de atraso do
horário (<a class="ulink" href="https://bugs.debian.org/767040" target="_top">bug
#767040</a>). Você pode desabilitar isso pondo as seguintes linhas no
<code class="filename">/etc/e2fsck.conf</code>:
      </p><pre class="screen">
[options]
broken_system_clock=1
</pre></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="nownownow"></a>4.7. Coisas para fazer antes de reinicializar</h2></div></div></div><p>
Quando o <code class="literal">apt-get dist-upgrade</code> terminar, a atualização
<span class="quote">“<span class="quote">formal</span>”</span> estará completa, mas existem algumas outras coisas com
as quais deve-se ter cuidado <span class="emphasis"><em>antes</em></span> da próxima
reinicialização.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
      Ao fazer a atualização de Wheezy para Jessie, pode ser uma
boa ideia expurgar pacotes antigos <span class="emphasis"><em>antes</em></span> da primeira
reinicialização. Em particular, scripts de init obsoletos podem causar
problemas. Por favor, veja <a class="xref" href="ch-upgrading.pt-br.html#purge-removed-packages" title="4.8.1. Expurgando pacotes removidos">Seção 4.8.1, “Expurgando pacotes removidos”</a> para
detalhes de como encontrar e expurgar pacotes removidos.
    </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="for-next"></a>4.8. Preparar para a próxima versão</h2></div></div></div><p>
Após a atualização, existem diversas coisas que você pode fazer para
preparar para a próxima versão.
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
Remova pacotes redundantes recentemente ou obsoletos como descrito na <a class="xref" href="ch-upgrading.pt-br.html#sufficient-space" title="4.4.3. Certifique-se que você tem espaço suficiente para a atualização">Seção 4.4.3, “Certifique-se que você tem espaço suficiente para a atualização”</a> e <a class="xref" href="ch-upgrading.pt-br.html#obsolete" title="4.10. Pacotes obsoletos">Seção 4.10, “Pacotes obsoletos”</a>. Você deve rever
quais arquivos de configuração eles usam e considerar expurgar os pacotes
para remover seus arquivos de configuração. Veja também <a class="xref" href="ch-upgrading.pt-br.html#purge-removed-packages" title="4.8.1. Expurgando pacotes removidos">Seção 4.8.1, “Expurgando pacotes removidos”</a>.
</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="purge-removed-packages"></a>4.8.1. Expurgando pacotes removidos</h3></div></div></div><p>
    Em geral, é aconselhável expurgar pacotes removidos. Isso é especialmente
verdadeiro caso os mesmos tenham sido removidos em uma atualização da versão
anterior (por exemplo, de uma atualização do wheezy) ou foram
fornecidos por terceiros. Em particular, scripts antigos init.d têm sido
conhecidos por causarem problemas.
  </p><div class="caution"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Cuidado]" src="images/caution.png" /></td><th align="left">Cuidado</th></tr><tr><td align="left" valign="top"><p>
      Ao expurgar um pacote, geralmente também expurgará os seus arquivos de log,
então, é possível que você queira fazer um backup deles primeiro.
    </p></td></tr></table></div><p>
    O seguinte comando apresenta uma lista de todos os pacotes removidos que
podem ter arquivos de configuração deixados no sistema (se houver):
  </p><pre class="screen">
# dpkg -l | awk '/^rc/ { print $2 }'
</pre><p>
    Os pacotes podem ser removidos utilizando <span class="command"><strong>apt-get
purge</strong></span>. Supondo que você queira expurgar todos eles de uma vez,
você pode usar o seguinte comando:
  </p><pre class="screen">
# apt-get purge $(dpkg -l | awk '/^rc/ { print $2 }')
</pre><p>
    Caso você utilize o <code class="systemitem">aptitude</code><a id="idp49676928" class="indexterm"></a>, você
também pode usar a seguinte alternativa para os comandos acima:
  </p><pre class="screen">
$ aptitude search '~c'
$ aptitude purge '~c'
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="deprecated"></a>4.9. Componentes obsoletos</h2></div></div></div><p>
Com a próxima versão do Debian 9 (codinome stretch),
alguns recursos estarão obsoletos. Os usuários precisarão migrar para outras
alternativas para evitar aborrecimento quando atualizar para 9.
</p><p>
Isso inclui os seguintes recursos:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>O pacote <code class="systemitem">hardening-wrapper</code><a id="idp49682832" class="indexterm"></a> está
obsoleto e espera-se que seja removido no Stretch.
		</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="obsolete"></a>4.10. Pacotes obsoletos</h2></div></div></div><p>
Ao introduzir vários novos pacotes, a jessie também aposenta e omite
completamente alguns pacotes antigos que estavam no wheezy. Não é
fornecido um caminho de atualização para esses pacotes obsoletos. Apesar de
nada lhe impedir de continuar a usar um pacote obsoleto enquanto o desejar,
o projeto Debian normalmente descontinuará o suporte de segurança para o
mesmo um ano após o lançamento do jessie<a href="#ftn.idp49686176" class="footnote" id="idp49686176"><sup class="footnote">[5]</sup></a>, e não fornecerá normalmente outro suporte nesse meio
tempo. Substituí-los por alternativas disponíveis, caso existam, é
recomendado.
</p><p>
Existem muitas razões pela quais os pacotes podem ter sido removidos da
distribuição: eles não são mais mantidos pelo upstream; não existe mais
nenhum Desenvolvedor Debian interessado em manter os pacotes; a
funcionalidade que eles fornecem foi substituída por um software diferente
(ou uma nova versão); ou eles não são mais considerados adequados para o
jessie devido a bugs nos mesmos. Nesse último caso, os pacotes podem
ainda estar presentes na distribuição <span class="quote">“<span class="quote">unstable</span>”</span>.
</p><p>
A detecção de quais pacotes são <span class="quote">“<span class="quote">obsoletos</span>”</span> em um sistema
atualizado é fácil, já que as interfaces de gerenciamento de pacotes os
marcarão como tal. Caso você esteja utilizando o
<span class="command"><strong>aptitude</strong></span>, você verá uma lista desses pacotes na entrada
<span class="quote">“<span class="quote">Pacotes Criados Localmente e Obsoletos</span>”</span>.
</p><p>
O <a class="ulink" href="https://bugs.debian.org/" target="_top">Sistema de Rastreamento de Bugs do Debian</a>
frequentemente fornece informações adicionais sobre a razão da remoção do
pacote. Você deve revisar tanto os relatórios de bug arquivados para o
próprio pacote quanto os relatórios de bug arquivados para o <a class="ulink" href="https://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=ftp.debian.org&amp;archive=yes" target="_top">pseudo-pacote
ftp.debian.org</a>.
</p><p>
  A lista dos pacotes obsoletos inclui:
  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
	O sucessor do <code class="systemitem">postgresql-9.1</code><a id="idp49695760" class="indexterm"></a> é o
<code class="systemitem">postgresql-9.4</code><a id="idp49697456" class="indexterm"></a>. Uma vez que a
atualização do sistema operacional esteja concluída, você também deve se
planejar para atualizar os seus clusters de bancos de dados do PostgreSQL
9.1 para a nova versão 9.4 do PostgreSQL utilizando a ferramenta
<span class="command"><strong>pg_upgradecluster</strong></span>. Para os usuários da linguagem
procedural PL/perl, o jessie fornece um pacote <code class="systemitem">postgresql-plperl-9.1</code><a id="idp49700464" class="indexterm"></a> atualizado lincado com a
versão jessie da libperl, para possibilitar a atualização para a nova versão
do perl no jessie, enquanto mantém as antigas funções de banco de dados
PL/perl utilizáveis até que o banco de dados também seja atualizado.
      </p></li><li class="listitem"><p>
        
        
O sucessor do <code class="systemitem">python3.2</code><a id="idp49703488" class="indexterm"></a> é o
<code class="systemitem">python3.4</code><a id="idp49705184" class="indexterm"></a>. (A versão 2.7 é suportada
tanto no wheezy quanto no jessie.)
      </p></li><li class="listitem"><p>
        O sucessor do <code class="systemitem">ruby1.8</code><a id="idp49707808" class="indexterm"></a> e <code class="systemitem">ruby1.9.1</code><a id="idp49709472" class="indexterm"></a> é o <code class="systemitem">ruby2.1</code><a id="idp49711168" class="indexterm"></a>. Por favor, instale o pacote <code class="systemitem">ruby</code><a id="idp49712880" class="indexterm"></a> para acompanhar automaticamente a versão
atual do ruby.
      </p></li><li class="listitem"><p>
        As alternativas para o <code class="systemitem">mplayer</code><a id="idp49715504" class="indexterm"></a> são
<code class="systemitem">mplayer2</code><a id="idp49717200" class="indexterm"></a> e <code class="systemitem">mpv</code><a id="idp49718832" class="indexterm"></a> (novo no jessie). Enquanto o primeiro
é mais compatível com o mplayer em termos de argumentos de linha de comando
e configuração (e adiciona alguns novos recursos também), o último adiciona
vários novos recursos e melhorias, e é ativamente mantido pelo upstream.
      </p></li><li class="listitem"><p>
        <code class="systemitem">openoffice.org</code><a id="idp49721808" class="indexterm"></a>; por favor, use o
<code class="systemitem">libreoffice</code><a id="idp49723504" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        O sucessor do <code class="systemitem">squid</code><a id="idp49726000" class="indexterm"></a> é o <code class="systemitem">squid3</code><a id="idp49727696" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        O sucessor do <code class="systemitem">libjpeg-progs</code><a id="idp49730192" class="indexterm"></a> é o
<code class="systemitem">libjpeg-turbo-progs</code><a id="idp49731888" class="indexterm"></a>.
      </p></li><li class="listitem"><p>
        O sucessor do <code class="systemitem">openjdk-6-*</code><a id="idp49734384" class="indexterm"></a> é o
<code class="systemitem">openjdk-7-*</code><a id="idp49736080" class="indexterm"></a>.
      </p></li></ul></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="dummy"></a>4.10.1. Pacotes fictícios</h3></div></div></div><p>
Alguns pacotes do wheezy foram separados em diversos pacotes no
jessie, muitas vezes para melhorar a manutenção do sistema. Para
facilitar o caminho de atualização em tais casos, a jessie geralmente
fornece pacotes <span class="quote">“<span class="quote">fictícios</span>”</span>: pacotes vazios que têm o mesmo
nome como nos antigos pacotes do wheezy, com dependências que
fazem com que os novos pacotes sejam instalados. Esses pacotes
<span class="quote">“<span class="quote">fictícios</span>”</span> são considerados redundantes após a atualização e
podem ser seguramente removidos.
</p><p>
A maioria (mas não todas) das descrições dos pacotes fictícios indica o seu
propósito. As descrições de pacotes para pacotes fictícios não são
uniformes, porém, você pode também considerar útil o
<span class="command"><strong>deborphan</strong></span> com as opções
<code class="literal">--guess-<em class="replaceable"><code>*</code></em></code> (por exemplo,
<code class="literal">--guess-dummy</code>) para detectá-los em seu sistema. Note que
alguns pacotes fictícios não têm como finalidade serem removidos após uma
atualização mas são, em vez disso, usados para acompanhar a atual versão
disponível de um programa ao longo do tempo.
</p></div></div><div class="footnotes"><br /><hr width="100" align="left" /><div id="ftn.idp49265552" class="footnote"><p><a href="#idp49265552" class="para"><sup class="para">[1] </sup></a>Se a prioridade do debconf estiver configurada em um nível muito alto, você
pode evitar perguntas de configuração, mas os serviços que dependam de
respostas predefinidas que não são aplicáveis aos seu sistema falharão ao
iniciar.</p></div><div id="ftn.idp49267264" class="footnote"><p><a href="#idp49267264" class="para"><sup class="para">[2] </sup></a>Por exemplo: serviços de DNS ou DHCP, especialmente quando não há
redundância ou substituto em caso de falha (<span class="quote">“<span class="quote">failover</span>”</span>). No
caso do DHCP, os usuários finais poderão ser desconectados da rede se o
tempo de concessão (<span class="quote">“<span class="quote">lease time</span>”</span>) for menor do que o tempo que
leva para completar o processo de atualização.</p></div><div id="ftn.idp49283968" class="footnote"><p><a href="#idp49283968" class="para"><sup class="para">[3] </sup></a> Esse recurso pode ser desabilitado adicionando o parâmetro
<code class="literal">panic=0</code> aos seus parâmetros de inicialização.  </p></div><div id="ftn.idp49370864" class="footnote"><p><a href="#idp49370864" class="para"><sup class="para">[4] </sup></a> O sistema de gerenciamento de pacotes do Debian normalmente não permite que
um pacote remova ou atualize um arquivo pertencente a outro pacote, a menos
que ele tenha sido definido para substituir esse pacote.  </p></div><div id="ftn.idp49686176" class="footnote"><p><a href="#idp49686176" class="para"><sup class="para">[5] </sup></a> Ou enquanto não existir outro lançamento durante esse período de
tempo. Normalmente, apenas duas versões estáveis são suportadas em um dado
momento.  </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch-installing.pt-br.html"><img src="images/prev.png" alt="Anterior" /></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch-information.pt-br.html"><img src="images/next.png" alt="Próxima" /></a></td></tr><tr><td width="40%" align="left" valign="top">Capítulo 3. Sistema de instalação </td><td width="20%" align="center"><a accesskey="h" href="index.pt-br.html"><img src="images/home.png" alt="Principal" /></a></td><td width="40%" align="right" valign="top"> Capítulo 5. Problemas a serem considerados para a jessie</td></tr></table></div></body></html>